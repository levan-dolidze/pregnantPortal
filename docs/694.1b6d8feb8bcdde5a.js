"use strict";(self.webpackChunkpregnantPortal=self.webpackChunkpregnantPortal||[]).push([[694],{8697:(Vt,He,A)=>{A.d(He,{nm:()=>Jn});var m=A(2994);A(5879),A(3182);var Y=A(5861),ye=A(4303),Ke=A(4537),rt=A(9058),F=A(7879);const _=new Map,Ue={activated:!1,tokenObservers:[]},pt={initialized:!1,enabled:!1};function Q(T){return _.get(T)||Object.assign({},Ue)}function re(){return pt}const ge="https://content-firebaseappcheck.googleapis.com/v1",Ne="exchangeDebugToken",je={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class at{constructor(I,P,k,x,V){if(this.operation=I,this.retryPolicy=P,this.getWaitDuration=k,this.lowerBound=x,this.upperBound=V,this.pending=null,this.nextErrorWaitInterval=x,x>V)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(I){var P=this;return(0,Y.Z)(function*(){P.stop();try{P.pending=new rt.BH,yield function J(T){return new Promise(I=>{setTimeout(I,T)})}(P.getNextRun(I)),P.pending.resolve(),yield P.pending.promise,P.pending=new rt.BH,yield P.operation(),P.pending.resolve(),yield P.pending.promise,P.process(!0).catch(()=>{})}catch(k){P.retryPolicy(k)?P.process(!1).catch(()=>{}):P.stop()}})()}getNextRun(I){if(I)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const P=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),P}}}const j=new rt.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Ae(){return(Ae=(0,Y.Z)(function*({url:T,body:I},P){const k={"Content-Type":"application/json"},x=P.getImmediate({optional:!0});if(x){const lt=yield x.getHeartbeatsHeader();lt&&(k["X-Firebase-Client"]=lt)}const V={method:"POST",body:JSON.stringify(I),headers:k};let ue,se;try{ue=yield fetch(T,V)}catch(lt){throw j.create("fetch-network-error",{originalErrorMessage:lt?.message})}if(200!==ue.status)throw j.create("fetch-status-error",{httpStatus:ue.status});try{se=yield ue.json()}catch(lt){throw j.create("fetch-parse-error",{originalErrorMessage:lt?.message})}const be=se.ttl.match(/^([\d.]+)(s)$/);if(!be||!be[2]||isNaN(Number(be[1])))throw j.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${se.ttl}`});const xn=1e3*Number(be[1]),Xt=Date.now();return{token:se.token,expireTimeMillis:Xt+xn,issuedAtTimeMillis:Xt}})).apply(this,arguments)}const we="firebase-app-check-database",ze=1,xe="firebase-app-check-store";let Dt=null;function Bt(){return(Bt=(0,Y.Z)(function*(T,I){const k=(yield function et(){return Dt||(Dt=new Promise((T,I)=>{try{const P=indexedDB.open(we,ze);P.onsuccess=k=>{T(k.target.result)},P.onerror=k=>{var x;I(j.create("storage-open",{originalErrorMessage:null===(x=k.target.error)||void 0===x?void 0:x.message}))},P.onupgradeneeded=k=>{0===k.oldVersion&&k.target.result.createObjectStore(xe,{keyPath:"compositeKey"})}}catch(P){I(j.create("storage-open",{originalErrorMessage:P?.message}))}}),Dt)}()).transaction(xe,"readwrite"),V=k.objectStore(xe).put({compositeKey:T,value:I});return new Promise((ue,se)=>{V.onsuccess=be=>{ue()},k.onerror=be=>{var xn;se(j.create("storage-set",{originalErrorMessage:null===(xn=be.target.error)||void 0===xn?void 0:xn.message}))}})})).apply(this,arguments)}const w=new F.Yd("@firebase/app-check");function K(T,I){return(0,rt.hl)()?function kt(T,I){return function xt(T,I){return Bt.apply(this,arguments)}(function tt(T){return`${T.options.appId}-${T.name}`}(T),I)}(T,I).catch(P=>{w.warn(`Failed to write token to IndexedDB. Error: ${P}`)}):Promise.resolve()}function Yt(){return(Yt=(0,Y.Z)(function*(){const T=re();if(T.enabled&&T.token)return T.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const Qt={error:"UNKNOWN_ERROR"};function on(T){return rt.US.encodeString(JSON.stringify(T),!1)}function St(T){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,Y.Z)(function*(T,I=!1){const P=T.app;!function q(T){if(!Q(T).activated)throw j.create("use-before-activation",{appName:T.name})}(P);const k=Q(P);let V,x=k.token;if(x&&!b(x)&&(k.token=void 0,x=void 0),!x){const be=yield k.cachedTokenPromise;be&&(b(be)?x=be:yield K(P,void 0))}if(!I&&x&&b(x))return{token:x.token};let se,ue=!1;if(function Ve(){return re().enabled}()){k.exchangeTokenPromise||(k.exchangeTokenPromise=function Xe(T,I){return Ae.apply(this,arguments)}(function ht(T,I){const{projectId:P,appId:k,apiKey:x}=T.options;return{url:`${ge}/projects/${P}/apps/${k}:${Ne}?key=${x}`,body:{debug_token:I}}}(P,yield function ct(){return Yt.apply(this,arguments)}()),T.heartbeatServiceProvider).finally(()=>{k.exchangeTokenPromise=void 0}),ue=!0);const be=yield k.exchangeTokenPromise;return yield K(P,be),k.token=be,{token:be.token}}try{k.exchangeTokenPromise||(k.exchangeTokenPromise=k.provider.getToken().finally(()=>{k.exchangeTokenPromise=void 0}),ue=!0),x=yield Q(P).exchangeTokenPromise}catch(be){"appCheck/throttled"===be.code?w.warn(be.message):w.error(be),V=be}return x?V?se=b(x)?{token:x.token,internalError:V}:E(V):(se={token:x.token},k.token=x,yield K(P,x)):se=E(V),ue&&function Mt(T,I){const P=Q(T).tokenObservers;for(const k of P)try{"EXTERNAL"===k.type&&null!=I.error?k.error(I.error):k.next(I)}catch{}}(P,se),se})).apply(this,arguments)}function bn(T,I){const P=Q(T),k=P.tokenObservers.filter(x=>x.next!==I);0===k.length&&P.tokenRefresher&&P.tokenRefresher.isRunning()&&P.tokenRefresher.stop(),P.tokenObservers=k}function qt(T){const{app:I}=T,P=Q(I);let k=P.tokenRefresher;k||(k=function Jt(T){const{app:I}=T;return new at((0,Y.Z)(function*(){let k;if(k=Q(I).token?yield St(T,!0):yield St(T),k.error)throw k.error;if(k.internalError)throw k.internalError}),()=>!0,()=>{const P=Q(I);if(P.token){let k=P.token.issuedAtTimeMillis+.5*(P.token.expireTimeMillis-P.token.issuedAtTimeMillis)+3e5;return k=Math.min(k,P.token.expireTimeMillis-3e5),Math.max(0,k-Date.now())}return 0},je.RETRIAL_MIN_WAIT,je.RETRIAL_MAX_WAIT)}(T),P.tokenRefresher=k),!k.isRunning()&&P.isTokenAutoRefreshEnabled&&k.start()}function b(T){return T.expireTimeMillis-Date.now()>0}function E(T){return{token:on(Qt),error:T}}class y{constructor(I,P){this.app=I,this.heartbeatServiceProvider=P}_delete(){const{tokenObservers:I}=Q(this.app);for(const P of I)bn(this.app,P.next);return Promise.resolve()}}const an="app-check-internal";!function vn(){(0,ye._registerComponent)(new Ke.wA("app-check",T=>function M(T,I){return new y(T,I)}(T.getProvider("app").getImmediate(),T.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((T,I,P)=>{T.getProvider(an).initialize()})),(0,ye._registerComponent)(new Ke.wA(an,T=>function G(T){return{getToken:I=>St(T,I),addTokenListener:I=>function gt(T,I,P,k){const{app:x}=T,V=Q(x);if(V.tokenObservers=[...V.tokenObservers,{next:P,error:k,type:I}],V.token&&b(V.token)){const se=V.token;Promise.resolve().then(()=>{P({token:se.token}),qt(T)}).catch(()=>{})}V.cachedTokenPromise.then(()=>qt(T))}(T,"INTERNAL",I),removeTokenListener:I=>bn(T.app,I)}}(T.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ye.registerVersion)("@firebase/app-check","0.6.4")}();class Jn{constructor(){return(0,m.vb)("app-check")}}typeof window<"u"&&window},7046:(Vt,He,A)=>{A.d(He,{zQ:()=>Q,rT:()=>F,f7:()=>Ue,L6:()=>Ke,_Q:()=>rt,lh:()=>_,Qv:()=>ye,nw:()=>pt});var m=A(5879),S=A(8645),C=A(2096),ie=A(5592),W=A(2459),f=A(3019),ae=A(3093),ne=A(4664),Oe=A(7398),ft=A(940),O=A(1374),Te=A(4674);function ce(re,ge){return(0,Te.m)(ge)?(0,ne.w)(()=>re,ge):(0,ne.w)(()=>re)}var It=A(5137),De=A(2181),Re=A(2994),Ge=A(6304),Ye=A(6814),de=A(8697);A(7142);const ye=new m.OlP("angularfire2.auth.use-emulator"),Ke=new m.OlP("angularfire2.auth.settings"),rt=new m.OlP("angularfire2.auth.tenant-id"),F=new m.OlP("angularfire2.auth.langugage-code"),_=new m.OlP("angularfire2.auth.use-device-language"),Ue=new m.OlP("angularfire.auth.persistence"),pt=(re,ge,Ce,Fe,Ne,je,Se,at)=>(0,Ge.cc)(`${re.name}.auth`,"AngularFireAuth",re.name,()=>{const J=ge.runOutsideAngular(()=>re.auth());if(Ce&&J.useEmulator(...Ce),Fe&&(J.tenantId=Fe),J.languageCode=Ne,je&&J.useDeviceLanguage(),Se)for(const[We,j]of Object.entries(Se))J.settings[We]=j;return at&&J.setPersistence(at),J},[Ce,Fe,Ne,je,Se,at]);let Q=(()=>{class re{constructor(Ce,Fe,Ne,je,Se,at,J,We,j,te,q,me){const $e=new S.x,Xe=(0,C.of)(void 0).pipe((0,ae.Q)(Se.outsideAngular),(0,ne.w)(()=>je.runOutsideAngular(()=>Promise.resolve().then(A.bind(A,6365)))),(0,Oe.U)(()=>(0,Ge.on)(Ce,je,Fe)),(0,Oe.U)(Ae=>pt(Ae,je,at,We,j,te,J,q)),(0,ft.d)({bufferSize:1,refCount:!1}));if((0,Ye.PM)(Ne))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,C.of)(null);else{Xe.pipe((0,O.P)()).subscribe();const Le=Xe.pipe((0,ne.w)(we=>we.getRedirectResult().then(ze=>ze,()=>null)),Re.iC,(0,ft.d)({bufferSize:1,refCount:!1})),bt=Xe.pipe((0,ne.w)(we=>new ie.y(ze=>({unsubscribe:je.runOutsideAngular(()=>we.onAuthStateChanged(xe=>ze.next(xe),xe=>ze.error(xe),()=>ze.complete()))})))),ht=Xe.pipe((0,ne.w)(we=>new ie.y(ze=>({unsubscribe:je.runOutsideAngular(()=>we.onIdTokenChanged(xe=>ze.next(xe),xe=>ze.error(xe),()=>ze.complete()))}))));this.authState=Le.pipe(ce(bt),(0,It.R)(Se.outsideAngular),(0,ae.Q)(Se.insideAngular)),this.user=Le.pipe(ce(ht),(0,It.R)(Se.outsideAngular),(0,ae.Q)(Se.insideAngular)),this.idToken=this.user.pipe((0,ne.w)(we=>we?(0,W.D)(we.getIdToken()):(0,C.of)(null))),this.idTokenResult=this.user.pipe((0,ne.w)(we=>we?(0,W.D)(we.getIdTokenResult()):(0,C.of)(null))),this.credential=(0,f.T)(Le,$e,this.authState.pipe((0,De.h)(we=>!we))).pipe((0,Oe.U)(we=>we?.user?we:null),(0,It.R)(Se.outsideAngular),(0,ae.Q)(Se.insideAngular))}return(0,Ge.pX)(this,Xe,je,{spy:{apply:(Ae,Le,bt)=>{(Ae.startsWith("signIn")||Ae.startsWith("createUser"))&&bt.then(ht=>$e.next(ht))}}})}}return re.\u0275fac=function(Ce){return new(Ce||re)(m.LFG(Ge.Dh),m.LFG(Ge.xv,8),m.LFG(m.Lbi),m.LFG(m.R0b),m.LFG(Re.HU),m.LFG(ye,8),m.LFG(Ke,8),m.LFG(rt,8),m.LFG(F,8),m.LFG(_,8),m.LFG(Ue,8),m.LFG(de.nm,8))},re.\u0275prov=m.Yz7({token:re,factory:re.\u0275fac,providedIn:"any"}),re})()},7523:(Vt,He,A)=>{A.d(He,{KQ:()=>nc});var m=A(5879),S=A(6321),C=A(5592),ie=A(2096),W=A(3019),f=A(7398),ae=A(3020),ne=A(4664),Oe=A(6699),ft=A(3997),O=A(9360),Te=A(8251),ce=A(4829),It=A(2737),De=A(2420),Re=A(9940),de=A(2994),Z=A(6304),ye=(A(6365),A(3106)),Ke=A(4537),rt=A(5861),F=A(4303),_=A(9058),Ue=A(7879);const pt="@firebase/database",Q="0.14.4";let it="";function re(n){it=n}class ge{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,_.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,_.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Ce{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,_.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Fe=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ge(e)}}catch{}return new Ce},Ne=Fe("localStorage"),je=Fe("sessionStorage"),Se=new Ue.Yd("@firebase/database"),at=function(){let n=1;return function(){return n++}}(),J=function(n){const e=(0,_.dS)(n),t=new _.gQ;t.update(e);const r=t.digest();return _.US.encodeByteArray(r)},We=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=We.apply(null,r):e+="object"==typeof r?(0,_.Wl)(r):r,e+=" "}return e};let j=null,te=!0;const q=function(n,e){(0,_.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Se.logLevel=Ue.in.VERBOSE,j=Se.log.bind(Se),e&&je.set("logging_enabled",!0)):"function"==typeof n?j=n:(j=null,je.remove("logging_enabled"))},me=function(...n){if(!0===te&&(te=!1,null===j&&!0===je.get("logging_enabled")&&q(!0)),j){const e=We.apply(null,n);j(e)}},$e=function(n){return function(...e){me(n,...e)}},Xe=function(...n){const e="FIREBASE INTERNAL ERROR: "+We(...n);Se.error(e)},Ae=function(...n){const e=`FIREBASE FATAL ERROR: ${We(...n)}`;throw Se.error(e),new Error(e)},Le=function(...n){const e="FIREBASE WARNING: "+We(...n);Se.warn(e)},ht=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},ze="[MIN_NAME]",xe="[MAX_NAME]",_t=function(n,e){if(n===e)return 0;if(n===ze||e===xe)return-1;if(e===ze||n===xe)return 1;{const t=B(n),r=B(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},Dt=function(n,e){return n===e?0:n<e?-1:1},et=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,_.Wl)(e))},Et=function(n){if("object"!=typeof n||null===n)return(0,_.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,_.Wl)(e[r]),t+=":",t+=Et(n[e[r]]);return t+="}",t},kt=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let o=0;o<t;o+=e)r.push(n.substring(o,o+e>t?t:o+e));return r};function nt(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const zt=function(n){(0,_.hu)(!ht(n),"Invalid JSON number");const r=1023;let o,u,c,h,g;0===n?(u=0,c=0,o=1/n==-1/0?1:0):(o=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),u=h+r,c=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(u=0,c=Math.round(n/Math.pow(2,-1074))));const v=[];for(g=52;g;g-=1)v.push(c%2?1:0),c=Math.floor(c/2);for(g=11;g;g-=1)v.push(u%2?1:0),u=Math.floor(u/2);v.push(o?1:0),v.reverse();const N=v.join("");let D="";for(g=0;g<64;g+=8){let L=parseInt(N.substr(g,8),2).toString(16);1===L.length&&(L="0"+L),D+=L}return D.toLowerCase()},sn=new RegExp("^-?(0*)\\d{1,10}$"),B=function(n){if(sn.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},H=function(n){try{n()}catch(e){setTimeout(()=>{throw Le("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},fe=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class le{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Le(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Ve{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(o=>this.auth_=o)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(me("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Le(e)}}let ct=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const Tt=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Jt="websocket",Mt="long_polling";class b{constructor(e,t,r,o,u=!1,c="",h=!1,g=!1){this.secure=t,this.namespace=r,this.webSocketOnly=o,this.nodeAdmin=u,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=g,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ne.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ne.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function y(n,e,t){let r;if((0,_.hu)("string"==typeof e,"typeof type must == string"),(0,_.hu)("object"==typeof t,"typeof params must == object"),e===Jt)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==Mt)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function E(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const o=[];return nt(t,(u,c)=>{o.push(u+"="+c)}),r+o.join("&")}class M{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,_.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,_.p$)(this.counters_)}}const G={},oe={};function Ie(n){const e=n.toString();return G[e]||(G[e]=new M),G[e]}class Qe{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let o=0;o<r.length;++o)r[o]&&H(()=>{this.onMessage_(r[o])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Zt{constructor(e,t,r,o,u,c,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=o,this.authToken=u,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=$e(e),this.stats_=Ie(t),this.urlFn=g=>(this.appCheckToken&&(g.ac=this.appCheckToken),y(t,Mt,g))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Qe(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,_.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mn((...u)=>{const[c,h,g,v,N]=u;if(this.incrementIncomingBytes_(u),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===c)this.id=h,this.password=g;else{if("close"!==c)throw new Error("Unrecognized command received: "+c);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...u)=>{const[c,h]=u;this.incrementIncomingBytes_(u),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&Tt.test(location.hostname)&&(r.r="f");const o=this.urlFn(r);this.log_("Connecting via long-poll to "+o),this.scriptTagHolder.addTag(o,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Zt.forceAllow_=!0}static forceDisallow(){Zt.forceDisallow_=!0}static isAvailable(){return!((0,_.Yr)()||!Zt.forceAllow_&&(Zt.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,_.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,_.h$)(t),o=kt(r,1840);for(let u=0;u<o.length;u++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,o.length,o[u]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,_.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,_.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class mn{constructor(e,t,r,o){if(this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,_.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=at(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=mn.createIFrame_();let u="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(u='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){me("frame writing exception"),h.stack&&me(h.stack),me(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||me("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",o=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const c=this.pendingSegs.shift();r=r+"&seg"+o+"="+c.seg+"&ts"+o+"="+c.ts+"&d"+o+"="+c.d,o++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},o=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(o),r()})}addTag(e,t){(0,_.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const o=r.readyState;(!o||"loaded"===o||"complete"===o)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{me("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let an=null;typeof MozWebSocket<"u"?an=MozWebSocket:typeof WebSocket<"u"&&(an=WebSocket);let vn=(()=>{class n{constructor(t,r,o,u,c,h,g){this.connId=t,this.applicationId=o,this.appCheckToken=u,this.authToken=c,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=$e(this.connId),this.stats_=Ie(r),this.connURL=n.connectionURL_(r,h,g,u,o),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,o,u,c){const h={v:"5"};return!(0,_.Yr)()&&typeof location<"u"&&location.hostname&&Tt.test(location.hostname)&&(h.r="f"),r&&(h.s=r),o&&(h.ls=o),u&&(h.ac=u),c&&(h.p=c),y(t,Jt,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ne.set("previous_websocket_failure",!0);try{let o;if((0,_.Yr)()){o={headers:{"User-Agent":`Firebase/5/${it}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(o.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(o.headers["X-Firebase-AppCheck"]=this.appCheckToken);const c=process.env,h=0===this.connURL.indexOf("wss://")?c.HTTPS_PROXY||c.https_proxy:c.HTTP_PROXY||c.http_proxy;h&&(o.proxy={origin:h})}this.mySock=new an(this.connURL,[],o)}catch(o){this.log_("Error instantiating WebSocket.");const u=o.message||o.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=o=>{this.handleIncomingFrame(o)},this.mySock.onerror=o=>{this.log_("WebSocket error.  Closing connection.");const u=o.message||o.data;u&&this.log_(u),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const o=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);o&&o.length>1&&parseFloat(o[1])<4.4&&(t=!0)}return!t&&null!==an&&!n.forceDisallow_}static previouslyFailed(){return Ne.isInMemoryStorage||!0===Ne.get("previous_websocket_failure")}markConnectionHealthy(){Ne.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const o=(0,_.cI)(r);this.onMessage(o)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,_.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const o=this.extractFrameCount_(r);null!==o&&this.appendFrame_(o)}}send(t){this.resetKeepAlive();const r=(0,_.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const o=kt(r,16384);o.length>1&&this.sendString_(String(o.length));for(let u=0;u<o.length;u++)this.sendString_(o[u])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Nn=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Zt,vn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=vn&&vn.isAvailable();let o=r&&!vn.previouslyFailed();if(t.webSocketOnly&&(r||Le("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[vn];else{const u=this.transports_=[];for(const c of n.ALL_TRANSPORTS)c&&c.isAvailable()&&u.push(c);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class Dn{constructor(e,t,r,o,u,c,h,g,v,N){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=o,this.authToken_=u,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=g,this.onKill_=v,this.lastSessionId=N,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=$e("c:"+this.id+":"),this.transportManager_=new Nn(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const o=e.healthyTimeout||0;o>0&&(this.healthyTimeout_=fe(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(o)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=et("t",e),r=et("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=et("t",e),r=et("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=et("t",e);if("d"in e){const r=e.d;if("h"===t){const o=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(o.h=this.repoInfo_.host),this.onHandshake_(o)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let o=0;o<this.pendingDataMessages.length;++o)this.onDataMessage_(this.pendingDataMessages[o]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?Xe("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Xe("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,o=e.h;this.sessionId=e.s,this.repoInfo_.host=o,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&Le("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),fe(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):fe(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ne.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Ht{put(e,t,r,o){}merge(e,t,r,o){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class wr{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,_.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let o=0;o<r.length;o++)r[o].callback.apply(r[o].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const o=this.getInitialEvent(e);o&&t.apply(r,o)}off(e,t,r){this.validateEventType_(e);const o=this.listeners_[e]||[];for(let u=0;u<o.length;u++)if(o[u].callback===t&&(!r||r===o[u].context))return void o.splice(u,1)}validateEventType_(e){(0,_.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class T extends wr{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,_.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new T}getInitialEvent(e){return(0,_.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class k{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[r]=this.pieces_[o],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function x(){return new k("")}function V(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ue(n){return n.pieces_.length-n.pieceNum_}function se(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new k(n.pieces_,e)}function be(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Xt(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function lt(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new k(e,0)}function qe(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof k)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let o=0;o<r.length;o++)r[o].length>0&&t.push(r[o])}return new k(t,0)}function _e(n){return n.pieceNum_>=n.pieces_.length}function ut(n,e){const t=V(n),r=V(e);if(null===t)return e;if(t===r)return ut(se(n),se(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function ul(n,e){const t=Xt(n,0),r=Xt(e,0);for(let o=0;o<t.length&&o<r.length;o++){const u=_t(t[o],r[o]);if(0!==u)return u}return t.length===r.length?0:t.length<r.length?-1:1}function Sr(n,e){if(ue(n)!==ue(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function st(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ue(n)>ue(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class nr{constructor(e,t){this.errorPrefix_=t,this.parts_=Xt(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,_.ug)(this.parts_[r]);mo(this)}}function mo(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ln(n))}function Ln(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class Yi extends wr{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Yi}getInitialEvent(e){return(0,_.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const en=1e3;let Mn,In=(()=>{class n extends Ht{constructor(t,r,o,u,c,h,g,v){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=o,this.onConnectStatus_=u,this.onServerInfoUpdate_=c,this.authTokenProvider_=h,this.appCheckTokenProvider_=g,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=$e("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=en,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,_.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Yi.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&T.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,o){const u=++this.requestNumber_,c={r:u,a:t,b:r};this.log_((0,_.Wl)(c)),(0,_.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(c),o&&(this.requestCBHash_[u]=o)}get(t){this.initConnection_();const r=new _.BH,u={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const g=h.d;"ok"===h.s?r.resolve(g):r.reject(g)}};return this.outstandingGets_.push(u),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,o,u){this.initConnection_();const c=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+c),this.listens.has(h)||this.listens.set(h,new Map),(0,_.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,_.hu)(!this.listens.get(h).has(c),"listen() called twice for same path/queryId.");const g={onComplete:u,hashFn:r,query:t,tag:o};this.listens.get(h).set(c,g),this.connected_&&this.sendListen_(g)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,o=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(o)})}sendListen_(t){const r=t.query,o=r._path.toString(),u=r._queryIdentifier;this.log_("Listen on "+o+" for "+u);const c={p:o};t.tag&&(c.q=r._queryObject,c.t=t.tag),c.h=t.hashFn(),this.sendRequest("q",c,g=>{const v=g.d,N=g.s;n.warnOnListenWarnings_(v,r),(this.listens.get(o)&&this.listens.get(o).get(u))===t&&(this.log_("listen response",g),"ok"!==N&&this.removeListen_(o,u),t.onComplete&&t.onComplete(N,v))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,_.r3)(t,"w")){const o=(0,_.DV)(t,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){const u='".indexOn": "'+r._queryParams.getIndex().toString()+'"',c=r._path.toString();Le(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${u} at ${c} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,_.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,_.w9)(t)?"auth":"gauth",o={cred:t};null===this.authOverride_?o.noauth=!0:"object"==typeof this.authOverride_&&(o.authvar=this.authOverride_),this.sendRequest(r,o,u=>{const c=u.s,h=u.d||"error";this.authToken_===t&&("ok"===c?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(c,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,o=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,o)})}unlisten(t,r){const o=t._path.toString(),u=t._queryIdentifier;this.log_("Unlisten called for "+o+" "+u),(0,_.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(o,u)&&this.connected_&&this.sendUnlisten_(o,u,t._queryObject,r)}sendUnlisten_(t,r,o,u){this.log_("Unlisten on "+t+" for "+r);const c={p:t};u&&(c.q=o,c.t=u),this.sendRequest("n",c)}onDisconnectPut(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:o})}onDisconnectMerge(t,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,o):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:o})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,o,u){const c={p:r,d:o};this.log_("onDisconnect "+t,c),this.sendRequest(t,c,h=>{u&&setTimeout(()=>{u(h.s,h.d)},Math.floor(0))})}put(t,r,o,u){this.putInternal("p",t,r,o,u)}merge(t,r,o,u){this.putInternal("m",t,r,o,u)}putInternal(t,r,o,u,c){this.initConnection_();const h={p:r,d:o};void 0!==c&&(h.h=c),this.outstandingPuts_.push({action:t,request:h,onComplete:u}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,o=this.outstandingPuts_[t].request,u=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,o,c=>{this.log_(r+" response",c),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),u&&u(c.s,c.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,o=>{"ok"!==o.s&&this.log_("reportStats","Error sending stats: "+o.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,_.Wl)(t));const r=t.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):Xe("Unrecognized action received from server: "+(0,_.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,_.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=en),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,rt.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),o=t.onReady_.bind(t),u=t.onRealtimeDisconnect_.bind(t),c=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let g=!1,v=null;const N=function(){v?v.close():(g=!0,u())};t.realtime_={close:N,sendRequest:function($){(0,_.hu)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest($)}};const L=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[$,ee]=yield Promise.all([t.authTokenProvider_.getToken(L),t.appCheckTokenProvider_.getToken(L)]);g?me("getToken() completed but was canceled"):(me("getToken() completed. Creating connection."),t.authToken_=$&&$.accessToken,t.appCheckToken_=ee&&ee.token,v=new Dn(c,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,o,u,ke=>{Le(ke+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch($){t.log_("Failed to get token: "+$),g||(t.repoInfo_.nodeAdmin&&Le($),N())}}})()}interrupt(t){me("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){me("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,_.xb)(this.interruptReasons_)&&(this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let o;o=r?r.map(c=>Et(c)).join("$"):"default";const u=this.removeListen_(t,o);u&&u.onComplete&&u.onComplete("permission_denied")}removeListen_(t,r){const o=new k(t).toString();let u;if(this.listens.has(o)){const c=this.listens.get(o);u=c.get(r),c.delete(r),0===c.size&&this.listens.delete(o)}else u=void 0;return u}onAuthRevoked_(t,r){me("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){me("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,_.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+it.replace(/\./g,"-")]=1,(0,_.uI)()?t["framework.cordova"]=1:(0,_.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=T.getInstance().currentlyOnline();return(0,_.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class ve{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ve(e,t)}}class rr{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new ve(ze,e),o=new ve(ze,t);return 0!==this.compare(r,o)}minPost(){return ve.MIN}}class qi extends rr{static get __EMPTY_NODE(){return Mn}static set __EMPTY_NODE(e){Mn=e}compare(e,t){return _t(e.name,t.name)}isDefinedOn(e){throw(0,_.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ve.MIN}maxPost(){return new ve(xe,Mn)}makePost(e,t){return(0,_.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new ve(e,Mn)}toString(){return".key"}}const Gt=new qi;class di{constructor(e,t,r,o,u=null){this.isReverse_=o,this.resultGenerator_=u,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(c=t?r(e.key,t):1,o&&(c*=-1),c<0)e=this.isReverse_?e.left:e.right;else{if(0===c){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let fi,Ot=(()=>{class n{constructor(t,r,o,u,c){this.key=t,this.value=r,this.color=o??n.RED,this.left=u??vt.EMPTY_NODE,this.right=c??vt.EMPTY_NODE}copy(t,r,o,u,c){return new n(t??this.key,r??this.value,o??this.color,u??this.left,c??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,o){let u=this;const c=o(t,u.key);return u=c<0?u.copy(null,null,null,u.left.insert(t,r,o),null):0===c?u.copy(null,r,null,null,null):u.copy(null,null,null,null,u.right.insert(t,r,o)),u.fixUp_()}removeMin_(){if(this.left.isEmpty())return vt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let o,u;if(o=this,r(t,o.key)<0)!o.left.isEmpty()&&!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.remove(t,r),null);else{if(o.left.isRed_()&&(o=o.rotateRight_()),!o.right.isEmpty()&&!o.right.isRed_()&&!o.right.left.isRed_()&&(o=o.moveRedRight_()),0===r(t,o.key)){if(o.right.isEmpty())return vt.EMPTY_NODE;u=o.right.min_(),o=o.copy(u.key,u.value,null,null,o.right.removeMin_())}o=o.copy(null,null,null,null,o.right.remove(t,r))}return o.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class vt{constructor(e,t=vt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new vt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ot.BLACK,null,null))}remove(e){return new vt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ot.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,o=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return o?o.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(o=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new di(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new di(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new di(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new di(this.root_,null,this.comparator_,!0,e)}}function hi(n,e){return _t(n.name,e.name)}function br(n,e){return _t(n,e)}vt.EMPTY_NODE=new class Ji{copy(e,t,r,o,u){return this}insert(e,t,r){return new Ot(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const es=function(n){return"number"==typeof n?"number:"+zt(n):"string:"+n},pi=function(n){if(n.isLeafNode()){const e=n.val();(0,_.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,_.r3)(e,".sv"),"Priority must be a string or number.")}else(0,_.hu)(n===fi||n.isEmpty(),"priority of unexpected type.");(0,_.hu)(n===fi||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let kr,ts,_i,En=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,_.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),pi(this.priorityNode_)}static set __childrenNodeConstructor(t){kr=t}static get __childrenNodeConstructor(){return kr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return _e(t)?this:".priority"===V(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const o=V(t);return null===o?r:r.isEmpty()&&".priority"!==o?this:((0,_.hu)(".priority"!==o||1===ue(t),".priority must be the last token in a path"),this.updateImmediateChild(o,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(se(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+es(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?zt(this.value_):this.value_,this.lazyHash_=J(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,_.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,o=typeof this.value_,u=n.VALUE_TYPE_ORDER.indexOf(r),c=n.VALUE_TYPE_ORDER.indexOf(o);return(0,_.hu)(u>=0,"Unknown leaf type: "+r),(0,_.hu)(c>=0,"Unknown leaf type: "+o),u===c?"object"===o?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:c-u}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Me=new class da extends rr{compare(e,t){const r=e.node.getPriority(),o=t.node.getPriority(),u=r.compareTo(o);return 0===u?_t(e.name,t.name):u}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ve.MIN}maxPost(){return new ve(xe,new En("[PRIORITY-POST]",_i))}makePost(e,t){const r=ts(e);return new ve(t,new En("[PRIORITY-POST]",r))}toString(){return".priority"}},ha=Math.log(2);class rs{constructor(e){this.count=parseInt(Math.log(e+1)/ha,10),this.current_=this.count-1;const o=(u=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&o}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Un=function(n,e,t,r){n.sort(e);const o=function(g,v){const N=v-g;let D,L;if(0===N)return null;if(1===N)return D=n[g],L=t?t(D):D,new Ot(L,D.node,Ot.BLACK,null,null);{const $=parseInt(N/2,10)+g,ee=o(g,$),ke=o($+1,v);return D=n[$],L=t?t(D):D,new Ot(L,D.node,Ot.BLACK,ee,ke)}},h=function(g){let v=null,N=null,D=n.length;const L=function(ee,ke){const yt=D-ee,Pn=D;D-=ee;const Qn=o(yt+1,Pn),Zi=n[yt],rc=t?t(Zi):Zi;$(new Ot(rc,Zi.node,ke,null,Qn))},$=function(ee){v?(v.left=ee,v=ee):(N=ee,v=ee)};for(let ee=0;ee<g.count;++ee){const ke=g.nextBitIsOne(),yt=Math.pow(2,g.count-(ee+1));ke?L(yt,Ot.BLACK):(L(yt,Ot.BLACK),L(yt,Ot.RED))}return N}(new rs(n.length));return new vt(r||e,h)};let Nr;const ln={};class un{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,_.hu)(ln&&Me,"ChildrenNode.ts has not been loaded"),Nr=Nr||new un({".priority":ln},{".priority":Me}),Nr}get(e){const t=(0,_.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof vt?t:null}hasIndex(e){return(0,_.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,_.hu)(e!==Gt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let o=!1;const u=t.getIterator(ve.Wrap);let h,c=u.getNext();for(;c;)o=o||e.isDefinedOn(c.node),r.push(c),c=u.getNext();h=o?Un(r,e.getCompare()):ln;const g=e.toString(),v=Object.assign({},this.indexSet_);v[g]=e;const N=Object.assign({},this.indexes_);return N[g]=h,new un(N,v)}addToIndexes(e,t){const r=(0,_.UI)(this.indexes_,(o,u)=>{const c=(0,_.DV)(this.indexSet_,u);if((0,_.hu)(c,"Missing index implementation for "+u),o===ln){if(c.isDefinedOn(e.node)){const h=[],g=t.getIterator(ve.Wrap);let v=g.getNext();for(;v;)v.name!==e.name&&h.push(v),v=g.getNext();return h.push(e),Un(h,c.getCompare())}return ln}{const h=t.get(e.name);let g=o;return h&&(g=g.remove(new ve(e.name,h))),g.insert(e,e.node)}});return new un(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,_.UI)(this.indexes_,o=>{if(o===ln)return o;{const u=t.get(e.name);return u?o.remove(new ve(e.name,u)):o}});return new un(r,this.indexSet_)}}let Fn,he=(()=>{class n{constructor(t,r,o){this.children_=t,this.priorityNode_=r,this.indexMap_=o,this.lazyHash_=null,this.priorityNode_&&pi(this.priorityNode_),this.children_.isEmpty()&&(0,_.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Fn||(Fn=new n(new vt(br),null,un.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Fn}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?Fn:r}}getChild(t){const r=V(t);return null===r?this:this.getImmediateChild(r).getChild(se(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,_.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const o=new ve(t,r);let u,c;r.isEmpty()?(u=this.children_.remove(t),c=this.indexMap_.removeFromIndexes(o,this.children_)):(u=this.children_.insert(t,r),c=this.indexMap_.addToIndexes(o,this.children_));const h=u.isEmpty()?Fn:this.priorityNode_;return new n(u,h,c)}}updateChild(t,r){const o=V(t);if(null===o)return r;{(0,_.hu)(".priority"!==V(t)||1===ue(t),".priority must be the last token in a path");const u=this.getImmediateChild(o).updateChild(se(t),r);return this.updateImmediateChild(o,u)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let o=0,u=0,c=!0;if(this.forEachChild(Me,(h,g)=>{r[h]=g.val(t),o++,c&&n.INTEGER_REGEXP_.test(h)?u=Math.max(u,Number(h)):c=!1}),!t&&c&&u<2*o){const h=[];for(const g in r)h[g]=r[g];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+es(this.getPriority().val())+":"),this.forEachChild(Me,(r,o)=>{const u=o.hash();""!==u&&(t+=":"+r+":"+u)}),this.lazyHash_=""===t?"":J(t)}return this.lazyHash_}getPredecessorChildName(t,r,o){const u=this.resolveIndex_(o);if(u){const c=u.getPredecessorKey(new ve(t,r));return c?c.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.minKey();return o&&o.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new ve(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const o=r.maxKey();return o&&o.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new ve(r,this.children_.get(r)):null}forEachChild(t,r){const o=this.resolveIndex_(t);return o?o.inorderTraversal(u=>r(u.name,u.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getIteratorFrom(t,u=>u);{const u=this.children_.getIteratorFrom(t.name,ve.Wrap);let c=u.peek();for(;null!=c&&r.compare(c,t)<0;)u.getNext(),c=u.peek();return u}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const o=this.resolveIndex_(r);if(o)return o.getReverseIteratorFrom(t,u=>u);{const u=this.children_.getReverseIteratorFrom(t.name,ve.Wrap);let c=u.peek();for(;null!=c&&r.compare(c,t)>0;)u.getNext(),c=u.peek();return u}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Or?-1:0}withIndex(t){if(t===Gt||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Gt||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const o=this.getIterator(Me),u=r.getIterator(Me);let c=o.getNext(),h=u.getNext();for(;c&&h;){if(c.name!==h.name||!c.node.equals(h.node))return!1;c=o.getNext(),h=u.getNext()}return null===c&&null===h}return!1}return!1}}resolveIndex_(t){return t===Gt?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Or=new class is extends he{constructor(){super(new vt(br),he.EMPTY_NODE,un.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return he.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(ve,{MIN:{value:new ve(ze,he.EMPTY_NODE)},MAX:{value:new ve(xe,Or)}}),qi.__EMPTY_NODE=he.EMPTY_NODE,En.__childrenNodeConstructor=he,function Xi(n){fi=n}(Or),function ns(n){_i=n}(Or);const ss=!0;function Je(n,e=null){if(null===n)return he.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,_.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new En(n,Je(e));if(n instanceof Array||!ss){let t=he.EMPTY_NODE;return nt(n,(r,o)=>{if((0,_.r3)(n,r)&&"."!==r.substring(0,1)){const u=Je(o);(u.isLeafNode()||!u.isEmpty())&&(t=t.updateImmediateChild(r,u))}}),t.updatePriority(Je(e))}{const t=[];let r=!1;if(nt(n,(c,h)=>{if("."!==c.substring(0,1)){const g=Je(h);g.isEmpty()||(r=r||!g.getPriority().isEmpty(),t.push(new ve(c,g)))}}),0===t.length)return he.EMPTY_NODE;const u=Un(t,hi,c=>c.name,br);if(r){const c=Un(t,Me.getCompare());return new he(u,Je(e),new un({".priority":c},{".priority":Me}))}return new he(u,Je(e),un.Default)}}!function yo(n){ts=n}(Je);class Dr extends rr{constructor(e){super(),this.indexPath_=e,(0,_.hu)(!_e(e)&&".priority"!==V(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),o=this.extractChild(t.node),u=r.compareTo(o);return 0===u?_t(e.name,t.name):u}makePost(e,t){const r=Je(e),o=he.EMPTY_NODE.updateChild(this.indexPath_,r);return new ve(t,o)}maxPost(){const e=he.EMPTY_NODE.updateChild(this.indexPath_,Or);return new ve(xe,e)}toString(){return Xt(this.indexPath_,0).join("/")}}const xr=new class fa extends rr{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?_t(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ve.MIN}maxPost(){return ve.MAX}makePost(e,t){const r=Je(e);return new ve(t,r)}toString(){return".value"}};function Io(n){return{type:"value",snapshotNode:n}}function Tn(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Lr(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Mr(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class as{constructor(e){this.index_=e}updateChild(e,t,r,o,u,c){(0,_.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(o).equals(r.getChild(o))&&h.isEmpty()===r.isEmpty()||(null!=c&&(r.isEmpty()?e.hasChild(t)?c.trackChildChange(Lr(t,h)):(0,_.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(Tn(t,r)):c.trackChildChange(Mr(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Me,(o,u)=>{t.hasChild(o)||r.trackChildChange(Lr(o,u))}),t.isLeafNode()||t.forEachChild(Me,(o,u)=>{if(e.hasChild(o)){const c=e.getImmediateChild(o);c.equals(u)||r.trackChildChange(Mr(o,u,c))}else r.trackChildChange(Tn(o,u))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?he.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Ur{constructor(e){this.indexedFilter_=new as(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ur.getStartPost_(e),this.endPost_=Ur.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,o,u,c){return this.matches(new ve(t,r))||(r=he.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,o,u,c)}updateFullNode(e,t,r){t.isLeafNode()&&(t=he.EMPTY_NODE);let o=t.withIndex(this.index_);o=o.updatePriority(he.EMPTY_NODE);const u=this;return t.forEachChild(Me,(c,h)=>{u.matches(new ve(c,h))||(o=o.updateImmediateChild(c,he.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,o,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class ls{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Ur(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,o,u,c){return this.rangedFilter_.matches(new ve(t,r))||(r=he.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,o,u,c):this.fullLimitUpdateChild_(e,t,r,u,c)}updateFullNode(e,t,r){let o;if(t.isLeafNode()||t.isEmpty())o=he.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let u;o=he.EMPTY_NODE.withIndex(this.index_),u=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;u.hasNext()&&c<this.limit_;){const h=u.getNext();if(this.withinDirectionalStart(h)){if(!this.withinDirectionalEnd(h))break;o=o.updateImmediateChild(h.name,h.node),c++}}}else{let u;o=t.withIndex(this.index_),o=o.updatePriority(he.EMPTY_NODE),u=this.reverse_?o.getReverseIterator(this.index_):o.getIterator(this.index_);let c=0;for(;u.hasNext();){const h=u.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:o=o.updateImmediateChild(h.name,he.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,o,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,o,u){let c;if(this.reverse_){const D=this.index_.getCompare();c=(L,$)=>D($,L)}else c=this.index_.getCompare();const h=e;(0,_.hu)(h.numChildren()===this.limit_,"");const g=new ve(t,r),v=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),N=this.rangedFilter_.matches(g);if(h.hasChild(t)){const D=h.getImmediateChild(t);let L=o.getChildAfterChild(this.index_,v,this.reverse_);for(;null!=L&&(L.name===t||h.hasChild(L.name));)L=o.getChildAfterChild(this.index_,L,this.reverse_);const $=null==L?1:c(L,g);if(N&&!r.isEmpty()&&$>=0)return u?.trackChildChange(Mr(t,r,D)),h.updateImmediateChild(t,r);{u?.trackChildChange(Lr(t,D));const ke=h.updateImmediateChild(t,he.EMPTY_NODE);return null!=L&&this.rangedFilter_.matches(L)?(u?.trackChildChange(Tn(L.name,L.node)),ke.updateImmediateChild(L.name,L.node)):ke}}return r.isEmpty()?e:N&&c(v,g)>=0?(null!=u&&(u.trackChildChange(Lr(v.name,v.node)),u.trackChildChange(Tn(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(v.name,he.EMPTY_NODE)):e}}class gi{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Me}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,_.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,_.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ze}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,_.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,_.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xe}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,_.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Me}copy(){const e=new gi;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ds(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function fs(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function mi(n,e){const t=n.copy();return t.index_=e,t}function vi(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Me?t="$priority":n.index_===xr?t="$value":n.index_===Gt?t="$key":((0,_.hu)(n.index_ instanceof Dr,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,_.Wl)(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=(0,_.Wl)(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+(0,_.Wl)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=(0,_.Wl)(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+(0,_.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Eo(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Me&&(e.i=n.index_.toString()),e}class ir extends Ht{constructor(e,t,r,o){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=o,this.log_=$e("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,_.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,o){const u=e._path.toString();this.log_("Listen called for "+u+" "+e._queryIdentifier);const c=ir.getListenId_(e,r),h={};this.listens_[c]=h;const g=vi(e._queryParams);this.restRequest_(u+".json",g,(v,N)=>{let D=N;if(404===v&&(D=null,v=null),null===v&&this.onDataUpdate_(u,D,!1,r),(0,_.DV)(this.listens_,c)===h){let L;L=v?401===v?"permission_denied":"rest_error:"+v:"ok",o(L,null)}})}unlisten(e,t){const r=ir.getListenId_(e,t);delete this.listens_[r]}get(e){const t=vi(e._queryParams),r=e._path.toString(),o=new _.BH;return this.restRequest_(r+".json",t,(u,c)=>{let h=c;404===u&&(h=null,u=null),null===u?(this.onDataUpdate_(r,h,!1,null),o.resolve(h)):o.reject(new Error(h))}),o.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([o,u])=>{o&&o.accessToken&&(t.auth=o.accessToken),u&&u.token&&(t.ac=u.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,_.xO)(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let g=null;if(h.status>=200&&h.status<300){try{g=(0,_.cI)(h.responseText)}catch{Le("Failed to parse JSON response for "+c+": "+h.responseText)}r(null,g)}else 401!==h.status&&404!==h.status&&Le("Got unsuccessful REST response for "+c+" Status: "+h.status),r(h.status);r=null}},h.open("GET",c,!0),h.send()})}}class _a{constructor(){this.rootNode_=he.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function yi(){return{value:null,children:new Map}}function Wn(n,e,t){if(_e(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=V(e);n.children.has(r)||n.children.set(r,yi()),Wn(n.children.get(r),e=se(e),t)}}function Fr(n,e){if(_e(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Me,(r,o)=>{Wn(n,new k(r),o)}),Fr(n,e)}}if(n.children.size>0){const t=V(e);return e=se(e),n.children.has(t)&&Fr(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function _s(n,e,t){null!==n.value?t(e,n.value):function sr(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,o)=>{_s(o,new k(e.toString()+"/"+r),t)})}class To{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&nt(this.last_,(r,o)=>{t[r]=t[r]-o}),this.last_=e,t}}class va{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new To(e);const r=1e4+2e4*Math.random();fe(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;nt(e,(o,u)=>{u>0&&(0,_.r3)(this.statsToReport_,o)&&(t[o]=u,r=!0)}),r&&this.server_.reportStats(t),fe(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var tn=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(tn||{});function ms(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class vs{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=tn.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(_e(this.path)){if(null!=this.affectedTree.value)return(0,_.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new k(e));return new vs(x(),t,this.revert)}}return(0,_.hu)(V(this.path)===e,"operationForChild called for unrelated child."),new vs(se(this.path),this.affectedTree,this.revert)}}class Ii{constructor(e,t){this.source=e,this.path=t,this.type=tn.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new Ii(this.source,x()):new Ii(this.source,se(this.path))}}class or{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=tn.OVERWRITE}operationForChild(e){return _e(this.path)?new or(this.source,x(),this.snap.getImmediateChild(e)):new or(this.source,se(this.path),this.snap)}}class Wr{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=tn.MERGE}operationForChild(e){if(_e(this.path)){const t=this.children.subtree(new k(e));return t.isEmpty()?null:t.value?new or(this.source,x(),t.value):new Wr(this.source,x(),t)}return(0,_.hu)(V(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Wr(this.source,se(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Vn{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;const t=V(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class ys{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Zn(n,e,t,r,o,u){const c=r.filter(h=>h.type===t);c.sort((h,g)=>function Ia(n,e,t){if(null==e.childName||null==t.childName)throw(0,_.g5)("Should only compare child_ events.");const r=new ve(e.childName,e.snapshotNode),o=new ve(t.childName,t.snapshotNode);return n.index_.compare(r,o)}(n,h,g)),c.forEach(h=>{const g=function ya(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,u);o.forEach(v=>{v.respondsTo(h.type)&&e.push(v.createEvent(g,n.query_))})})}function Ei(n,e){return{eventCache:n,serverCache:e}}function Vr(n,e,t,r){return Ei(new Vn(e,t,r),n.serverCache)}function Ti(n,e,t,r){return Ei(n.eventCache,new Vn(e,t,r))}function ar(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Hn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let lr;class Be{constructor(e,t=(()=>(lr||(lr=new vt(Dt)),lr))()){this.value=e,this.children=t}static fromObject(e){let t=new Be(null);return nt(e,(r,o)=>{t=t.set(new k(r),o)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:x(),value:this.value};if(_e(e))return null;{const r=V(e),o=this.children.get(r);if(null!==o){const u=o.findRootMostMatchingPathAndValue(se(e),t);return null!=u?{path:qe(new k(r),u.path),value:u.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{const t=V(e),r=this.children.get(t);return null!==r?r.subtree(se(e)):new Be(null)}}set(e,t){if(_e(e))return new Be(t,this.children);{const r=V(e),u=(this.children.get(r)||new Be(null)).set(se(e),t),c=this.children.insert(r,u);return new Be(this.value,c)}}remove(e){if(_e(e))return this.children.isEmpty()?new Be(null):new Be(null,this.children);{const t=V(e),r=this.children.get(t);if(r){const o=r.remove(se(e));let u;return u=o.isEmpty()?this.children.remove(t):this.children.insert(t,o),null===this.value&&u.isEmpty()?new Be(null):new Be(this.value,u)}return this}}get(e){if(_e(e))return this.value;{const t=V(e),r=this.children.get(t);return r?r.get(se(e)):null}}setTree(e,t){if(_e(e))return t;{const r=V(e),u=(this.children.get(r)||new Be(null)).setTree(se(e),t);let c;return c=u.isEmpty()?this.children.remove(r):this.children.insert(r,u),new Be(this.value,c)}}fold(e){return this.fold_(x(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((o,u)=>{r[o]=u.fold_(qe(e,o),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,x(),t)}findOnPath_(e,t,r){const o=!!this.value&&r(t,this.value);if(o)return o;if(_e(e))return null;{const u=V(e),c=this.children.get(u);return c?c.findOnPath_(se(e),qe(t,u),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,x(),t)}foreachOnPath_(e,t,r){if(_e(e))return this;{this.value&&r(t,this.value);const o=V(e),u=this.children.get(o);return u?u.foreachOnPath_(se(e),qe(t,o),r):new Be(null)}}foreach(e){this.foreach_(x(),e)}foreach_(e,t){this.children.inorderTraversal((r,o)=>{o.foreach_(qe(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Kt{constructor(e){this.writeTree_=e}static empty(){return new Kt(new Be(null))}}function Br(n,e,t){if(_e(e))return new Kt(new Be(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const o=r.path;let u=r.value;const c=ut(o,e);return u=u.updateChild(c,t),new Kt(n.writeTree_.set(o,u))}{const o=new Be(t),u=n.writeTree_.setTree(e,o);return new Kt(u)}}}function So(n,e,t){let r=n;return nt(t,(o,u)=>{r=Br(r,qe(e,o),u)}),r}function Is(n,e){if(_e(e))return Kt.empty();{const t=n.writeTree_.setTree(e,new Be(null));return new Kt(t)}}function Ro(n,e){return null!=cn(n,e)}function cn(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(ut(t.path,e)):null}function Po(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Me,(r,o)=>{e.push(new ve(r,o))}):n.writeTree_.children.inorderTraversal((r,o)=>{null!=o.value&&e.push(new ve(r,o.value))}),e}function Cn(n,e){if(_e(e))return n;{const t=cn(n,e);return new Kt(null!=t?new Be(t):n.writeTree_.subtree(e))}}function Gn(n){return n.writeTree_.isEmpty()}function ur(n,e){return ot(x(),n.writeTree_,e)}function ot(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((o,u)=>{".priority"===o?((0,_.hu)(null!==u.value,"Priority writes must always be leaf nodes"),r=u.value):t=ot(qe(n,o),u,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(qe(n,".priority"),r)),t}}function Ci(n,e){return Oo(e,n)}function Ca(n,e){if(n.snap)return st(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&st(qe(n.path,t),e))return!0;return!1}function Aa(n){return n.visible}function Zr(n,e,t){let r=Kt.empty();for(let o=0;o<n.length;++o){const u=n[o];if(e(u)){const c=u.path;let h;if(u.snap)st(t,c)?(h=ut(t,c),r=Br(r,h,u.snap)):st(c,t)&&(h=ut(c,t),r=Br(r,x(),u.snap.getChild(h)));else{if(!u.children)throw(0,_.g5)("WriteRecord should have .snap or .children");if(st(t,c))h=ut(t,c),r=So(r,h,u.children);else if(st(c,t))if(h=ut(c,t),_e(h))r=So(r,x(),u.children);else{const g=(0,_.DV)(u.children,V(h));if(g){const v=g.getChild(se(h));r=Br(r,x(),v)}}}}}return r}function Cs(n,e,t,r,o){if(r||o){const u=Cn(n.visibleWrites,e);return!o&&Gn(u)?t:o||null!=t||Ro(u,x())?ur(Zr(n.allWrites,function(v){return(v.visible||o)&&(!r||!~r.indexOf(v.writeId))&&(st(v.path,e)||st(e,v.path))},e),t||he.EMPTY_NODE):null}{const u=cn(n.visibleWrites,e);if(null!=u)return u;{const c=Cn(n.visibleWrites,e);return Gn(c)?t:null!=t||Ro(c,x())?ur(c,t||he.EMPTY_NODE):null}}}function wi(n,e,t,r){return Cs(n.writeTree,n.treePath,e,t,r)}function Gr(n,e){return function Hr(n,e,t){let r=he.EMPTY_NODE;const o=cn(n.visibleWrites,e);if(o)return o.isLeafNode()||o.forEachChild(Me,(u,c)=>{r=r.updateImmediateChild(u,c)}),r;if(t){const u=Cn(n.visibleWrites,e);return t.forEachChild(Me,(c,h)=>{const g=ur(Cn(u,new k(c)),h);r=r.updateImmediateChild(c,g)}),Po(u).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}return Po(Cn(n.visibleWrites,e)).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}(n.writeTree,n.treePath,e)}function Ss(n,e,t,r){return function Ai(n,e,t,r,o){(0,_.hu)(r||o,"Either existingEventSnap or existingServerSnap must exist");const u=qe(e,t);if(Ro(n.visibleWrites,u))return null;{const c=Cn(n.visibleWrites,u);return Gn(c)?o.getChild(t):ur(c,o.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function Si(n,e){return function As(n,e){return cn(n.visibleWrites,e)}(n.writeTree,qe(n.treePath,e))}function No(n,e,t){return function wa(n,e,t,r){const o=qe(e,t),u=cn(n.visibleWrites,o);return null!=u?u:r.isCompleteForChild(t)?ur(Cn(n.visibleWrites,o),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function Rs(n,e){return Oo(qe(n.treePath,e),n.writeTree)}function Oo(n,e){return{treePath:n,writeTree:e}}class Ra{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,_.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,_.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const o=this.changeMap.get(r);if(o){const u=o.type;if("child_added"===t&&"child_removed"===u)this.changeMap.set(r,Mr(r,e.snapshotNode,o.snapshotNode));else if("child_removed"===t&&"child_added"===u)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===u)this.changeMap.set(r,Lr(r,o.oldSnap));else if("child_changed"===t&&"child_added"===u)this.changeMap.set(r,Tn(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==u)throw(0,_.g5)("Illegal combination of changes: "+e+" occurred after "+o);this.changeMap.set(r,Mr(r,e.snapshotNode,o.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const Ri=new class Pa{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class Ps{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Vn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return No(this.writes_,e,r)}}getChildAfterChild(e,t,r){const o=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Hn(this.viewCache_),u=function Sa(n,e,t,r,o,u){return function ko(n,e,t,r,o,u,c){let h;const g=Cn(n.visibleWrites,e),v=cn(g,x());if(null!=v)h=v;else{if(null==t)return[];h=ur(g,t)}if(h=h.withIndex(c),h.isEmpty()||h.isLeafNode())return[];{const N=[],D=c.getCompare(),L=u?h.getReverseIteratorFrom(r,c):h.getIteratorFrom(r,c);let $=L.getNext();for(;$&&N.length<o;)0!==D($,r)&&N.push($),$=L.getNext();return N}}(n.writeTree,n.treePath,e,t,r,o,u)}(this.writes_,o,t,1,r,e);return 0===u.length?null:u[0]}}function Kr(n,e,t,r,o,u){const c=e.eventCache;if(null!=Si(r,t))return e;{let h,g;if(_e(t))if((0,_.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const v=Hn(e),D=Gr(r,v instanceof he?v:he.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),D,u)}else{const v=wi(r,Hn(e));h=n.filter.updateFullNode(e.eventCache.getNode(),v,u)}else{const v=V(t);if(".priority"===v){(0,_.hu)(1===ue(t),"Can't have a priority with additional path components");const N=c.getNode();g=e.serverCache.getNode();const D=Ss(r,t,N,g);h=null!=D?n.filter.updatePriority(N,D):c.getNode()}else{const N=se(t);let D;if(c.isCompleteForChild(v)){g=e.serverCache.getNode();const L=Ss(r,t,c.getNode(),g);D=null!=L?c.getNode().getImmediateChild(v).updateChild(N,L):c.getNode().getImmediateChild(v)}else D=No(r,v,e.serverCache);h=null!=D?n.filter.updateChild(c.getNode(),v,D,N,o,u):c.getNode()}}return Vr(e,h,c.isFullyInitialized()||_e(t),n.filter.filtersNodes())}}function Pi(n,e,t,r,o,u,c,h){const g=e.serverCache;let v;const N=c?n.filter:n.filter.getIndexedFilter();if(_e(t))v=N.updateFullNode(g.getNode(),r,null);else if(N.filtersNodes()&&!g.isFiltered()){const $=g.getNode().updateChild(t,r);v=N.updateFullNode(g.getNode(),$,null)}else{const $=V(t);if(!g.isCompleteForPath(t)&&ue(t)>1)return e;const ee=se(t),yt=g.getNode().getImmediateChild($).updateChild(ee,r);v=".priority"===$?N.updatePriority(g.getNode(),yt):N.updateChild(g.getNode(),$,yt,ee,Ri,null)}const D=Ti(e,v,g.isFullyInitialized()||_e(t),N.filtersNodes());return Kr(n,D,t,o,new Ps(o,D,u),h)}function bs(n,e,t,r,o,u,c){const h=e.eventCache;let g,v;const N=new Ps(o,e,u);if(_e(t))v=n.filter.updateFullNode(e.eventCache.getNode(),r,c),g=Vr(e,v,!0,n.filter.filtersNodes());else{const D=V(t);if(".priority"===D)v=n.filter.updatePriority(e.eventCache.getNode(),r),g=Vr(e,v,h.isFullyInitialized(),h.isFiltered());else{const L=se(t),$=h.getNode().getImmediateChild(D);let ee;if(_e(L))ee=r;else{const ke=N.getCompleteChild(D);ee=null!=ke?".priority"===be(L)&&ke.getChild(lt(L)).isEmpty()?ke:ke.updateChild(L,r):he.EMPTY_NODE}g=$.equals(ee)?e:Vr(e,n.filter.updateChild(h.getNode(),D,ee,L,N,c),h.isFullyInitialized(),n.filter.filtersNodes())}}return g}function Lo(n,e){return n.eventCache.isCompleteForChild(e)}function Mo(n,e,t){return t.foreach((r,o)=>{e=e.updateChild(r,o)}),e}function Ns(n,e,t,r,o,u,c,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let v,g=e;v=_e(t)?r:new Be(null).setTree(t,r);const N=e.serverCache.getNode();return v.children.inorderTraversal((D,L)=>{if(N.hasChild(D)){const ee=Mo(0,e.serverCache.getNode().getImmediateChild(D),L);g=Pi(n,g,new k(D),ee,o,u,c,h)}}),v.children.inorderTraversal((D,L)=>{const $=!e.serverCache.isCompleteForChild(D)&&null===L.value;if(!N.hasChild(D)&&!$){const ke=Mo(0,e.serverCache.getNode().getImmediateChild(D),L);g=Pi(n,g,new k(D),ke,o,u,c,h)}}),g}class Uo{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,o=new as(r.getIndex()),u=function us(n){return n.loadsAllData()?new as(n.getIndex()):n.hasLimit()?new ls(n):new Ur(n)}(r);this.processor_=function Do(n){return{filter:n}}(u);const c=t.serverCache,h=t.eventCache,g=o.updateFullNode(he.EMPTY_NODE,c.getNode(),null),v=u.updateFullNode(he.EMPTY_NODE,h.getNode(),null),N=new Vn(g,c.isFullyInitialized(),o.filtersNodes()),D=new Vn(v,h.isFullyInitialized(),u.filtersNodes());this.viewCache_=Ei(D,N),this.eventGenerator_=new ys(this.query_)}get query(){return this.query_}}function Ma(n,e){const t=Hn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!_e(e)&&!t.getImmediateChild(V(e)).isEmpty())?t.getChild(e):null}function bi(n){return 0===n.eventRegistrations_.length}function ki(n,e,t){const r=[];if(t){(0,_.hu)(null==e,"A cancel should cancel all event registrations.");const o=n.query._path;n.eventRegistrations_.forEach(u=>{const c=u.createCancelEvent(t,o);c&&r.push(c)})}if(e){let o=[];for(let u=0;u<n.eventRegistrations_.length;++u){const c=n.eventRegistrations_[u];if(c.matches(e)){if(e.hasAnyCallback()){o=o.concat(n.eventRegistrations_.slice(u+1));break}}else o.push(c)}n.eventRegistrations_=o}else n.eventRegistrations_=[];return r}function Fo(n,e,t,r){e.type===tn.MERGE&&null!==e.source.queryId&&((0,_.hu)(Hn(n.viewCache_),"We should always have a full cache before handling merges"),(0,_.hu)(ar(n.viewCache_),"Missing event cache, even though we have a server cache"));const o=n.viewCache_,u=function ba(n,e,t,r,o){const u=new Ra;let c,h;if(t.type===tn.OVERWRITE){const v=t;v.source.fromUser?c=bs(n,e,v.path,v.snap,r,o,u):((0,_.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered()&&!_e(v.path),c=Pi(n,e,v.path,v.snap,r,o,h,u))}else if(t.type===tn.MERGE){const v=t;v.source.fromUser?c=function ks(n,e,t,r,o,u,c){let h=e;return r.foreach((g,v)=>{const N=qe(t,g);Lo(e,V(N))&&(h=bs(n,h,N,v,o,u,c))}),r.foreach((g,v)=>{const N=qe(t,g);Lo(e,V(N))||(h=bs(n,h,N,v,o,u,c))}),h}(n,e,v.path,v.children,r,o,u):((0,_.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered(),c=Ns(n,e,v.path,v.children,r,o,h,u))}else if(t.type===tn.ACK_USER_WRITE){const v=t;c=v.revert?function Da(n,e,t,r,o,u){let c;if(null!=Si(r,t))return e;{const h=new Ps(r,e,o),g=e.eventCache.getNode();let v;if(_e(t)||".priority"===V(t)){let N;if(e.serverCache.isFullyInitialized())N=wi(r,Hn(e));else{const D=e.serverCache.getNode();(0,_.hu)(D instanceof he,"serverChildren would be complete if leaf node"),N=Gr(r,D)}v=n.filter.updateFullNode(g,N,u)}else{const N=V(t);let D=No(r,N,e.serverCache);null==D&&e.serverCache.isCompleteForChild(N)&&(D=g.getImmediateChild(N)),v=null!=D?n.filter.updateChild(g,N,D,se(t),h,u):e.eventCache.getNode().hasChild(N)?n.filter.updateChild(g,N,he.EMPTY_NODE,se(t),h,u):g,v.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=wi(r,Hn(e)),c.isLeafNode()&&(v=n.filter.updateFullNode(v,c,u)))}return c=e.serverCache.isFullyInitialized()||null!=Si(r,x()),Vr(e,v,c,n.filter.filtersNodes())}}(n,e,v.path,r,o,u):function Na(n,e,t,r,o,u,c){if(null!=Si(o,t))return e;const h=e.serverCache.isFiltered(),g=e.serverCache;if(null!=r.value){if(_e(t)&&g.isFullyInitialized()||g.isCompleteForPath(t))return Pi(n,e,t,g.getNode().getChild(t),o,u,h,c);if(_e(t)){let v=new Be(null);return g.getNode().forEachChild(Gt,(N,D)=>{v=v.set(new k(N),D)}),Ns(n,e,t,v,o,u,h,c)}return e}{let v=new Be(null);return r.foreach((N,D)=>{const L=qe(t,N);g.isCompleteForPath(L)&&(v=v.set(N,g.getNode().getChild(L)))}),Ns(n,e,t,v,o,u,h,c)}}(n,e,v.path,v.affectedTree,r,o,u)}else{if(t.type!==tn.LISTEN_COMPLETE)throw(0,_.g5)("Unknown operation type: "+t.type);c=function Oa(n,e,t,r,o){const u=e.serverCache;return Kr(n,Ti(e,u.getNode(),u.isFullyInitialized()||_e(t),u.isFiltered()),t,r,Ri,o)}(n,e,t.path,r,u)}const g=u.getChanges();return function ka(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const o=r.getNode().isLeafNode()||r.getNode().isEmpty(),u=ar(n);(t.length>0||!n.eventCache.isFullyInitialized()||o&&!r.getNode().equals(u)||!r.getNode().getPriority().equals(u.getPriority()))&&t.push(Io(ar(e)))}}(e,c,g),{viewCache:c,changes:g}}(n.processor_,o,e,t,r);return function xo(n,e){(0,_.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,_.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,u.viewCache),(0,_.hu)(u.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=u.viewCache,Wo(n,u.changes,u.viewCache.eventCache.getNode(),null)}function Wo(n,e,t,r){return function Bn(n,e,t,r){const o=[],u=[];return e.forEach(c=>{"child_changed"===c.type&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&u.push(function os(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(c.childName,c.snapshotNode))}),Zn(n,o,"child_removed",e,r,t),Zn(n,o,"child_added",e,r,t),Zn(n,o,"child_moved",u,r,t),Zn(n,o,"child_changed",e,r,t),Zn(n,o,"value",e,r,t),o}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let cr,dr;class jr{constructor(){this.views=new Map}}function Ls(n,e,t,r){const o=e.source.queryId;if(null!==o){const u=n.views.get(o);return(0,_.hu)(null!=u,"SyncTree gave us an op for an invalid query."),Fo(u,e,t,r)}{let u=[];for(const c of n.views.values())u=u.concat(Fo(c,e,t,r));return u}}function An(n,e,t,r,o){const c=n.views.get(e._queryIdentifier);if(!c){let h=wi(t,o?r:null),g=!1;h?g=!0:r instanceof he?(h=Gr(t,r),g=!1):(h=he.EMPTY_NODE,g=!1);const v=Ei(new Vn(h,g,!1),new Vn(r,o,!1));return new Uo(e,v)}return c}function Vo(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function wn(n,e){let t=null;for(const r of n.views.values())t=t||Ma(r,e);return t}function Ni(n,e){return e._queryParams.loadsAllData()?Oi(n):n.views.get(e._queryIdentifier)}function Us(n,e){return null!=Ni(n,e)}function Sn(n){return null!=Oi(n)}function Oi(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Ba=1;class Di{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Be(null),this.pendingWriteTree_=function ws(){return{visibleWrites:Kt.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function $r(n,e,t,r,o){return function Es(n,e,t,r,o){(0,_.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:o}),o&&(n.visibleWrites=Br(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,o),o?fr(n,new or({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Ut(n,e,t=!1){const r=function Ts(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function Ta(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,_.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let o=r.visible,u=!1,c=n.allWrites.length-1;for(;o&&c>=0;){const h=n.allWrites[c];h.visible&&(c>=t&&Ca(h,r.path)?o=!1:st(r.path,h.path)&&(u=!0)),c--}return!!o&&(u?(function bo(n){n.visibleWrites=Zr(n.allWrites,Aa,x()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=Is(n.visibleWrites,r.path):nt(r.children,g=>{n.visibleWrites=Is(n.visibleWrites,qe(r.path,g))}),!0))}(n.pendingWriteTree_,e)){let u=new Be(null);return null!=r.snap?u=u.set(x(),!0):nt(r.children,c=>{u=u.set(new k(c),!0)}),fr(n,new vs(r.path,u,t))}return[]}function zr(n,e,t){return fr(n,new or({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function hr(n,e,t,r,o=!1){const u=e._path,c=n.syncPointTree_.get(u);let h=[];if(c&&("default"===e._queryIdentifier||Us(c,e))){const g=function Wa(n,e,t,r){const o=e._queryIdentifier,u=[];let c=[];const h=Sn(n);if("default"===o)for(const[g,v]of n.views.entries())c=c.concat(ki(v,t,r)),bi(v)&&(n.views.delete(g),v.query._queryParams.loadsAllData()||u.push(v.query));else{const g=n.views.get(o);g&&(c=c.concat(ki(g,t,r)),bi(g)&&(n.views.delete(o),g.query._queryParams.loadsAllData()||u.push(g.query)))}return h&&!Sn(n)&&u.push(new(function Fa(){return(0,_.hu)(cr,"Reference.ts has not been loaded"),cr}())(e._repo,e._path)),{removed:u,events:c}}(c,e,t,r);(function xs(n){return 0===n.views.size})(c)&&(n.syncPointTree_=n.syncPointTree_.remove(u));const v=g.removed;if(h=g.events,!o){const N=-1!==v.findIndex(L=>L._queryParams.loadsAllData()),D=n.syncPointTree_.findOnPath(u,(L,$)=>Sn($));if(N&&!D){const L=n.syncPointTree_.subtree(u);if(!L.isEmpty()){const $=function Hs(n){return n.fold((e,t,r)=>{if(t&&Sn(t))return[Oi(t)];{let o=[];return t&&(o=Vo(t)),nt(r,(u,c)=>{o=o.concat(c)}),o}})}(L);for(let ee=0;ee<$.length;++ee){const ke=$[ee],yt=ke.query,Pn=Go(n,ke);n.listenProvider_.startListening(jn(yt),Kn(n,yt),Pn.hashFn,Pn.onComplete)}}}!D&&v.length>0&&!r&&(N?n.listenProvider_.stopListening(jn(e),null):v.forEach(L=>{const $=n.queryToTagMap.get(Mi(L));n.listenProvider_.stopListening(jn(L),$)}))}!function Gs(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const o=Mi(r),u=n.queryToTagMap.get(o);n.queryToTagMap.delete(o),n.tagToQueryMap.delete(u)}}}(n,v)}return h}function Bo(n,e,t,r){const o=Bs(n,r);if(null!=o){const u=Qr(o),c=u.path,h=u.queryId,g=ut(c,e);return Zs(n,c,new or(ms(h),g,t))}return[]}function xi(n,e,t,r=!1){const o=e._path;let u=null,c=!1;n.syncPointTree_.foreachOnPath(o,(L,$)=>{const ee=ut(L,o);u=u||wn($,ee),c=c||Sn($)});let g,h=n.syncPointTree_.get(o);h?(c=c||Sn(h),u=u||wn(h,x())):(h=new jr,n.syncPointTree_=n.syncPointTree_.set(o,h)),null!=u?g=!0:(g=!1,u=he.EMPTY_NODE,n.syncPointTree_.subtree(o).foreachChild(($,ee)=>{const ke=wn(ee,x());ke&&(u=u.updateImmediateChild($,ke))}));const v=Us(h,e);if(!v&&!e._queryParams.loadsAllData()){const L=Mi(e);(0,_.hu)(!n.queryToTagMap.has(L),"View does not exist, but we have a tag");const $=function Ko(){return Ba++}();n.queryToTagMap.set(L,$),n.tagToQueryMap.set($,L)}let D=function Ms(n,e,t,r,o,u){const c=An(n,e,r,o,u);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),function Ua(n,e){n.eventRegistrations_.push(e)}(c,t),function Os(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Me,(u,c)=>{r.push(Tn(u,c))}),t.isFullyInitialized()&&r.push(Io(t.getNode())),Wo(n,r,t.getNode(),e)}(c,t)}(h,e,t,Ci(n.pendingWriteTree_,o),u,g);if(!v&&!c&&!r){const L=Ni(h,e);D=D.concat(function Ks(n,e,t){const r=e._path,o=Kn(n,e),u=Go(n,t),c=n.listenProvider_.startListening(jn(e),o,u.hashFn,u.onComplete),h=n.syncPointTree_.subtree(r);if(o)(0,_.hu)(!Sn(h.value),"If we're adding a query, it shouldn't be shadowed");else{const g=h.fold((v,N,D)=>{if(!_e(v)&&N&&Sn(N))return[Oi(N).query];{let L=[];return N&&(L=L.concat(Vo(N).map($=>$.query))),nt(D,($,ee)=>{L=L.concat(ee)}),L}});for(let v=0;v<g.length;++v){const N=g[v];n.listenProvider_.stopListening(jn(N),Kn(n,N))}}return c}(n,e,L))}return D}function Yr(n,e,t){const o=n.pendingWriteTree_,u=n.syncPointTree_.findOnPath(e,(c,h)=>{const v=wn(h,ut(c,e));if(v)return v});return Cs(o,e,u,t,!0)}function fr(n,e){return Li(e,n.syncPointTree_,null,Ci(n.pendingWriteTree_,x()))}function Li(n,e,t,r){if(_e(n.path))return Ho(n,e,t,r);{const o=e.get(x());null==t&&null!=o&&(t=wn(o,x()));let u=[];const c=V(n.path),h=n.operationForChild(c),g=e.children.get(c);if(g&&h){const v=t?t.getImmediateChild(c):null,N=Rs(r,c);u=u.concat(Li(h,g,v,N))}return o&&(u=u.concat(Ls(o,n,r,t))),u}}function Ho(n,e,t,r){const o=e.get(x());null==t&&null!=o&&(t=wn(o,x()));let u=[];return e.children.inorderTraversal((c,h)=>{const g=t?t.getImmediateChild(c):null,v=Rs(r,c),N=n.operationForChild(c);N&&(u=u.concat(Ho(N,h,g,v)))}),o&&(u=u.concat(Ls(o,n,r,t))),u}function Go(n,e){const t=e.query,r=Kn(n,t);return{hashFn:()=>(function xa(n){return n.viewCache_.serverCache.getNode()}(e)||he.EMPTY_NODE).hash(),onComplete:o=>{if("ok"===o)return r?function Vs(n,e,t){const r=Bs(n,t);if(r){const o=Qr(r),u=o.path,c=o.queryId,h=ut(u,e);return Zs(n,u,new Ii(ms(c),h))}return[]}(n,t._path,r):function Ws(n,e){return fr(n,new Ii({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const u=function Lt(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(o,t);return hr(n,t,null,u)}}}}function Kn(n,e){const t=Mi(e);return n.queryToTagMap.get(t)}function Mi(n){return n._path.toString()+"$"+n._queryIdentifier}function Bs(n,e){return n.tagToQueryMap.get(e)}function Qr(n){const e=n.indexOf("$");return(0,_.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new k(n.substr(0,e))}}function Zs(n,e,t){const r=n.syncPointTree_.get(e);return(0,_.hu)(r,"Missing sync point for query tag that we're tracking"),Ls(r,t,Ci(n.pendingWriteTree_,e),null)}function jn(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function Fs(){return(0,_.hu)(dr,"Reference.ts has not been loaded"),dr}())(n._repo,n._path):n}class js{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new js(t)}node(){return this.node_}}class Ui{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=qe(this.path_,e);return new Ui(this.syncTree_,t)}node(){return Yr(this.syncTree_,this.path_)}}const jo=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},$s=function(n,e,t){return n&&"object"==typeof n?((0,_.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Ka(n[".sv"],e,t):"object"==typeof n[".sv"]?$o(n[".sv"],e):void(0,_.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Ka=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,_.hu)(!1,"Unexpected server value: "+n)},$o=function(n,e,t){n.hasOwnProperty("increment")||(0,_.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,_.hu)(!1,"Unexpected increment value: "+r);const o=e.node();if((0,_.hu)(null!==o&&typeof o<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;const c=o.getValue();return"number"!=typeof c?r:c+r},Fi=function(n,e,t,r){return Ys(e,new Ui(t,n),r)},zs=function(n,e,t){return Ys(n,new js(e),t)};function Ys(n,e,t){const r=n.getPriority().val(),o=$s(r,e.getImmediateChild(".priority"),t);let u;if(n.isLeafNode()){const c=n,h=$s(c.getValue(),e,t);return h!==c.getValue()||o!==c.getPriority().val()?new En(h,Je(o)):n}{const c=n;return u=c,o!==c.getPriority().val()&&(u=u.updatePriority(new En(o))),c.forEachChild(Me,(h,g)=>{const v=Ys(g,e.getImmediateChild(h),t);v!==g&&(u=u.updateImmediateChild(h,v))}),u}}class Qs{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function pr(n,e){let t=e instanceof k?e:new k(e),r=n,o=V(t);for(;null!==o;){const u=(0,_.DV)(r.node.children,o)||{children:{},childCount:0};r=new Qs(o,r,u),t=se(t),o=V(t)}return r}function $n(n){return n.node.value}function qs(n,e){n.node.value=e,Xs(n)}function Js(n){return n.node.childCount>0}function zn(n,e){nt(n.node.children,(t,r)=>{e(new Qs(t,n,r))})}function zo(n,e,t,r){t&&!r&&e(n),zn(n,o=>{zo(o,e,!0,r)}),t&&r&&e(n)}function qr(n){return new k(null===n.parent?n.name:qr(n.parent)+"/"+n.name)}function Xs(n){null!==n.parent&&function za(n,e,t){const r=function ja(n){return void 0===$n(n)&&!Js(n)}(t),o=(0,_.r3)(n.node.children,e);r&&o?(delete n.node.children[e],n.node.childCount--,Xs(n)):!r&&!o&&(n.node.children[e]=t.node,n.node.childCount++,Xs(n))}(n.parent,n.name,n)}const Ya=/[\[\].#$\/\u0000-\u001F\u007F]/,Qa=/[\[\].#$\u0000-\u001F\u007F]/,eo=10485760,_r=function(n){return"string"==typeof n&&0!==n.length&&!Ya.test(n)},Yo=function(n){return"string"==typeof n&&0!==n.length&&!Qa.test(n)},Jr=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!ht(n)||n&&"object"==typeof n&&(0,_.r3)(n,".sv")},nn=function(n,e,t,r){r&&void 0===e||Xr((0,_.gK)(n,"value"),e,t)},Xr=function(n,e,t){const r=t instanceof k?new nr(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+Ln(r));if("function"==typeof e)throw new Error(n+"contains a function "+Ln(r)+" with contents = "+e.toString());if(ht(e))throw new Error(n+"contains "+e.toString()+" "+Ln(r));if("string"==typeof e&&e.length>eo/3&&(0,_.ug)(e)>eo)throw new Error(n+"contains a string greater than "+eo+" utf8 bytes "+Ln(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let o=!1,u=!1;if(nt(e,(c,h)=>{if(".value"===c)o=!0;else if(".priority"!==c&&".sv"!==c&&(u=!0,!_r(c)))throw new Error(n+" contains an invalid key ("+c+") "+Ln(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Rr(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,_.ug)(e),mo(n)})(r,c),Xr(n,h,r),function la(n){const e=n.parts_.pop();n.byteLength_-=(0,_.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),o&&u)throw new Error(n+' contains ".value" child '+Ln(r)+" in addition to actual children.")}},qo=function(n,e,t,r){if(r&&void 0===e)return;const o=(0,_.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(o+" must be an object containing the children to replace.");const u=[];nt(e,(c,h)=>{const g=new k(c);if(Xr(o,h,qe(t,g)),".priority"===be(g)&&!Jr(h))throw new Error(o+"contains an invalid value for '"+g.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");u.push(g)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const u=Xt(r);for(let c=0;c<u.length;c++)if((".priority"!==u[c]||c!==u.length-1)&&!_r(u[c]))throw new Error(n+"contains an invalid key ("+u[c]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(ul);let o=null;for(t=0;t<e.length;t++){if(r=e[t],null!==o&&st(o,r))throw new Error(n+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(o,u)},to=function(n,e,t){if(!t||void 0!==e){if(ht(e))throw new Error((0,_.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Jr(e))throw new Error((0,_.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ei=function(n,e,t,r){if(!(r&&void 0===t||_r(t)))throw new Error((0,_.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ti=function(n,e,t,r){if(!(r&&void 0===t||Yo(t)))throw new Error((0,_.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},no=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ti(n,e,t,r)},Ft=function(n,e){if(".info"===V(e))throw new Error(n+" failed = Can't modify data under /.info/")},Wi=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!_r(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Yo(n)}(t))throw new Error((0,_.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Ja{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ni(n,e){let t=null;for(let r=0;r<e.length;r++){const o=e[r],u=o.getPath();null!==t&&!Sr(u,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:u}),t.events.push(o)}t&&n.eventLists_.push(t)}function Jo(n,e,t){ni(n,t),Xo(n,r=>Sr(r,e))}function Ct(n,e,t){ni(n,t),Xo(n,r=>st(r,e)||st(e,r))}function Xo(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const o=n.eventLists_[r];o&&(e(o.path)?(ea(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function ea(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();j&&me("event: "+t.toString()),H(r)}}}const ro="repo_interrupt",Xa=25;class el{constructor(e,t,r,o){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ja,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=yi(),this.transactionQueueTree_=new Qs,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ta(n){const t=n.infoData_.getNode(new k(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ri(n){return jo({timestamp:ta(n)})}function io(n,e,t,r,o){n.dataUpdateCount++;const u=new k(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(o)if(r){const g=(0,_.UI)(t,v=>Je(v));c=function Zo(n,e,t,r){const o=Bs(n,r);if(o){const u=Qr(o),c=u.path,h=u.queryId,g=ut(c,e),v=Be.fromObject(t);return Zs(n,c,new Wr(ms(h),g,v))}return[]}(n.serverSyncTree_,u,g,o)}else{const g=Je(t);c=Bo(n.serverSyncTree_,u,g,o)}else if(r){const g=(0,_.UI)(t,v=>Je(v));c=function Ha(n,e,t){const r=Be.fromObject(t);return fr(n,new Wr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,u,g)}else{const g=Je(t);c=zr(n.serverSyncTree_,u,g)}let h=u;c.length>0&&(h=Yn(n,u)),Ct(n.eventQueue_,h,c)}function na(n,e){a(n,"connected",e),!1===e&&function p(n){dn(n,"onDisconnectEvents");const e=ri(n),t=yi();_s(n.onDisconnect_,x(),(o,u)=>{const c=Fi(o,u,n.serverSyncTree_,e);Wn(t,o,c)});let r=[];_s(t,x(),(o,u)=>{r=r.concat(zr(n.serverSyncTree_,o,u));const c=lo(n,o);Yn(n,c)}),n.onDisconnect_=yi(),Ct(n.eventQueue_,x(),r)}(n)}function a(n,e,t){const r=new k("/.info/"+e),o=Je(t);n.infoData_.updateSnapshot(r,o);const u=zr(n.infoSyncTree_,r,o);Ct(n.eventQueue_,r,u)}function i(n){return n.nextWriteId_++}function l(n,e,t,r,o){dn(n,"set",{path:e.toString(),value:t,priority:r});const u=ri(n),c=Je(t,r),h=Yr(n.serverSyncTree_,e),g=zs(c,h,u),v=i(n),N=$r(n.serverSyncTree_,e,g,v,!0);ni(n.eventQueue_,N),n.server_.put(e.toString(),c.val(!0),(L,$)=>{const ee="ok"===L;ee||Le("set at "+e+" failed: "+L);const ke=Ut(n.serverSyncTree_,v,!ee);Ct(n.eventQueue_,e,ke),hn(0,o,L,$)});const D=lo(n,e);Yn(n,D),Ct(n.eventQueue_,D,[])}function R(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,o)=>{"ok"===r&&Fr(n.onDisconnect_,e),hn(0,t,r,o)})}function U(n,e,t,r){const o=Je(t);n.server_.onDisconnectPut(e.toString(),o.val(!0),(u,c)=>{"ok"===u&&Wn(n.onDisconnect_,e,o),hn(0,r,u,c)})}function Ze(n,e,t){let r;r=".info"===V(e._path)?hr(n.infoSyncTree_,e,t):hr(n.serverSyncTree_,e,t),Jo(n.eventQueue_,e._path,r)}function jt(n){n.persistentConnection_&&n.persistentConnection_.interrupt(ro)}function dn(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),me(t,...e)}function hn(n,e,t,r){e&&H(()=>{if("ok"===t)e(null);else{const o=(t||"error").toUpperCase();let u=o;r&&(u+=": "+r);const c=new Error(u);c.code=o,e(c)}})}function Vi(n,e,t){return Yr(n.serverSyncTree_,e,t)||he.EMPTY_NODE}function ii(n,e=n.transactionQueueTree_){if(e||gr(n,e),$n(e)){const t=ao(n,e);(0,_.hu)(t.length>0,"Sending zero length transaction queue"),t.every(o=>0===o.status)&&function oo(n,e,t){const r=t.map(v=>v.currentWriteId),o=Vi(n,e,r);let u=o;const c=o.hash();for(let v=0;v<t.length;v++){const N=t[v];(0,_.hu)(0===N.status,"tryToSendTransactionQueue_: items in queue should all be run."),N.status=1,N.retryCount++;const D=ut(e,N.path);u=u.updateChild(D,N.currentOutputSnapshotRaw)}const h=u.val(!0),g=e;n.server_.put(g.toString(),h,v=>{dn(n,"transaction put response",{path:g.toString(),status:v});let N=[];if("ok"===v){const D=[];for(let L=0;L<t.length;L++)t[L].status=2,N=N.concat(Ut(n.serverSyncTree_,t[L].currentWriteId)),t[L].onComplete&&D.push(()=>t[L].onComplete(null,!0,t[L].currentOutputSnapshotResolved)),t[L].unwatcher();gr(n,pr(n.transactionQueueTree_,e)),ii(n,n.transactionQueueTree_),Ct(n.eventQueue_,e,N);for(let L=0;L<D.length;L++)H(D[L])}else{if("datastale"===v)for(let D=0;D<t.length;D++)t[D].status=3===t[D].status?4:0;else{Le("transaction at "+g.toString()+" failed: "+v);for(let D=0;D<t.length;D++)t[D].status=4,t[D].abortReason=v}Yn(n,e)}},c)}(n,qr(e),t)}else Js(e)&&zn(e,t=>{ii(n,t)})}function Yn(n,e){const t=Bi(n,e),r=qr(t);return function ra(n,e,t){if(0===e.length)return;const r=[];let o=[];const c=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const g=e[h],v=ut(t,g.path);let D,N=!1;if((0,_.hu)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===g.status)N=!0,D=g.abortReason,o=o.concat(Ut(n.serverSyncTree_,g.currentWriteId,!0));else if(0===g.status)if(g.retryCount>=Xa)N=!0,D="maxretry",o=o.concat(Ut(n.serverSyncTree_,g.currentWriteId,!0));else{const L=Vi(n,g.path,c);g.currentInputSnapshot=L;const $=e[h].update(L.val());if(void 0!==$){Xr("transaction failed: Data returned ",$,g.path);let ee=Je($);"object"==typeof $&&null!=$&&(0,_.r3)($,".priority")||(ee=ee.updatePriority(L.getPriority()));const yt=g.currentWriteId,Pn=ri(n),Qn=zs(ee,L,Pn);g.currentOutputSnapshotRaw=ee,g.currentOutputSnapshotResolved=Qn,g.currentWriteId=i(n),c.splice(c.indexOf(yt),1),o=o.concat($r(n.serverSyncTree_,g.path,Qn,g.currentWriteId,g.applyLocally)),o=o.concat(Ut(n.serverSyncTree_,yt,!0))}else N=!0,D="nodata",o=o.concat(Ut(n.serverSyncTree_,g.currentWriteId,!0))}Ct(n.eventQueue_,t,o),o=[],N&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===D?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(D),!1,null)))}gr(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)H(r[h]);ii(n,n.transactionQueueTree_)}(n,ao(n,t),r),r}function Bi(n,e){let t,r=n.transactionQueueTree_;for(t=V(e);null!==t&&void 0===$n(r);)r=pr(r,t),t=V(e=se(e));return r}function ao(n,e){const t=[];return ia(n,e,t),t.sort((r,o)=>r.order-o.order),t}function ia(n,e,t){const r=$n(e);if(r)for(let o=0;o<r.length;o++)t.push(r[o]);zn(e,o=>{ia(n,o,t)})}function gr(n,e){const t=$n(e);if(t){let r=0;for(let o=0;o<t.length;o++)2!==t[o].status&&(t[r]=t[o],r++);t.length=r,qs(e,t.length>0?t:void 0)}zn(e,r=>{gr(n,r)})}function lo(n,e){const t=qr(Bi(n,e)),r=pr(n.transactionQueueTree_,e);return function $a(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,o=>{rl(n,o)}),rl(n,r),zo(r,o=>{rl(n,o)}),t}function rl(n,e){const t=$n(e);if(t){const r=[];let o=[],u=-1;for(let c=0;c<t.length;c++)3===t[c].status||(1===t[c].status?((0,_.hu)(u===c-1,"All SENT items should be at beginning of queue."),u=c,t[c].status=3,t[c].abortReason="set"):((0,_.hu)(0===t[c].status,"Unexpected transaction status in abort"),t[c].unwatcher(),o=o.concat(Ut(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&r.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));-1===u?qs(e,void 0):t.length=u+1,Ct(n.eventQueue_,qr(e),o);for(let c=0;c<r.length;c++)H(r[c])}}const il=function(n,e){const t=Vl(n),r=t.namespace;return"firebase.com"===t.domain&&Ae(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Ae("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Le("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new b(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new k(t.pathString)}},Vl=function(n){let e="",t="",r="",o="",u="",c=!0,h="https",g=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let N=n.indexOf("/");-1===N&&(N=n.length);let D=n.indexOf("?");-1===D&&(D=n.length),e=n.substring(0,Math.min(N,D)),N<D&&(o=function Fl(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let o=t[r];try{o=decodeURIComponent(o.replace(/\+/g," "))}catch{}e+="/"+o}return e}(n.substring(N,D)));const L=function Wl(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Le(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,D)));v=e.indexOf(":"),v>=0?(c="https"===h||"wss"===h,g=parseInt(e.substring(v+1),10)):v=e.length;const $=e.slice(0,v);if("localhost"===$.toLowerCase())t="localhost";else if($.split(".").length<=2)t=$;else{const ee=e.indexOf(".");r=e.substring(0,ee).toLowerCase(),t=e.substring(ee+1),u=r}"ns"in L&&(u=L.ns)}return{host:e,port:g,domain:t,subdomain:r,secure:c,scheme:h,pathString:o,namespace:u}},cl="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Bl=function(){let n=0;const e=[];return function(t){const r=t===n;let o;n=t;const u=new Array(8);for(o=7;o>=0;o--)u[o]=cl.charAt(t%64),t=Math.floor(t/64);(0,_.hu)(0===t,"Cannot push at time == 0");let c=u.join("");if(r){for(o=11;o>=0&&63===e[o];o--)e[o]=0;e[o]++}else for(o=0;o<12;o++)e[o]=Math.floor(64*Math.random());for(o=0;o<12;o++)c+=cl.charAt(e[o]);return(0,_.hu)(20===c.length,"nextPushId: Length should be 20."),c}}();class dl{constructor(e,t,r,o){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=o}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,_.Wl)(this.snapshot.exportVal())}}class hl{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class sl{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,_.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class fl{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new _.BH;return R(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Ft("OnDisconnect.remove",this._path);const e=new _.BH;return U(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Ft("OnDisconnect.set",this._path),nn("OnDisconnect.set",e,this._path,!1);const t=new _.BH;return U(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Ft("OnDisconnect.setWithPriority",this._path),nn("OnDisconnect.setWithPriority",e,this._path,!1),to("OnDisconnect.setWithPriority",t,!1);const r=new _.BH;return function z(n,e,t,r,o){const u=Je(t,r);n.server_.onDisconnectPut(e.toString(),u.val(!0),(c,h)=>{"ok"===c&&Wn(n.onDisconnect_,e,u),hn(0,o,c,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Ft("OnDisconnect.update",this._path),qo("OnDisconnect.update",e,this._path,!1);const t=new _.BH;return function X(n,e,t,r){if((0,_.xb)(t))return me("onDisconnect().update() called with empty data.  Don't do anything."),void hn(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(o,u)=>{"ok"===o&&nt(t,(c,h)=>{const g=Je(h);Wn(n.onDisconnect_,qe(e,c),g)}),hn(0,r,o,u)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class Wt{constructor(e,t,r,o){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=o}get key(){return _e(this._path)?null:be(this._path)}get ref(){return new rn(this._repo,this._path)}get _queryIdentifier(){const e=Eo(this._queryParams),t=Et(e);return"{}"===t?"default":t}get _queryObject(){return Eo(this._queryParams)}isEqual(e){if(!((e=(0,_.m9)(e))instanceof Wt))return!1;const t=this._repo===e._repo,r=Sr(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function xn(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function sa(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function mr(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Gt){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==ze)throw new Error(r);if("string"!=typeof e)throw new Error(o)}if(n.hasEnd()){if(n.getIndexEndName()!==xe)throw new Error(r);if("string"!=typeof t)throw new Error(o)}}else if(n.getIndex()===Me){if(null!=e&&!Jr(e)||null!=t&&!Jr(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,_.hu)(n.getIndex()instanceof Dr||n.getIndex()===xr,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function oa(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class rn extends Wt{constructor(e,t){super(e,t,new gi,!1)}get parent(){const e=lt(this._path);return null===e?null:new rn(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class si{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new k(e),r=oi(this.ref,e);return new si(this._node.getChild(t),r,Me)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,o)=>e(new si(o,oi(this.ref,r),Me)))}hasChild(e){const t=new k(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function pl(n,e){return(n=(0,_.m9)(n))._checkNotDeleted("ref"),void 0!==e?oi(n._root,e):n._root}function _l(n,e){(n=(0,_.m9)(n))._checkNotDeleted("refFromURL");const t=il(e,n._repo.repoInfo_.nodeAdmin);Wi("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Ae("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),pl(n,t.path.toString())}function oi(n,e){return null===V((n=(0,_.m9)(n))._path)?no("child","path",e,!1):ti("child","path",e,!1),new rn(n._repo,qe(n._path,e))}function ol(n,e){n=(0,_.m9)(n),Ft("set",n._path),nn("set",e,n._path,!1);const t=new _.BH;return l(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function jl(n,e){qo("update",e,n._path,!1);const t=new _.BH;return function d(n,e,t,r){dn(n,"update",{path:e.toString(),value:t});let o=!0;const u=ri(n),c={};if(nt(t,(h,g)=>{o=!1,c[h]=Fi(qe(e,h),Je(g),n.serverSyncTree_,u)}),o)me("update() called with empty data.  Don't do anything."),hn(0,r,"ok",void 0);else{const h=i(n),g=function Za(n,e,t,r){!function Ea(n,e,t,r){(0,_.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=So(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const o=Be.fromObject(t);return fr(n,new Wr({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,o))}(n.serverSyncTree_,e,c,h);ni(n.eventQueue_,g),n.server_.merge(e.toString(),t,(v,N)=>{const D="ok"===v;D||Le("update at "+e+" failed: "+v);const L=Ut(n.serverSyncTree_,h,!D),$=L.length>0?Yn(n,e):e;Ct(n.eventQueue_,$,L),hn(0,r,v,N)}),nt(t,v=>{const N=lo(n,qe(e,v));Yn(n,N)}),Ct(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function $l(n){n=(0,_.m9)(n);const e=new sl(()=>{}),t=new uo(e);return function s(n,e,t){const r=function Ga(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(v,N)=>{const D=ut(v,t);r=r||wn(N,D)});let o=n.syncPointTree_.get(t);o?r=r||wn(o,x()):(o=new jr,n.syncPointTree_=n.syncPointTree_.set(t,o));const u=null!=r,c=u?new Vn(r,!0,!1):null;return function La(n){return ar(n.viewCache_)}(An(o,e,Ci(n.pendingWriteTree_,e._path),u?c.getNode():he.EMPTY_NODE,u))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(o=>{const u=Je(o).withIndex(e._queryParams.getIndex());let c;if(xi(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())c=zr(n.serverSyncTree_,e._path,u);else{const h=Kn(n.serverSyncTree_,e);c=Bo(n.serverSyncTree_,e._path,u,h)}return Ct(n.eventQueue_,e._path,c),hr(n.serverSyncTree_,e,t,null,!0),u},o=>(dn(n,"get for query "+(0,_.Wl)(e)+" failed: "+o),Promise.reject(new Error(o))))}(n._repo,n,t).then(r=>new si(r,new rn(n._repo,n._path),n._queryParams.getIndex()))}class uo{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new dl("value",this,new si(e.snapshotNode,new rn(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new hl(this,e,t):null}matches(e){return e instanceof uo&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class aa{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new hl(this,e,t):null}createEvent(e,t){(0,_.hu)(null!=e.childName,"Child events should have a childName.");const r=oi(new rn(t._repo,t._path),e.childName),o=t._queryParams.getIndex();return new dl(e.type,this,new si(e.snapshotNode,r,o),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof aa&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function co(n,e,t,r,o){let u;if("object"==typeof r&&(u=void 0,o=r),"function"==typeof r&&(u=r),o&&o.onlyOnce){const g=t,v=(N,D)=>{Ze(n._repo,n,h),g(N,D)};v.userCallback=t.userCallback,v.context=t.context,t=v}const c=new sl(t,u||void 0),h="value"===e?new uo(c):new aa(e,c);return function pe(n,e,t){let r;r=".info"===V(e._path)?xi(n.infoSyncTree_,e,t):xi(n.serverSyncTree_,e,t),Jo(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>Ze(n._repo,n,h)}function al(n,e,t,r){return co(n,"value",e,t,r)}function gl(n,e,t,r){return co(n,"child_added",e,t,r)}function ml(n,e,t,r){return co(n,"child_changed",e,t,r)}function vl(n,e,t,r){return co(n,"child_moved",e,t,r)}function yl(n,e,t,r){return co(n,"child_removed",e,t,r)}function Il(n,e,t){let r=null;const o=t?new sl(t):null;"value"===e?r=new uo(o):e&&(r=new aa(e,o)),Ze(n._repo,n,r)}class fn{}class El extends fn{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){nn("endAt",this._value,e._path,!0);const t=fs(e._queryParams,this._value,this._key);if(oa(t),mr(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wt(e._repo,e._path,t,e._orderByCalled)}}class Yl extends fn{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){nn("endBefore",this._value,e._path,!1);const t=function ps(n,e,t){let r;return r=fs(n,e,n.index_===Gt||t?t:ze),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(oa(t),mr(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wt(e._repo,e._path,t,e._orderByCalled)}}class Tl extends fn{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){nn("startAt",this._value,e._path,!0);const t=ds(e._queryParams,this._value,this._key);if(oa(t),mr(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Wt(e._repo,e._path,t,e._orderByCalled)}}class Jl extends fn{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){nn("startAfter",this._value,e._path,!1);const t=function hs(n,e,t){let r;return r=ds(n,e,n.index_===Gt||t?t:xe),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(oa(t),mr(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Wt(e._repo,e._path,t,e._orderByCalled)}}class eu extends fn{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wt(e._repo,e._path,function pa(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class nu extends fn{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wt(e._repo,e._path,function cs(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class iu extends fn{constructor(e){super(),this._path=e}_apply(e){sa(e,"orderByChild");const t=new k(this._path);if(_e(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new Dr(t),o=mi(e._queryParams,r);return mr(o),new Wt(e._repo,e._path,o,!0)}}class ou extends fn{_apply(e){sa(e,"orderByKey");const t=mi(e._queryParams,Gt);return mr(t),new Wt(e._repo,e._path,t,!0)}}class lu extends fn{_apply(e){sa(e,"orderByPriority");const t=mi(e._queryParams,Me);return mr(t),new Wt(e._repo,e._path,t,!0)}}class cu extends fn{_apply(e){sa(e,"orderByValue");const t=mi(e._queryParams,xr);return mr(t),new Wt(e._repo,e._path,t,!0)}}class hu extends fn{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(nn("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new El(this._value,this._key)._apply(new Tl(this._value,this._key)._apply(e))}}function pn(n,...e){let t=(0,_.m9)(n);for(const r of e)t=r._apply(t);return t}(function Ds(n){(0,_.hu)(!cr,"__referenceConstructor has already been defined"),cr=n})(rn),function Va(n){(0,_.hu)(!dr,"__referenceConstructor has already been defined"),dr=n}(rn);const ll={};function Al(n,e,t,r,o){let u=r||n.options.databaseURL;void 0===u&&(n.options.projectId||Ae("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),me("Using default host for project ",n.options.projectId),u=`${n.options.projectId}-default-rtdb.firebaseio.com`);let g,v,c=il(u,o),h=c.repoInfo;typeof process<"u"&&process.env&&(v=process.env.FIREBASE_DATABASE_EMULATOR_HOST),v?(g=!0,u=`http://${v}?ns=${h.namespace}`,c=il(u,o),h=c.repoInfo):g=!c.repoInfo.secure;const N=o&&g?new ct(ct.OWNER):new Ve(n.name,n.options,e);Wi("Invalid Firebase Database URL",c),_e(c.path)||Ae("Database URL must point to the root of a Firebase Database (not including a child path).");const D=function mu(n,e,t,r){let o=ll[e.name];o||(o={},ll[e.name]=o);let u=o[n.toURLString()];return u&&Ae("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new el(n,false,t,r),o[n.toURLString()]=u,u}(h,n,N,new le(n.name,t));return new yu(D,n)}class yu{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function tl(n,e,t){if(n.stats_=Ie(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new ir(n.repoInfo_,(r,o,u,c)=>{io(n,r,o,u,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>na(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,_.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new In(n.repoInfo_,e,(r,o,u,c)=>{io(n,r,o,u,c)},r=>{na(n,r)},r=>{!function nl(n,e){nt(e,(t,r)=>{a(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function Pe(n,e){const t=n.toString();return oe[t]||(oe[t]=e()),oe[t]}(n.repoInfo_,()=>new va(n.stats_,n.server_)),n.infoData_=new _a,n.infoSyncTree_=new Di({startListening:(r,o,u,c)=>{let h=[];const g=n.infoData_.getNode(r._path);return g.isEmpty()||(h=zr(n.infoSyncTree_,r._path,g),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),a(n,"connected",!1),n.serverSyncTree_=new Di({startListening:(r,o,u,c)=>(n.server_.listen(r,u,o,(h,g)=>{const v=c(h,g);Ct(n.eventQueue_,r._path,v)}),[]),stopListening:(r,o)=>{n.server_.unlisten(r,o)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new rn(this._repo,x())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function gu(n,e){const t=ll[e];(!t||t[n.key]!==n)&&Ae(`Database ${e}(${n.repoInfo_}) has already been deleted.`),jt(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Ae("Cannot call "+e+" on a deleted database.")}}function wl(){Nn.IS_TRANSPORT_INITIALIZED&&Le("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Iu(){wl(),Zt.forceDisallow()}function Eu(){wl(),vn.forceDisallow(),Zt.forceAllow()}function Au(n,e){q(n,e)}const Su={".sv":"timestamp"};class bu{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}In.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},In.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function wu(n){re(F.SDK_VERSION),(0,F._registerComponent)(new Ke.wA("database",(e,{instanceIdentifier:t})=>Al(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,F.registerVersion)(pt,Q,n),(0,F.registerVersion)(pt,Q,"esm2017")}();const Du=new Ue.Yd("@firebase/database-compat"),Rl=function(n){Du.warn("FIREBASE WARNING: "+n)};class Mu{constructor(e){this._delegate=e}cancel(e){(0,_.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,_.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,_.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,_.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,_.Dv)("OnDisconnect.set",1,2,arguments.length),(0,_.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),o=>t(o)),r}setWithPriority(e,t,r){(0,_.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,_.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const o=this._delegate.setWithPriority(e,t);return r&&o.then(()=>r(null),u=>r(u)),o}update(e,t){if((0,_.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const o={};for(let u=0;u<e.length;++u)o[""+u]=e[u];e=o,Rl("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,_.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),o=>t(o)),r}}class Uu{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,_.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class vr{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,_.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,_.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,_.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,_.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,_.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),ti("DataSnapshot.child","path",e,!1),new vr(this._database,this._delegate.child(e))}hasChild(e){return(0,_.Dv)("DataSnapshot.hasChild",1,1,arguments.length),ti("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,_.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,_.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,_.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new vr(this._database,t)))}hasChildren(){return(0,_.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,_.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,_.Dv)("DataSnapshot.ref",0,0,arguments.length),new $t(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class At{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,o){var u;(0,_.Dv)("Query.on",2,4,arguments.length),(0,_.Wj)("Query.on","callback",t,!1);const c=At.getCancelAndContextArgs_("Query.on",r,o),h=(v,N)=>{t.call(c.context,new vr(this.database,v),N)};h.userCallback=t,h.context=c.context;const g=null===(u=c.cancel)||void 0===u?void 0:u.bind(c.context);switch(e){case"value":return al(this._delegate,h,g),t;case"child_added":return gl(this._delegate,h,g),t;case"child_removed":return yl(this._delegate,h,g),t;case"child_changed":return ml(this._delegate,h,g),t;case"child_moved":return vl(this._delegate,h,g),t;default:throw new Error((0,_.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,_.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,_.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,_.Wj)("Query.off","callback",t,!0),(0,_.lb)("Query.off","context",r,!0),t){const o=()=>{};o.userCallback=t,o.context=r,Il(this._delegate,e,o)}else Il(this._delegate,e)}get(){return $l(this._delegate).then(e=>new vr(this.database,e))}once(e,t,r,o){(0,_.Dv)("Query.once",1,4,arguments.length),(0,_.Wj)("Query.once","callback",t,!0);const u=At.getCancelAndContextArgs_("Query.once",r,o),c=new _.BH,h=(v,N)=>{const D=new vr(this.database,v);t&&t.call(u.context,D,N),c.resolve(D)};h.userCallback=t,h.context=u.context;const g=v=>{u.cancel&&u.cancel.call(u.context,v),c.reject(v)};switch(e){case"value":al(this._delegate,h,g,{onlyOnce:!0});break;case"child_added":gl(this._delegate,h,g,{onlyOnce:!0});break;case"child_removed":yl(this._delegate,h,g,{onlyOnce:!0});break;case"child_changed":ml(this._delegate,h,g,{onlyOnce:!0});break;case"child_moved":vl(this._delegate,h,g,{onlyOnce:!0});break;default:throw new Error((0,_.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return(0,_.Dv)("Query.limitToFirst",1,1,arguments.length),new At(this.database,pn(this._delegate,function tu(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new eu(n)}(e)))}limitToLast(e){return(0,_.Dv)("Query.limitToLast",1,1,arguments.length),new At(this.database,pn(this._delegate,function ru(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new nu(n)}(e)))}orderByChild(e){return(0,_.Dv)("Query.orderByChild",1,1,arguments.length),new At(this.database,pn(this._delegate,function su(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ti("orderByChild","path",n,!1),new iu(n)}(e)))}orderByKey(){return(0,_.Dv)("Query.orderByKey",0,0,arguments.length),new At(this.database,pn(this._delegate,function au(){return new ou}()))}orderByPriority(){return(0,_.Dv)("Query.orderByPriority",0,0,arguments.length),new At(this.database,pn(this._delegate,function uu(){return new lu}()))}orderByValue(){return(0,_.Dv)("Query.orderByValue",0,0,arguments.length),new At(this.database,pn(this._delegate,function du(){return new cu}()))}startAt(e=null,t){return(0,_.Dv)("Query.startAt",0,2,arguments.length),new At(this.database,pn(this._delegate,function ql(n=null,e){return ei("startAt","key",e,!0),new Tl(n,e)}(e,t)))}startAfter(e=null,t){return(0,_.Dv)("Query.startAfter",0,2,arguments.length),new At(this.database,pn(this._delegate,function Xl(n,e){return ei("startAfter","key",e,!0),new Jl(n,e)}(e,t)))}endAt(e=null,t){return(0,_.Dv)("Query.endAt",0,2,arguments.length),new At(this.database,pn(this._delegate,function zl(n,e){return ei("endAt","key",e,!0),new El(n,e)}(e,t)))}endBefore(e=null,t){return(0,_.Dv)("Query.endBefore",0,2,arguments.length),new At(this.database,pn(this._delegate,function Ql(n,e){return ei("endBefore","key",e,!0),new Yl(n,e)}(e,t)))}equalTo(e,t){return(0,_.Dv)("Query.equalTo",1,2,arguments.length),new At(this.database,pn(this._delegate,function fu(n,e){return ei("equalTo","key",e,!0),new hu(n,e)}(e,t)))}toString(){return(0,_.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,_.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,_.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof At))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const o={cancel:void 0,context:void 0};if(t&&r)o.cancel=t,(0,_.Wj)(e,"cancel",o.cancel,!0),o.context=r,(0,_.lb)(e,"context",o.context,!0);else if(t)if("object"==typeof t&&null!==t)o.context=t;else{if("function"!=typeof t)throw new Error((0,_.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");o.cancel=t}return o}get ref(){return new $t(this.database,new rn(this._delegate._repo,this._delegate._path))}}class $t extends At{constructor(e,t){super(e,new Wt(t._repo,t._path,new gi,!1)),this.database=e,this._delegate=t}getKey(){return(0,_.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,_.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new $t(this.database,oi(this._delegate,e))}getParent(){(0,_.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new $t(this.database,e):null}getRoot(){return(0,_.Dv)("Reference.root",0,0,arguments.length),new $t(this.database,this._delegate.root)}set(e,t){(0,_.Dv)("Reference.set",1,2,arguments.length),(0,_.Wj)("Reference.set","onComplete",t,!0);const r=ol(this._delegate,e);return t&&r.then(()=>t(null),o=>t(o)),r}update(e,t){if((0,_.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const o={};for(let u=0;u<e.length;++u)o[""+u]=e[u];e=o,Rl("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ft("Reference.update",this._delegate._path),(0,_.Wj)("Reference.update","onComplete",t,!0);const r=jl(this._delegate,e);return t&&r.then(()=>t(null),o=>t(o)),r}setWithPriority(e,t,r){(0,_.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,_.Wj)("Reference.setWithPriority","onComplete",r,!0);const o=function Kl(n,e,t){if(Ft("setWithPriority",n._path),nn("setWithPriority",e,n._path,!1),to("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new _.BH;return l(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&o.then(()=>r(null),u=>r(u)),o}remove(e){(0,_.Dv)("Reference.remove",0,1,arguments.length),(0,_.Wj)("Reference.remove","onComplete",e,!0);const t=function Hl(n){return Ft("remove",n._path),ol(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,_.Dv)("Reference.transaction",1,3,arguments.length),(0,_.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,_.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,_.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const o=function ku(n,e,t){var r;if(n=(0,_.m9)(n),Ft("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const o=null===(r=t?.applyLocally)||void 0===r||r,u=new _.BH,h=al(n,()=>{});return function so(n,e,t,r,o,u){dn(n,"transaction on "+e);const c={path:e,update:t,onComplete:r,status:null,order:at(),applyLocally:u,retryCount:0,unwatcher:o,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Vi(n,e,void 0);c.currentInputSnapshot=h;const g=c.update(h.val());if(void 0===g)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Xr("transaction failed: Data returned ",g,c.path),c.status=0;const v=pr(n.transactionQueueTree_,e),N=$n(v)||[];let D;N.push(c),qs(v,N),"object"==typeof g&&null!==g&&(0,_.r3)(g,".priority")?(D=(0,_.DV)(g,".priority"),(0,_.hu)(Jr(D),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):D=(Yr(n.serverSyncTree_,e)||he.EMPTY_NODE).getPriority().val();const L=ri(n),$=Je(g,D),ee=zs($,h,L);c.currentOutputSnapshotRaw=$,c.currentOutputSnapshotResolved=ee,c.currentWriteId=i(n);const ke=$r(n.serverSyncTree_,e,ee,c.currentWriteId,c.applyLocally);Ct(n.eventQueue_,e,ke),ii(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(g,v,N)=>{let D=null;g?u.reject(g):(D=new si(N,new rn(n._repo,n._path),Me),u.resolve(new bu(v,D)))},h,o),u.promise}(this._delegate,e,{applyLocally:r}).then(u=>new Uu(u.committed,new vr(this.database,u.snapshot)));return t&&o.then(u=>t(null,u.committed,u.snapshot),u=>t(u,!1,null)),o}setPriority(e,t){(0,_.Dv)("Reference.setPriority",1,2,arguments.length),(0,_.Wj)("Reference.setPriority","onComplete",t,!0);const r=function Gl(n,e){n=(0,_.m9)(n),Ft("setPriority",n._path),to("setPriority",e,!1);const t=new _.BH;return l(n._repo,qe(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),o=>t(o)),r}push(e,t){(0,_.Dv)("Reference.push",0,2,arguments.length),(0,_.Wj)("Reference.push","onComplete",t,!0);const r=function Zl(n,e){n=(0,_.m9)(n),Ft("push",n._path),nn("push",e,n._path,!0);const t=ta(n._repo),r=Bl(t),o=oi(n,r),u=oi(n,r);let c;return c=null!=e?ol(u,e).then(()=>u):Promise.resolve(u),o.then=c.then.bind(c),o.catch=c.then.bind(c,void 0),o}(this._delegate,e),o=r.then(c=>new $t(this.database,c));t&&o.then(()=>t(null),c=>t(c));const u=new $t(this.database,r);return u.then=o.then.bind(o),u.catch=o.catch.bind(o,void 0),u}onDisconnect(){return Ft("Reference.onDisconnect",this._delegate._path),new Mu(new fl(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class ho{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Iu,forceLongPolling:Eu}}useEmulator(e,t,r={}){!function Sl(n,e,t,r={}){(n=(0,_.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Ae("Cannot call useEmulator() after instance has already been initialized.");const o=n._repoInternal;let u;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&Ae('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),u=new ct(ct.OWNER);else if(r.mockUserToken){const c="string"==typeof r.mockUserToken?r.mockUserToken:(0,_.Sg)(r.mockUserToken,n.app.options.projectId);u=new ct(c)}!function _u(n,e,t,r){n.repoInfo_=new b(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(o,e,t,u)}(this._delegate,e,t,r)}ref(e){if((0,_.Dv)("database.ref",0,1,arguments.length),e instanceof $t){const t=_l(this._delegate,e.toString());return new $t(this,t)}{const t=pl(this._delegate,e);return new $t(this,t)}}refFromURL(e){(0,_.Dv)("database.refFromURL",1,1,arguments.length);const r=_l(this._delegate,e);return new $t(this,r)}goOffline(){return(0,_.Dv)("database.goOffline",0,0,arguments.length),function Tu(n){(n=(0,_.m9)(n))._checkNotDeleted("goOffline"),jt(n._repo)}(this._delegate)}goOnline(){return(0,_.Dv)("database.goOnline",0,0,arguments.length),function Cu(n){(n=(0,_.m9)(n))._checkNotDeleted("goOnline"),function Rn(n){n.persistentConnection_&&n.persistentConnection_.resume(ro)}(n._repo)}(this._delegate)}}ho.ServerValue={TIMESTAMP:function Ru(){return Su}(),increment:n=>function Pu(n){return{".sv":{increment:n}}}(n)};var Wu=Object.freeze({__proto__:null,initStandalone:function Fu({app:n,url:e,version:t,customAuthImpl:r,namespace:o,nodeAdmin:u=!1}){re(t);const c=new Ke.zt("auth-internal",new Ke.H0("database-standalone"));return c.setComponent(new Ke.wA("auth-internal",()=>r,"PRIVATE")),{instance:new ho(Al(n,c,void 0,e,u),n),namespace:o}}});const Vu=ho.ServerValue;!function Bu(n){n.INTERNAL.registerComponent(new Ke.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),o=e.getProvider("database").getImmediate({identifier:t});return new ho(o,r)},"PUBLIC").setServiceProps({Reference:$t,Query:At,Database:ho,DataSnapshot:vr,enableLogging:Au,INTERNAL:Wu,ServerValue:Vu}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.3.4")}(ye.Z);var yr=A(7046),Zu=A(8697);function Pl(n){return null==n}function bl(n){return"function"==typeof n.set}function kl(n,e){return bl(e)?e:n.ref(e)}function Nl(n,e){if(function Hu(n){return"string"==typeof n}(n))return e.stringCase();if(bl(n))return e.firebaseCase();if(function Gu(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function fo(n,e,t="on",r=S.z){return new C.y(o=>{let u=null;return u=n[t](e,(c,h)=>{r.schedule(()=>{o.next({snapshot:c,prevKey:h})}),"once"===t&&r.schedule(()=>o.complete())},c=>{r.schedule(()=>o.error(c))}),"on"===t?{unsubscribe(){null!=u&&n.off(e,u)}}:{unsubscribe(){}}}).pipe((0,f.U)(o=>{const{snapshot:u,prevKey:c}=o;let h=null;return u.exists()&&(h=u.key),{type:e,payload:u,prevKey:c,key:h}}),(0,ae.B)())}function Ol(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function $u(n,e){const{payload:t,prevKey:r,key:o}=e,u=Ol(n,o),c=function ju(n,e){if(Pl(e))return 0;{const t=Ol(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(g=>{const v={payload:g,type:"value",prevKey:h,key:g.key};return h=g.key,n=[...n,v],!1})}return n;case"child_added":if(u>-1){const h=n[u-1];(h&&h.key||null)!==r&&(n=n.filter(g=>g.payload.key!==t.key)).splice(c,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(c,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===o?e:h);case"child_moved":if(u>-1){const h=n.splice(u,1)[0];return(n=n.slice()).splice(c,0,h),n}return n;default:return n}}function Dl(n){return(Pl(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function xl(n,e,t){return function Ku(n,e,t){return fo(n,"value","once",t).pipe((0,ne.w)(r=>{const o=[(0,ie.of)(r)];return e.forEach(u=>o.push(fo(n,u,"on",t))),(0,W.T)(...o).pipe((0,Oe.R)($u,[]))}),(0,ft.x)())}(n,e=Dl(e),t)}function Ll(n,e,t){const r=(e=Dl(e)).map(o=>fo(n,o,"on",t));return(0,W.T)(...r)}function Ml(n,e){return function(r,o){return Nl(r,{stringCase:()=>n.child(r)[e](o),firebaseCase:()=>r[e](o),snapshotCase:()=>r.ref[e](o)})}}function qu(n){return function(t){return t?Nl(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function Ul(n,e){return function(){return fo(n,"value","on",e)}}A(7142);const ec=new m.OlP("angularfire2.realtimeDatabaseURL"),tc=new m.OlP("angularfire2.database.use-emulator");let nc=(()=>{class n{constructor(t,r,o,u,c,h,g,v,N,D,L,$,ee,ke,yt){this.schedulers=h;const Pn=g,Qn=(0,Z.on)(t,c,r);v&&(0,yr.nw)(Qn,c,N,L,$,ee,D,ke),this.database=(0,Z.cc)(`${Qn.name}.database.${o}`,"AngularFireDatabase",Qn.name,()=>{const Zi=c.runOutsideAngular(()=>Qn.database(o||void 0));return Pn&&Zi.useEmulator(...Pn),Zi},[Pn])}list(t,r){const o=this.schedulers.ngZone.runOutsideAngular(()=>kl(this.database,t));let u=o;return r&&(u=r(o)),function Ju(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:Ml(r,"update"),set:Ml(r,"set"),push:o=>r.push(o),remove:qu(r),snapshotChanges:o=>xl(n,o,t).pipe(de.iC),stateChanges:o=>Ll(n,o,t).pipe(de.iC),auditTrail:o=>function zu(n,e,t){return function Qu(n,e,t){return function Yu(n,e){return fo(n,"value","on",e).pipe((0,f.U)(t=>{let r;return t.payload.forEach(o=>(r=o.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function Ge(...n){const e=(0,Re.jO)(n);return(0,O.e)((t,r)=>{const o=n.length,u=new Array(o);let c=n.map(()=>!1),h=!1;for(let g=0;g<o;g++)(0,ce.Xf)(n[g]).subscribe((0,Te.x)(r,v=>{u[g]=v,!h&&!c[g]&&(c[g]=!0,(h=c.every(It.y))&&(c=null))},De.Z));t.subscribe((0,Te.x)(r,g=>{if(h){const v=[g,...u];r.next(e?e(...v):v)}}))})}(e),(0,f.U)(([o,u])=>{const c=o.lastKeyToLoad,h=u.map(g=>g.key);return{actions:u,lastKeyToLoad:c,loadedKeys:h}}),function Ye(n){return(0,O.e)((e,t)=>{let r=!1,o=0;e.subscribe((0,Te.x)(t,u=>(r||(r=!n(u,o++)))&&t.next(u)))})}(o=>-1===o.loadedKeys.indexOf(o.lastKeyToLoad)),(0,f.U)(o=>o.actions))}(n,Ll(n,e).pipe((0,Oe.R)((o,u)=>[...o,u],[])),t)}(n,o,t).pipe(de.iC),valueChanges:(o,u)=>xl(n,o,t).pipe((0,f.U)(h=>h.map(g=>u&&u.idField?Object.assign(Object.assign({},g.payload.val()),{[u.idField]:g.key}):g.payload.val())),de.iC)}}(u,this)}object(t){return function Xu(n,e){return{query:n,snapshotChanges:()=>Ul(n,e.schedulers.outsideAngular)().pipe(de.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>Ul(n,e.schedulers.outsideAngular)().pipe(de.iC,(0,f.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>kl(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(Z.Dh),m.LFG(Z.xv,8),m.LFG(ec,8),m.LFG(m.Lbi),m.LFG(m.R0b),m.LFG(de.HU),m.LFG(tc,8),m.LFG(yr.zQ,8),m.LFG(yr.Qv,8),m.LFG(yr.L6,8),m.LFG(yr._Q,8),m.LFG(yr.rT,8),m.LFG(yr.lh,8),m.LFG(yr.f7,8),m.LFG(Zu.nm,8))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})()},1623:(Vt,He,A)=>{A.d(He,{$:()=>ha,A:()=>O,B:()=>It,G:()=>Er,H:()=>gn,J:()=>I,L:()=>qt,M:()=>Sr,N:()=>la,P:()=>Ls,Q:()=>mo,R:()=>La,T:()=>Ln,U:()=>Rr,V:()=>Pr,W:()=>ca,X:()=>ve,Y:()=>kr,Z:()=>ts,_:()=>yo,a:()=>cn,a0:()=>un,a1:()=>he,a2:()=>Or,a3:()=>Je,a4:()=>fa,a5:()=>Io,a6:()=>Lr,a7:()=>Mr,a8:()=>as,a9:()=>Ur,aA:()=>Jt,aB:()=>jn,aC:()=>Zo,aD:()=>Bo,aE:()=>dt,aI:()=>Gn,aL:()=>en,aa:()=>pa,ab:()=>ds,ac:()=>fs,af:()=>Eo,ag:()=>_a,ah:()=>yi,ak:()=>di,al:()=>tn,an:()=>ya,ao:()=>Hn,ap:()=>Ue,aq:()=>Qe,ar:()=>oe,as:()=>Z,at:()=>no,au:()=>$o,av:()=>mt,aw:()=>Y,ax:()=>F,ay:()=>Ui,az:()=>Q,b:()=>Is,c:()=>Oi,d:()=>Ba,e:()=>Va,f:()=>Ga,g:()=>Mi,h:()=>Ho,i:()=>Rs,j:()=>Zs,k:()=>ni,l:()=>Fo,m:()=>Xo,n:()=>nl,o:()=>ne,r:()=>Wo,s:()=>Ua,u:()=>Fa});var m=A(5861),S=A(9058),C=A(4303),ie=A(7879),W=A(7582),f=A(4537);const ne={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},O={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const It=function Te(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},De=function ce(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Re=new S.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ye=new ie.Yd("@firebase/auth");function de(a,...i){Ye.logLevel<=ie.in.ERROR&&Ye.error(`Auth (${C.SDK_VERSION}): ${a}`,...i)}function Z(a,...i){throw rt(a,...i)}function Y(a,...i){return rt(a,...i)}function ye(a,i,s){const l=Object.assign(Object.assign({},De()),{[i]:s});return new S.LL("auth","Firebase",l).create(i,{appName:a.name})}function Ke(a,i,s){if(!(i instanceof s))throw s.name!==i.constructor.name&&Z(a,"argument-error"),ye(a,"argument-error",`Type of ${i.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function rt(a,...i){if("string"!=typeof a){const s=i[0],l=[...i.slice(1)];return l[0]&&(l[0].appName=a.name),a._errorFactory.create(s,...l)}return Re.create(a,...i)}function F(a,i,...s){if(!a)throw rt(i,...s)}function _(a){const i="INTERNAL ASSERTION FAILED: "+a;throw de(i),new Error(i)}function Ue(a,i){a||_(i)}const pt=new Map;function Q(a){Ue(a instanceof Function,"Expected a class definition");let i=pt.get(a);return i?(Ue(i instanceof a,"Instance stored in cache mismatched with class"),i):(i=new a,pt.set(a,i),i)}function ge(){var a;return typeof self<"u"&&(null===(a=self.location)||void 0===a?void 0:a.href)||""}function Ce(){return"http:"===Fe()||"https:"===Fe()}function Fe(){var a;return typeof self<"u"&&(null===(a=self.location)||void 0===a?void 0:a.protocol)||null}class Se{constructor(i,s){this.shortDelay=i,this.longDelay=s,Ue(s>i,"Short delay should be less than long delay!"),this.isMobile=(0,S.uI)()||(0,S.b$)()}get(){return function Ne(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Ce()||(0,S.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function at(a,i){Ue(a.emulator,"Emulator should always be set here");const{url:s}=a.emulator;return i?`${s}${i.startsWith("/")?i.slice(1):i}`:s}class J{static initialize(i,s,l){this.fetchImpl=i,s&&(this.headersImpl=s),l&&(this.responseImpl=l)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void _("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void _("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void _("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const We={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},j=new Se(3e4,6e4);function te(a,i){return a.tenantId&&!i.tenantId?Object.assign(Object.assign({},i),{tenantId:a.tenantId}):i}function q(a,i,s,l){return me.apply(this,arguments)}function me(){return(me=(0,m.Z)(function*(a,i,s,l,d={}){return $e(a,d,(0,m.Z)(function*(){let p={},R={};l&&("GET"===i?R=l:p={body:JSON.stringify(l)});const U=(0,S.xO)(Object.assign({key:a.config.apiKey},R)).slice(1),z=yield a._getAdditionalHeaders();return z["Content-Type"]="application/json",a.languageCode&&(z["X-Firebase-Locale"]=a.languageCode),J.fetch()(bt(a,a.config.apiHost,s,U),Object.assign({method:i,headers:z,referrerPolicy:"no-referrer"},p))}))})).apply(this,arguments)}function $e(a,i,s){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,m.Z)(function*(a,i,s){a._canInitEmulator=!1;const l=Object.assign(Object.assign({},We),i);try{const d=new ht(a),p=yield Promise.race([s(),d.promise]);d.clearNetworkTimeout();const R=yield p.json();if("needConfirmation"in R)throw we(a,"account-exists-with-different-credential",R);if(p.ok&&!("errorMessage"in R))return R;{const U=p.ok?R.errorMessage:R.error.message,[z,X]=U.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===z)throw we(a,"credential-already-in-use",R);if("EMAIL_EXISTS"===z)throw we(a,"email-already-in-use",R);if("USER_DISABLED"===z)throw we(a,"user-disabled",R);const pe=l[z]||z.toLowerCase().replace(/[_\s]+/g,"-");if(X)throw ye(a,pe,X);Z(a,pe)}}catch(d){if(d instanceof S.ZR)throw d;Z(a,"internal-error",{message:String(d)})}})).apply(this,arguments)}function Ae(a,i,s,l){return Le.apply(this,arguments)}function Le(){return(Le=(0,m.Z)(function*(a,i,s,l,d={}){const p=yield q(a,i,s,l,d);return"mfaPendingCredential"in p&&Z(a,"multi-factor-auth-required",{_serverResponse:p}),p})).apply(this,arguments)}function bt(a,i,s,l){const d=`${i}${s}?${l}`;return a.config.emulator?at(a.config,d):`${a.config.apiScheme}://${d}`}class ht{constructor(i){this.auth=i,this.timer=null,this.promise=new Promise((s,l)=>{this.timer=setTimeout(()=>l(Y(this.auth,"network-request-failed")),j.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function we(a,i,s){const l={appName:a.name};s.email&&(l.email=s.email),s.phoneNumber&&(l.phoneNumber=s.phoneNumber);const d=Y(a,i,l);return d.customData._tokenResponse=s,d}function xe(){return(xe=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:delete",i)})).apply(this,arguments)}function Dt(){return(Dt=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:update",i)})).apply(this,arguments)}function Et(){return(Et=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:lookup",i)})).apply(this,arguments)}function kt(a){if(a)try{const i=new Date(Number(a));if(!isNaN(i.getTime()))return i.toUTCString()}catch{}}function xt(){return(xt=(0,m.Z)(function*(a,i=!1){const s=(0,S.m9)(a),l=yield s.getIdToken(i),d=Lt(l);F(d&&d.exp&&d.auth_time&&d.iat,s.auth,"internal-error");const p="object"==typeof d.firebase?d.firebase:void 0,R=p?.sign_in_provider;return{claims:d,token:l,authTime:kt(Bt(d.auth_time)),issuedAtTime:kt(Bt(d.iat)),expirationTime:kt(Bt(d.exp)),signInProvider:R||null,signInSecondFactor:p?.sign_in_second_factor||null}})).apply(this,arguments)}function Bt(a){return 1e3*Number(a)}function Lt(a){const[i,s,l]=a.split(".");if(void 0===i||void 0===s||void 0===l)return de("JWT malformed, contained fewer than 3 sections"),null;try{const d=(0,S.tV)(s);return d?JSON.parse(d):(de("Failed to decode base64 JWT payload"),null)}catch(d){return de("Caught error parsing JWT payload as JSON",d?.toString()),null}}function tt(a,i){return w.apply(this,arguments)}function w(){return(w=(0,m.Z)(function*(a,i,s=!1){if(s)return i;try{return yield i}catch(l){throw l instanceof S.ZR&&function B({code:a}){return"auth/user-disabled"===a||"auth/user-token-expired"===a}(l)&&a.auth.currentUser===a&&(yield a.auth.signOut()),l}})).apply(this,arguments)}class H{constructor(i){this.user=i,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(i){var s;if(i){const l=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),l}{this.errorBackoff=3e4;const d=(null!==(s=this.user.stsTokenManager.expirationTime)&&void 0!==s?s:0)-Date.now()-3e5;return Math.max(0,d)}}schedule(i=!1){var s=this;if(!this.isRunning)return;const l=this.getInterval(i);this.timerId=setTimeout((0,m.Z)(function*(){yield s.iteration()}),l)}iteration(){var i=this;return(0,m.Z)(function*(){try{yield i.user.getIdToken(!0)}catch(s){return void("auth/network-request-failed"===s?.code&&i.schedule(!0))}i.schedule()})()}}class K{constructor(i,s){this.createdAt=i,this.lastLoginAt=s,this._initializeTime()}_initializeTime(){this.lastSignInTime=kt(this.lastLoginAt),this.creationTime=kt(this.createdAt)}_copy(i){this.createdAt=i.createdAt,this.lastLoginAt=i.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function fe(a){return le.apply(this,arguments)}function le(){return le=(0,m.Z)(function*(a){var i;const s=a.auth,l=yield a.getIdToken(),d=yield tt(a,function et(a,i){return Et.apply(this,arguments)}(s,{idToken:l}));F(d?.users.length,s,"internal-error");const p=d.users[0];a._notifyReloadListener(p);const R=null!==(i=p.providerUserInfo)&&void 0!==i&&i.length?function wt(a){return a.map(i=>{var{providerId:s}=i,l=(0,W._T)(i,["providerId"]);return{providerId:s,uid:l.rawId||"",displayName:l.displayName||null,email:l.email||null,phoneNumber:l.phoneNumber||null,photoURL:l.photoUrl||null}})}(p.providerUserInfo):[],U=function Yt(a,i){return[...a.filter(l=>!i.some(d=>d.providerId===l.providerId)),...i]}(a.providerData,R),pe=!!a.isAnonymous&&!(a.email&&p.passwordHash||U?.length),Ze={uid:p.localId,displayName:p.displayName||null,photoURL:p.photoUrl||null,email:p.email||null,emailVerified:p.emailVerified||!1,phoneNumber:p.phoneNumber||null,tenantId:p.tenantId||null,providerData:U,metadata:new K(p.createdAt,p.lastLoginAt),isAnonymous:pe};Object.assign(a,Ze)}),le.apply(this,arguments)}function ct(){return(ct=(0,m.Z)(function*(a){const i=(0,S.m9)(a);yield fe(i),yield i.auth._persistUserIfCurrent(i),i.auth._notifyListenersIfCurrent(i)})).apply(this,arguments)}function on(){return(on=(0,m.Z)(function*(a,i){const s=yield $e(a,{},(0,m.Z)(function*(){const l=(0,S.xO)({grant_type:"refresh_token",refresh_token:i}).slice(1),{tokenApiHost:d,apiKey:p}=a.config,R=bt(a,d,"/v1/token",`key=${p}`),U=yield a._getAdditionalHeaders();return U["Content-Type"]="application/x-www-form-urlencoded",J.fetch()(R,{method:"POST",headers:U,body:l})}));return{accessToken:s.access_token,expiresIn:s.expires_in,refreshToken:s.refresh_token}})).apply(this,arguments)}class St{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(i){F(i.idToken,"internal-error"),F(typeof i.idToken<"u","internal-error"),F(typeof i.refreshToken<"u","internal-error");const s="expiresIn"in i&&typeof i.expiresIn<"u"?Number(i.expiresIn):function sn(a){const i=Lt(a);return F(i,"internal-error"),F(typeof i.exp<"u","internal-error"),F(typeof i.iat<"u","internal-error"),Number(i.exp)-Number(i.iat)}(i.idToken);this.updateTokensAndExpiration(i.idToken,i.refreshToken,s)}getToken(i,s=!1){var l=this;return(0,m.Z)(function*(){return F(!l.accessToken||l.refreshToken,i,"user-token-expired"),s||!l.accessToken||l.isExpired?l.refreshToken?(yield l.refresh(i,l.refreshToken),l.accessToken):null:l.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(i,s){var l=this;return(0,m.Z)(function*(){const{accessToken:d,refreshToken:p,expiresIn:R}=yield function Qt(a,i){return on.apply(this,arguments)}(i,s);l.updateTokensAndExpiration(d,p,Number(R))})()}updateTokensAndExpiration(i,s,l){this.refreshToken=s||null,this.accessToken=i||null,this.expirationTime=Date.now()+1e3*l}static fromJSON(i,s){const{refreshToken:l,accessToken:d,expirationTime:p}=s,R=new St;return l&&(F("string"==typeof l,"internal-error",{appName:i}),R.refreshToken=l),d&&(F("string"==typeof d,"internal-error",{appName:i}),R.accessToken=d),p&&(F("number"==typeof p,"internal-error",{appName:i}),R.expirationTime=p),R}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(i){this.accessToken=i.accessToken,this.refreshToken=i.refreshToken,this.expirationTime=i.expirationTime}_clone(){return Object.assign(new St,this.toJSON())}_performRefresh(){return _("not implemented")}}function Tt(a,i){F("string"==typeof a||typeof a>"u","internal-error",{appName:i})}class gt{constructor(i){var{uid:s,auth:l,stsTokenManager:d}=i,p=(0,W._T)(i,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=s,this.auth=l,this.stsTokenManager=d,this.accessToken=d.accessToken,this.displayName=p.displayName||null,this.email=p.email||null,this.emailVerified=p.emailVerified||!1,this.phoneNumber=p.phoneNumber||null,this.photoURL=p.photoURL||null,this.isAnonymous=p.isAnonymous||!1,this.tenantId=p.tenantId||null,this.providerData=p.providerData?[...p.providerData]:[],this.metadata=new K(p.createdAt||void 0,p.lastLoginAt||void 0)}getIdToken(i){var s=this;return(0,m.Z)(function*(){const l=yield tt(s,s.stsTokenManager.getToken(s.auth,i));return F(l,s.auth,"internal-error"),s.accessToken!==l&&(s.accessToken=l,yield s.auth._persistUserIfCurrent(s),s.auth._notifyListenersIfCurrent(s)),l})()}getIdTokenResult(i){return function zt(a){return xt.apply(this,arguments)}(this,i)}reload(){return function Ve(a){return ct.apply(this,arguments)}(this)}_assign(i){this!==i&&(F(this.uid===i.uid,this.auth,"internal-error"),this.displayName=i.displayName,this.photoURL=i.photoURL,this.email=i.email,this.emailVerified=i.emailVerified,this.phoneNumber=i.phoneNumber,this.isAnonymous=i.isAnonymous,this.tenantId=i.tenantId,this.providerData=i.providerData.map(s=>Object.assign({},s)),this.metadata._copy(i.metadata),this.stsTokenManager._assign(i.stsTokenManager))}_clone(i){return new gt(Object.assign(Object.assign({},this),{auth:i,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(i){F(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=i,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(i){this.reloadListener?this.reloadListener(i):this.reloadUserInfo=i}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(i,s=!1){var l=this;return(0,m.Z)(function*(){let d=!1;i.idToken&&i.idToken!==l.stsTokenManager.accessToken&&(l.stsTokenManager.updateFromServerResponse(i),d=!0),s&&(yield fe(l)),yield l.auth._persistUserIfCurrent(l),d&&l.auth._notifyListenersIfCurrent(l)})()}delete(){var i=this;return(0,m.Z)(function*(){const s=yield i.getIdToken();return yield tt(i,function ze(a,i){return xe.apply(this,arguments)}(i.auth,{idToken:s})),i.stsTokenManager.clearRefreshToken(),i.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(i=>Object.assign({},i)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(i,s){var l,d,p,R,U,z,X,pe;const Ze=null!==(l=s.displayName)&&void 0!==l?l:void 0,jt=null!==(d=s.email)&&void 0!==d?d:void 0,Rn=null!==(p=s.phoneNumber)&&void 0!==p?p:void 0,dn=null!==(R=s.photoURL)&&void 0!==R?R:void 0,hn=null!==(U=s.tenantId)&&void 0!==U?U:void 0,so=null!==(z=s._redirectEventId)&&void 0!==z?z:void 0,Vi=null!==(X=s.createdAt)&&void 0!==X?X:void 0,ii=null!==(pe=s.lastLoginAt)&&void 0!==pe?pe:void 0,{uid:oo,emailVerified:Yn,isAnonymous:ra,providerData:Bi,stsTokenManager:ao}=s;F(oo&&ao,i,"internal-error");const ia=St.fromJSON(this.name,ao);F("string"==typeof oo,i,"internal-error"),Tt(Ze,i.name),Tt(jt,i.name),F("boolean"==typeof Yn,i,"internal-error"),F("boolean"==typeof ra,i,"internal-error"),Tt(Rn,i.name),Tt(dn,i.name),Tt(hn,i.name),Tt(so,i.name),Tt(Vi,i.name),Tt(ii,i.name);const gr=new gt({uid:oo,auth:i,email:jt,emailVerified:Yn,displayName:Ze,isAnonymous:ra,photoURL:dn,phoneNumber:Rn,tenantId:hn,stsTokenManager:ia,createdAt:Vi,lastLoginAt:ii});return Bi&&Array.isArray(Bi)&&(gr.providerData=Bi.map(lo=>Object.assign({},lo))),so&&(gr._redirectEventId=so),gr}static _fromIdTokenResponse(i,s,l=!1){return(0,m.Z)(function*(){const d=new St;d.updateFromServerResponse(s);const p=new gt({uid:s.localId,auth:i,stsTokenManager:d,isAnonymous:l});return yield fe(p),p})()}}const qt=(()=>{class a{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,m.Z)(function*(){return!0})()}_set(s,l){var d=this;return(0,m.Z)(function*(){d.storage[s]=l})()}_get(s){var l=this;return(0,m.Z)(function*(){const d=l.storage[s];return void 0===d?null:d})()}_remove(s){var l=this;return(0,m.Z)(function*(){delete l.storage[s]})()}_addListener(s,l){}_removeListener(s,l){}}return a.type="NONE",a})();function Jt(a,i,s){return`firebase:${a}:${i}:${s}`}class Mt{constructor(i,s,l){this.persistence=i,this.auth=s,this.userKey=l;const{config:d,name:p}=this.auth;this.fullUserKey=Jt(this.userKey,d.apiKey,p),this.fullPersistenceKey=Jt("persistence",d.apiKey,p),this.boundEventHandler=s._onStorageEvent.bind(s),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(i){return this.persistence._set(this.fullUserKey,i.toJSON())}getCurrentUser(){var i=this;return(0,m.Z)(function*(){const s=yield i.persistence._get(i.fullUserKey);return s?gt._fromJSON(i.auth,s):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(i){var s=this;return(0,m.Z)(function*(){if(s.persistence===i)return;const l=yield s.getCurrentUser();return yield s.removeCurrentUser(),s.persistence=i,l?s.setCurrentUser(l):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(i,s,l="authUser"){return(0,m.Z)(function*(){if(!s.length)return new Mt(Q(qt),i,l);const d=(yield Promise.all(s.map(function(){var X=(0,m.Z)(function*(pe){if(yield pe._isAvailable())return pe});return function(pe){return X.apply(this,arguments)}}()))).filter(X=>X);let p=d[0]||Q(qt);const R=Jt(l,i.config.apiKey,i.name);let U=null;for(const X of s)try{const pe=yield X._get(R);if(pe){const Ze=gt._fromJSON(i,pe);X!==p&&(U=Ze),p=X;break}}catch{}const z=d.filter(X=>X._shouldAllowMigration);return p._shouldAllowMigration&&z.length?(p=z[0],U&&(yield p._set(R,U.toJSON())),yield Promise.all(s.map(function(){var X=(0,m.Z)(function*(pe){if(pe!==p)try{yield pe._remove(R)}catch{}});return function(pe){return X.apply(this,arguments)}}())),new Mt(p,i,l)):new Mt(p,i,l)})()}}function b(a){const i=a.toLowerCase();if(i.includes("opera/")||i.includes("opr/")||i.includes("opios/"))return"Opera";if(G(i))return"IEMobile";if(i.includes("msie")||i.includes("trident/"))return"IE";if(i.includes("edge/"))return"Edge";if(E(i))return"Firefox";if(i.includes("silk/"))return"Silk";if(Ie(i))return"Blackberry";if(Pe(i))return"Webos";if(y(i))return"Safari";if((i.includes("chrome/")||M(i))&&!i.includes("edge/"))return"Chrome";if(oe(i))return"Android";{const l=a.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===l?.length)return l[1]}return"Other"}function E(a=(0,S.z$)()){return/firefox\//i.test(a)}function y(a=(0,S.z$)()){const i=a.toLowerCase();return i.includes("safari/")&&!i.includes("chrome/")&&!i.includes("crios/")&&!i.includes("android")}function M(a=(0,S.z$)()){return/crios\//i.test(a)}function G(a=(0,S.z$)()){return/iemobile/i.test(a)}function oe(a=(0,S.z$)()){return/android/i.test(a)}function Ie(a=(0,S.z$)()){return/blackberry/i.test(a)}function Pe(a=(0,S.z$)()){return/webos/i.test(a)}function Qe(a=(0,S.z$)()){return/iphone|ipad|ipod/i.test(a)||/macintosh/i.test(a)&&/mobile/i.test(a)}function mt(a=(0,S.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(a)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(a)}function Pt(a=(0,S.z$)()){return Qe(a)||oe(a)||Pe(a)||Ie(a)||/windows phone/i.test(a)||G(a)}function kn(a,i=[]){let s;switch(a){case"Browser":s=b((0,S.z$)());break;case"Worker":s=`${b((0,S.z$)())}-${a}`;break;default:s=a}const l=i.length?i.join(","):"FirebaseCore-web";return`${s}/JsCore/${C.SDK_VERSION}/${l}`}class ai{constructor(i){this.auth=i,this.queue=[]}pushCallback(i,s){const l=p=>new Promise((R,U)=>{try{R(i(p))}catch(z){U(z)}});l.onAbort=s,this.queue.push(l);const d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}runMiddleware(i){var s=this;return(0,m.Z)(function*(){if(s.auth.currentUser===i)return;const l=[];try{for(const d of s.queue)yield d(i),d.onAbort&&l.push(d.onAbort)}catch(d){l.reverse();for(const p of l)try{p()}catch{}throw s.auth._errorFactory.create("login-blocked",{originalMessage:d?.message})}})()}}class Hi{constructor(i,s,l){this.app=i,this.heartbeatServiceProvider=s,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ir(this),this.idTokenSubscription=new Ir(this),this.beforeStateQueue=new ai(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Re,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=i.name,this.clientVersion=l.sdkClientVersion}_initializeWithPersistence(i,s){var l=this;return s&&(this._popupRedirectResolver=Q(s)),this._initializationPromise=this.queue((0,m.Z)(function*(){var d,p;if(!l._deleted&&(l.persistenceManager=yield Mt.create(l,i),!l._deleted)){if(null!==(d=l._popupRedirectResolver)&&void 0!==d&&d._shouldInitProactively)try{yield l._popupRedirectResolver._initialize(l)}catch{}yield l.initializeCurrentUser(s),l.lastNotifiedUid=(null===(p=l.currentUser)||void 0===p?void 0:p.uid)||null,!l._deleted&&(l._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var i=this;return(0,m.Z)(function*(){if(i._deleted)return;const s=yield i.assertedPersistence.getCurrentUser();if(i.currentUser||s){if(i.currentUser&&s&&i.currentUser.uid===s.uid)return i._currentUser._assign(s),void(yield i.currentUser.getIdToken());yield i._updateCurrentUser(s,!0)}})()}initializeCurrentUser(i){var s=this;return(0,m.Z)(function*(){var l;const d=yield s.assertedPersistence.getCurrentUser();let p=d,R=!1;if(i&&s.config.authDomain){yield s.getOrInitRedirectPersistenceManager();const U=null===(l=s.redirectUser)||void 0===l?void 0:l._redirectEventId,z=p?._redirectEventId,X=yield s.tryRedirectSignIn(i);(!U||U===z)&&X?.user&&(p=X.user,R=!0)}if(!p)return s.directlySetCurrentUser(null);if(!p._redirectEventId){if(R)try{yield s.beforeStateQueue.runMiddleware(p)}catch(U){p=d,s._popupRedirectResolver._overrideRedirectResult(s,()=>Promise.reject(U))}return p?s.reloadAndSetCurrentUserOrClear(p):s.directlySetCurrentUser(null)}return F(s._popupRedirectResolver,s,"argument-error"),yield s.getOrInitRedirectPersistenceManager(),s.redirectUser&&s.redirectUser._redirectEventId===p._redirectEventId?s.directlySetCurrentUser(p):s.reloadAndSetCurrentUserOrClear(p)})()}tryRedirectSignIn(i){var s=this;return(0,m.Z)(function*(){let l=null;try{l=yield s._popupRedirectResolver._completeRedirectFn(s,i,!0)}catch{yield s._setRedirectUser(null)}return l})()}reloadAndSetCurrentUserOrClear(i){var s=this;return(0,m.Z)(function*(){try{yield fe(i)}catch(l){if("auth/network-request-failed"!==l?.code)return s.directlySetCurrentUser(null)}return s.directlySetCurrentUser(i)})()}useDeviceLanguage(){this.languageCode=function je(){if(typeof navigator>"u")return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null}()}_delete(){var i=this;return(0,m.Z)(function*(){i._deleted=!0})()}updateCurrentUser(i){var s=this;return(0,m.Z)(function*(){const l=i?(0,S.m9)(i):null;return l&&F(l.auth.config.apiKey===s.config.apiKey,s,"invalid-user-token"),s._updateCurrentUser(l&&l._clone(s))})()}_updateCurrentUser(i,s=!1){var l=this;return(0,m.Z)(function*(){if(!l._deleted)return i&&F(l.tenantId===i.tenantId,l,"tenant-id-mismatch"),s||(yield l.beforeStateQueue.runMiddleware(i)),l.queue((0,m.Z)(function*(){yield l.directlySetCurrentUser(i),l.notifyAuthListeners()}))})()}signOut(){var i=this;return(0,m.Z)(function*(){return yield i.beforeStateQueue.runMiddleware(null),(i.redirectPersistenceManager||i._popupRedirectResolver)&&(yield i._setRedirectUser(null)),i._updateCurrentUser(null,!0)})()}setPersistence(i){var s=this;return this.queue((0,m.Z)(function*(){yield s.assertedPersistence.setPersistence(Q(i))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(i){this._errorFactory=new S.LL("auth","Firebase",i())}onAuthStateChanged(i,s,l){return this.registerStateListener(this.authStateSubscription,i,s,l)}beforeAuthStateChanged(i,s){return this.beforeStateQueue.pushCallback(i,s)}onIdTokenChanged(i,s,l){return this.registerStateListener(this.idTokenSubscription,i,s,l)}toJSON(){var i;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(i=this._currentUser)||void 0===i?void 0:i.toJSON()}}_setRedirectUser(i,s){var l=this;return(0,m.Z)(function*(){const d=yield l.getOrInitRedirectPersistenceManager(s);return null===i?d.removeCurrentUser():d.setCurrentUser(i)})()}getOrInitRedirectPersistenceManager(i){var s=this;return(0,m.Z)(function*(){if(!s.redirectPersistenceManager){const l=i&&Q(i)||s._popupRedirectResolver;F(l,s,"argument-error"),s.redirectPersistenceManager=yield Mt.create(s,[Q(l._redirectPersistence)],"redirectUser"),s.redirectUser=yield s.redirectPersistenceManager.getCurrentUser()}return s.redirectPersistenceManager})()}_redirectUserForId(i){var s=this;return(0,m.Z)(function*(){var l,d;return s._isInitialized&&(yield s.queue((0,m.Z)(function*(){}))),(null===(l=s._currentUser)||void 0===l?void 0:l._redirectEventId)===i?s._currentUser:(null===(d=s.redirectUser)||void 0===d?void 0:d._redirectEventId)===i?s.redirectUser:null})()}_persistUserIfCurrent(i){var s=this;return(0,m.Z)(function*(){if(i===s.currentUser)return s.queue((0,m.Z)(function*(){return s.directlySetCurrentUser(i)}))})()}_notifyListenersIfCurrent(i){i===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var i,s;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const l=null!==(s=null===(i=this.currentUser)||void 0===i?void 0:i.uid)&&void 0!==s?s:null;this.lastNotifiedUid!==l&&(this.lastNotifiedUid=l,this.authStateSubscription.next(this.currentUser))}registerStateListener(i,s,l,d){if(this._deleted)return()=>{};const p="function"==typeof s?s:s.next.bind(s),R=this._isInitialized?Promise.resolve():this._initializationPromise;return F(R,this,"internal-error"),R.then(()=>p(this.currentUser)),"function"==typeof s?i.addObserver(s,l,d):i.addObserver(s)}directlySetCurrentUser(i){var s=this;return(0,m.Z)(function*(){s.currentUser&&s.currentUser!==i&&s._currentUser._stopProactiveRefresh(),i&&s.isProactiveRefreshEnabled&&i._startProactiveRefresh(),s.currentUser=i,i?yield s.assertedPersistence.setCurrentUser(i):yield s.assertedPersistence.removeCurrentUser()})()}queue(i){return this.operations=this.operations.then(i,i),this.operations}get assertedPersistence(){return F(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(i){!i||this.frameworks.includes(i)||(this.frameworks.push(i),this.frameworks.sort(),this.clientVersion=kn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var i=this;return(0,m.Z)(function*(){var s;const l={"X-Client-Version":i.clientVersion};i.app.options.appId&&(l["X-Firebase-gmpid"]=i.app.options.appId);const d=yield null===(s=i.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===s?void 0:s.getHeartbeatsHeader();return d&&(l["X-Firebase-Client"]=d),l})()}}function dt(a){return(0,S.m9)(a)}class Ir{constructor(i){this.auth=i,this.observer=null,this.addObserver=(0,S.ne)(s=>this.observer=s)}get next(){return F(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Er(a,i,s){const l=dt(a);F(l._canInitEmulator,l,"emulator-config-failed"),F(/^https?:\/\//.test(i),l,"invalid-emulator-scheme");const d=!!s?.disableWarnings,p=Tr(i),{host:R,port:U}=function Cr(a){const i=Tr(a),s=/(\/\/)?([^?#/]+)/.exec(a.substr(i.length));if(!s)return{host:"",port:null};const l=s[2].split("@").pop()||"",d=/^(\[[^\]]+\])(:|$)/.exec(l);if(d){const p=d[1];return{host:p,port:qn(l.substr(p.length+1))}}{const[p,R]=l.split(":");return{host:p,port:qn(R)}}}(i);l.config.emulator={url:`${p}//${R}${null===U?"":`:${U}`}/`},l.settings.appVerificationDisabledForTesting=!0,l.emulatorConfig=Object.freeze({host:R,port:U,protocol:p.replace(":",""),options:Object.freeze({disableWarnings:d})}),d||function po(){function a(){const i=document.createElement("p"),s=i.style;i.innerText="Running in emulator mode. Do not use with production credentials.",s.position="fixed",s.width="100%",s.backgroundColor="#ffffff",s.border=".1em solid #000000",s.color="#b50000",s.bottom="0px",s.left="0px",s.margin="0px",s.zIndex="10000",s.textAlign="center",i.classList.add("firebase-emulator-warning"),document.body.appendChild(i)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a())}()}function Tr(a){const i=a.indexOf(":");return i<0?"":a.substr(0,i+1)}function qn(a){if(!a)return null;const i=Number(a);return isNaN(i)?null:i}class gn{constructor(i,s){this.providerId=i,this.signInMethod=s}toJSON(){return _("not implemented")}_getIdTokenResponse(i){return _("not implemented")}_linkToIdToken(i,s){return _("not implemented")}_getReauthenticationResolver(i){return _("not implemented")}}function Gi(a,i){return Zt.apply(this,arguments)}function Zt(){return(Zt=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:resetPassword",te(a,i))})).apply(this,arguments)}function mn(a,i){return li.apply(this,arguments)}function li(){return(li=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:update",i)})).apply(this,arguments)}function an(){return(an=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:update",te(a,i))})).apply(this,arguments)}function Nn(){return(Nn=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signInWithPassword",te(a,i))})).apply(this,arguments)}function yn(a,i){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:sendOobCode",te(a,i))})).apply(this,arguments)}function On(){return(On=(0,m.Z)(function*(a,i){return yn(a,i)})).apply(this,arguments)}function Xn(){return(Xn=(0,m.Z)(function*(a,i){return yn(a,i)})).apply(this,arguments)}function er(){return(er=(0,m.Z)(function*(a,i){return yn(a,i)})).apply(this,arguments)}function Ar(){return(Ar=(0,m.Z)(function*(a,i){return yn(a,i)})).apply(this,arguments)}function tr(){return(tr=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signInWithEmailLink",te(a,i))})).apply(this,arguments)}function ci(){return(ci=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signInWithEmailLink",te(a,i))})).apply(this,arguments)}class Dn extends gn{constructor(i,s,l,d=null){super("password",l),this._email=i,this._password=s,this._tenantId=d}static _fromEmailAndPassword(i,s){return new Dn(i,s,"password")}static _fromEmailAndCode(i,s,l=null){return new Dn(i,s,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(i){const s="string"==typeof i?JSON.parse(i):i;if(s?.email&&s?.password){if("password"===s.signInMethod)return this._fromEmailAndPassword(s.email,s.password);if("emailLink"===s.signInMethod)return this._fromEmailAndCode(s.email,s.password,s.tenantId)}return null}_getIdTokenResponse(i){var s=this;return(0,m.Z)(function*(){switch(s.signInMethod){case"password":return function vn(a,i){return Nn.apply(this,arguments)}(i,{returnSecureToken:!0,email:s._email,password:s._password});case"emailLink":return function $i(a,i){return tr.apply(this,arguments)}(i,{email:s._email,oobCode:s._password});default:Z(i,"internal-error")}})()}_linkToIdToken(i,s){var l=this;return(0,m.Z)(function*(){switch(l.signInMethod){case"password":return mn(i,{idToken:s,returnSecureToken:!0,email:l._email,password:l._password});case"emailLink":return function zi(a,i){return ci.apply(this,arguments)}(i,{idToken:s,email:l._email,oobCode:l._password});default:Z(i,"internal-error")}})()}_getReauthenticationResolver(i){return this._getIdTokenResponse(i)}}function Ht(a,i){return wr.apply(this,arguments)}function wr(){return(wr=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signInWithIdp",te(a,i))})).apply(this,arguments)}class I extends gn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(i){const s=new I(i.providerId,i.signInMethod);return i.idToken||i.accessToken?(i.idToken&&(s.idToken=i.idToken),i.accessToken&&(s.accessToken=i.accessToken),i.nonce&&!i.pendingToken&&(s.nonce=i.nonce),i.pendingToken&&(s.pendingToken=i.pendingToken)):i.oauthToken&&i.oauthTokenSecret?(s.accessToken=i.oauthToken,s.secret=i.oauthTokenSecret):Z("argument-error"),s}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(i){const s="string"==typeof i?JSON.parse(i):i,{providerId:l,signInMethod:d}=s,p=(0,W._T)(s,["providerId","signInMethod"]);if(!l||!d)return null;const R=new I(l,d);return R.idToken=p.idToken||void 0,R.accessToken=p.accessToken||void 0,R.secret=p.secret,R.nonce=p.nonce,R.pendingToken=p.pendingToken||null,R}_getIdTokenResponse(i){return Ht(i,this.buildRequest())}_linkToIdToken(i,s){const l=this.buildRequest();return l.idToken=s,Ht(i,l)}_getReauthenticationResolver(i){const s=this.buildRequest();return s.autoCreate=!1,Ht(i,s)}buildRequest(){const i={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)i.pendingToken=this.pendingToken;else{const s={};this.idToken&&(s.id_token=this.idToken),this.accessToken&&(s.access_token=this.accessToken),this.secret&&(s.oauth_token_secret=this.secret),s.providerId=this.providerId,this.nonce&&!this.pendingToken&&(s.nonce=this.nonce),i.postBody=(0,S.xO)(s)}return i}}function k(){return(k=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:sendVerificationCode",te(a,i))})).apply(this,arguments)}function V(){return(V=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signInWithPhoneNumber",te(a,i))})).apply(this,arguments)}function se(){return(se=(0,m.Z)(function*(a,i){const s=yield Ae(a,"POST","/v1/accounts:signInWithPhoneNumber",te(a,i));if(s.temporaryProof)throw we(a,"account-exists-with-different-credential",s);return s})).apply(this,arguments)}const be={USER_NOT_FOUND:"user-not-found"};function Xt(){return(Xt=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signInWithPhoneNumber",te(a,Object.assign(Object.assign({},i),{operation:"REAUTH"})),be)})).apply(this,arguments)}class lt extends gn{constructor(i){super("phone","phone"),this.params=i}static _fromVerification(i,s){return new lt({verificationId:i,verificationCode:s})}static _fromTokenResponse(i,s){return new lt({phoneNumber:i,temporaryProof:s})}_getIdTokenResponse(i){return function x(a,i){return V.apply(this,arguments)}(i,this._makeVerificationRequest())}_linkToIdToken(i,s){return function ue(a,i){return se.apply(this,arguments)}(i,Object.assign({idToken:s},this._makeVerificationRequest()))}_getReauthenticationResolver(i){return function xn(a,i){return Xt.apply(this,arguments)}(i,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:i,phoneNumber:s,verificationId:l,verificationCode:d}=this.params;return i&&s?{temporaryProof:i,phoneNumber:s}:{sessionInfo:l,code:d}}toJSON(){const i={providerId:this.providerId};return this.params.phoneNumber&&(i.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(i.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(i.verificationCode=this.params.verificationCode),this.params.verificationId&&(i.verificationId=this.params.verificationId),i}static fromJSON(i){"string"==typeof i&&(i=JSON.parse(i));const{verificationId:s,verificationCode:l,phoneNumber:d,temporaryProof:p}=i;return l||s||d||p?new lt({verificationId:s,verificationCode:l,phoneNumber:d,temporaryProof:p}):null}}class ut{constructor(i){var s,l,d,p,R,U;const z=(0,S.zd)((0,S.pd)(i)),X=null!==(s=z.apiKey)&&void 0!==s?s:null,pe=null!==(l=z.oobCode)&&void 0!==l?l:null,Ze=function qe(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(d=z.mode)&&void 0!==d?d:null);F(X&&pe&&Ze,"argument-error"),this.apiKey=X,this.operation=Ze,this.code=pe,this.continueUrl=null!==(p=z.continueUrl)&&void 0!==p?p:null,this.languageCode=null!==(R=z.languageCode)&&void 0!==R?R:null,this.tenantId=null!==(U=z.tenantId)&&void 0!==U?U:null}static parseLink(i){const s=function _e(a){const i=(0,S.zd)((0,S.pd)(a)).link,s=i?(0,S.zd)((0,S.pd)(i)).deep_link_id:null,l=(0,S.zd)((0,S.pd)(a)).deep_link_id;return(l?(0,S.zd)((0,S.pd)(l)).link:null)||l||s||i||a}(i);try{return new ut(s)}catch{return null}}}let Sr=(()=>{class a{constructor(){this.providerId=a.PROVIDER_ID}static credential(s,l){return Dn._fromEmailAndPassword(s,l)}static credentialWithLink(s,l){const d=ut.parseLink(l);return F(d,"argument-error"),Dn._fromEmailAndCode(s,d.code,d.tenantId)}}return a.PROVIDER_ID="password",a.EMAIL_PASSWORD_SIGN_IN_METHOD="password",a.EMAIL_LINK_SIGN_IN_METHOD="emailLink",a})();class st{constructor(i){this.providerId=i,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(i){this.defaultLanguageCode=i}setCustomParameters(i){return this.customParameters=i,this}getCustomParameters(){return this.customParameters}}class nr extends st{constructor(){super(...arguments),this.scopes=[]}addScope(i){return this.scopes.includes(i)||this.scopes.push(i),this}getScopes(){return[...this.scopes]}}class Rr extends nr{static credentialFromJSON(i){const s="string"==typeof i?JSON.parse(i):i;return F("providerId"in s&&"signInMethod"in s,"argument-error"),I._fromParams(s)}credential(i){return this._credential(Object.assign(Object.assign({},i),{nonce:i.rawNonce}))}_credential(i){return F(i.idToken||i.accessToken,"argument-error"),I._fromParams(Object.assign(Object.assign({},i),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(i){return Rr.oauthCredentialFromTaggedObject(i)}static credentialFromError(i){return Rr.oauthCredentialFromTaggedObject(i.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:i}){if(!i)return null;const{oauthIdToken:s,oauthAccessToken:l,oauthTokenSecret:d,pendingToken:p,nonce:R,providerId:U}=i;if(!l&&!d&&!s&&!p||!U)return null;try{return new Rr(U)._credential({idToken:s,accessToken:l,nonce:R,pendingToken:p})}catch{return null}}}let la=(()=>{class a extends nr{constructor(){super("facebook.com")}static credential(s){return I._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.FACEBOOK_SIGN_IN_METHOD,accessToken:s})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s||!("oauthAccessToken"in s)||!s.oauthAccessToken)return null;try{return a.credential(s.oauthAccessToken)}catch{return null}}}return a.FACEBOOK_SIGN_IN_METHOD="facebook.com",a.PROVIDER_ID="facebook.com",a})(),mo=(()=>{class a extends nr{constructor(){super("google.com"),this.addScope("profile")}static credential(s,l){return I._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.GOOGLE_SIGN_IN_METHOD,idToken:s,accessToken:l})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{oauthIdToken:l,oauthAccessToken:d}=s;if(!l&&!d)return null;try{return a.credential(l,d)}catch{return null}}}return a.GOOGLE_SIGN_IN_METHOD="google.com",a.PROVIDER_ID="google.com",a})(),Ln=(()=>{class a extends nr{constructor(){super("github.com")}static credential(s){return I._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.GITHUB_SIGN_IN_METHOD,accessToken:s})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s||!("oauthAccessToken"in s)||!s.oauthAccessToken)return null;try{return a.credential(s.oauthAccessToken)}catch{return null}}}return a.GITHUB_SIGN_IN_METHOD="github.com",a.PROVIDER_ID="github.com",a})();class en extends gn{constructor(i,s){super(i,i),this.pendingToken=s}_getIdTokenResponse(i){return Ht(i,this.buildRequest())}_linkToIdToken(i,s){const l=this.buildRequest();return l.idToken=s,Ht(i,l)}_getReauthenticationResolver(i){const s=this.buildRequest();return s.autoCreate=!1,Ht(i,s)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(i){const s="string"==typeof i?JSON.parse(i):i,{providerId:l,signInMethod:d,pendingToken:p}=s;return l&&d&&p&&l===d?new en(l,p):null}static _create(i,s){return new en(i,s)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Pr extends st{constructor(i){F(i.startsWith("saml."),"argument-error"),super(i)}static credentialFromResult(i){return Pr.samlCredentialFromTaggedObject(i)}static credentialFromError(i){return Pr.samlCredentialFromTaggedObject(i.customData||{})}static credentialFromJSON(i){const s=en.fromJSON(i);return F(s,"argument-error"),s}static samlCredentialFromTaggedObject({_tokenResponse:i}){if(!i)return null;const{pendingToken:s,providerId:l}=i;if(!s||!l)return null;try{return en._create(l,s)}catch{return null}}}let ca=(()=>{class a extends nr{constructor(){super("twitter.com")}static credential(s,l){return I._fromParams({providerId:a.PROVIDER_ID,signInMethod:a.TWITTER_SIGN_IN_METHOD,oauthToken:s,oauthTokenSecret:l})}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{oauthAccessToken:l,oauthTokenSecret:d}=s;if(!l||!d)return null;try{return a.credential(l,d)}catch{return null}}}return a.TWITTER_SIGN_IN_METHOD="twitter.com",a.PROVIDER_ID="twitter.com",a})();function vo(a,i){return Qi.apply(this,arguments)}function Qi(){return(Qi=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signUp",te(a,i))})).apply(this,arguments)}class Nt{constructor(i){this.user=i.user,this.providerId=i.providerId,this._tokenResponse=i._tokenResponse,this.operationType=i.operationType}static _fromIdTokenResponse(i,s,l,d=!1){return(0,m.Z)(function*(){const p=yield gt._fromIdTokenResponse(i,l,d),R=In(l);return new Nt({user:p,providerId:R,_tokenResponse:l,operationType:s})})()}static _forOperation(i,s,l){return(0,m.Z)(function*(){yield i._updateTokensIfNecessary(l,!0);const d=In(l);return new Nt({user:i,providerId:d,_tokenResponse:l,operationType:s})})()}}function In(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}function ve(a){return rr.apply(this,arguments)}function rr(){return(rr=(0,m.Z)(function*(a){var i;const s=dt(a);if(yield s._initializationPromise,null!==(i=s.currentUser)&&void 0!==i&&i.isAnonymous)return new Nt({user:s.currentUser,providerId:null,operationType:"signIn"});const l=yield vo(s,{returnSecureToken:!0}),d=yield Nt._fromIdTokenResponse(s,"signIn",l,!0);return yield s._updateCurrentUser(d.user),d})).apply(this,arguments)}class Mn extends S.ZR{constructor(i,s,l,d){var p;super(s.code,s.message),this.operationType=l,this.user=d,Object.setPrototypeOf(this,Mn.prototype),this.customData={appName:i.name,tenantId:null!==(p=i.tenantId)&&void 0!==p?p:void 0,_serverResponse:s.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(i,s,l,d){return new Mn(i,s,l,d)}}function qi(a,i,s,l){return("reauthenticate"===i?s._getReauthenticationResolver(a):s._getIdTokenResponse(a)).catch(p=>{throw"auth/multi-factor-auth-required"===p.code?Mn._fromErrorAndOperation(a,p,i,l):p})}function Gt(a){return new Set(a.map(({providerId:i})=>i).filter(i=>!!i))}function di(a,i){return Ot.apply(this,arguments)}function Ot(){return Ot=(0,m.Z)(function*(a,i){const s=(0,S.m9)(a);yield hi(!0,s,i);const{providerUserInfo:l}=yield function _t(a,i){return Dt.apply(this,arguments)}(s.auth,{idToken:yield s.getIdToken(),deleteProvider:[i]}),d=Gt(l||[]);return s.providerData=s.providerData.filter(p=>d.has(p.providerId)),d.has("phone")||(s.phoneNumber=null),yield s.auth._persistUserIfCurrent(s),s}),Ot.apply(this,arguments)}function Ji(a,i){return vt.apply(this,arguments)}function vt(){return(vt=(0,m.Z)(function*(a,i,s=!1){const l=yield tt(a,i._linkToIdToken(a.auth,yield a.getIdToken()),s);return Nt._forOperation(a,"link",l)})).apply(this,arguments)}function hi(a,i,s){return br.apply(this,arguments)}function br(){return(br=(0,m.Z)(function*(a,i,s){yield fe(i);const d=!1===a?"provider-already-linked":"no-such-provider";F(Gt(i.providerData).has(s)===a,i.auth,d)})).apply(this,arguments)}function fi(a,i){return Xi.apply(this,arguments)}function Xi(){return(Xi=(0,m.Z)(function*(a,i,s=!1){const{auth:l}=a,d="reauthenticate";try{const p=yield tt(a,qi(l,d,i,a),s);F(p.idToken,l,"internal-error");const R=Lt(p.idToken);F(R,l,"internal-error");const{sub:U}=R;return F(a.uid===U,l,"user-mismatch"),Nt._forOperation(a,d,p)}catch(p){throw"auth/user-not-found"===p?.code&&Z(l,"user-mismatch"),p}})).apply(this,arguments)}function es(a,i){return pi.apply(this,arguments)}function pi(){return(pi=(0,m.Z)(function*(a,i,s=!1){const l="signIn",d=yield qi(a,l,i),p=yield Nt._fromIdTokenResponse(a,l,d);return s||(yield a._updateCurrentUser(p.user)),p})).apply(this,arguments)}function kr(a,i){return En.apply(this,arguments)}function En(){return(En=(0,m.Z)(function*(a,i){return es(dt(a),i)})).apply(this,arguments)}function ts(a,i){return _i.apply(this,arguments)}function _i(){return(_i=(0,m.Z)(function*(a,i){const s=(0,S.m9)(a);return yield hi(!1,s,i.providerId),Ji(s,i)})).apply(this,arguments)}function yo(a,i){return ns.apply(this,arguments)}function ns(){return(ns=(0,m.Z)(function*(a,i){return fi((0,S.m9)(a),i)})).apply(this,arguments)}function Me(){return(Me=(0,m.Z)(function*(a,i){return Ae(a,"POST","/v1/accounts:signInWithCustomToken",te(a,i))})).apply(this,arguments)}function ha(a,i){return rs.apply(this,arguments)}function rs(){return rs=(0,m.Z)(function*(a,i){const s=dt(a),l=yield function da(a,i){return Me.apply(this,arguments)}(s,{token:i,returnSecureToken:!0}),d=yield Nt._fromIdTokenResponse(s,"signIn",l);return yield s._updateCurrentUser(d.user),d}),rs.apply(this,arguments)}class Un{constructor(i,s){this.factorId=i,this.uid=s.mfaEnrollmentId,this.enrollmentTime=new Date(s.enrolledAt).toUTCString(),this.displayName=s.displayName}static _fromServerResponse(i,s){return"phoneInfo"in s?Nr._fromServerResponse(i,s):Z(i,"internal-error")}}class Nr extends Un{constructor(i){super("phone",i),this.phoneNumber=i.phoneInfo}static _fromServerResponse(i,s){return new Nr(s)}}function ln(a,i,s){var l;F((null===(l=s.url)||void 0===l?void 0:l.length)>0,a,"invalid-continue-uri"),F(typeof s.dynamicLinkDomain>"u"||s.dynamicLinkDomain.length>0,a,"invalid-dynamic-link-domain"),i.continueUrl=s.url,i.dynamicLinkDomain=s.dynamicLinkDomain,i.canHandleCodeInApp=s.handleCodeInApp,s.iOS&&(F(s.iOS.bundleId.length>0,a,"missing-ios-bundle-id"),i.iOSBundleId=s.iOS.bundleId),s.android&&(F(s.android.packageName.length>0,a,"missing-android-pkg-name"),i.androidInstallApp=s.android.installApp,i.androidMinimumVersionCode=s.android.minimumVersion,i.androidPackageName=s.android.packageName)}function un(a,i,s){return Fn.apply(this,arguments)}function Fn(){return Fn=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a),d={requestType:"PASSWORD_RESET",email:i};s&&ln(l,d,s),yield function ui(a,i){return Xn.apply(this,arguments)}(l,d)}),Fn.apply(this,arguments)}function he(a,i,s){return is.apply(this,arguments)}function is(){return(is=(0,m.Z)(function*(a,i,s){yield Gi((0,S.m9)(a),{oobCode:i,newPassword:s})})).apply(this,arguments)}function Or(a,i){return ss.apply(this,arguments)}function ss(){return ss=(0,m.Z)(function*(a,i){yield function Ki(a,i){return an.apply(this,arguments)}((0,S.m9)(a),{oobCode:i})}),ss.apply(this,arguments)}function Je(a,i){return Dr.apply(this,arguments)}function Dr(){return(Dr=(0,m.Z)(function*(a,i){const s=(0,S.m9)(a),l=yield Gi(s,{oobCode:i}),d=l.requestType;switch(F(d,s,"internal-error"),d){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":F(l.newEmail,s,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":F(l.mfaInfo,s,"internal-error");default:F(l.email,s,"internal-error")}let p=null;return l.mfaInfo&&(p=Un._fromServerResponse(dt(s),l.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.newEmail:l.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.email:l.newEmail)||null,multiFactorInfo:p},operation:d}})).apply(this,arguments)}function fa(a,i){return xr.apply(this,arguments)}function xr(){return(xr=(0,m.Z)(function*(a,i){const{data:s}=yield Je((0,S.m9)(a),i);return s.email})).apply(this,arguments)}function Io(a,i,s){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,m.Z)(function*(a,i,s){const l=dt(a),d=yield vo(l,{returnSecureToken:!0,email:i,password:s}),p=yield Nt._fromIdTokenResponse(l,"signIn",d);return yield l._updateCurrentUser(p.user),p})).apply(this,arguments)}function Lr(a,i,s){return kr((0,S.m9)(a),Sr.credential(i,s))}function Mr(a,i,s){return os.apply(this,arguments)}function os(){return os=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a),d={requestType:"EMAIL_SIGNIN",email:i};F(s.handleCodeInApp,l,"argument-error"),s&&ln(l,d,s),yield function go(a,i){return er.apply(this,arguments)}(l,d)}),os.apply(this,arguments)}function as(a,i){const s=ut.parseLink(i);return"EMAIL_SIGNIN"===s?.operation}function Ur(a,i,s){return ls.apply(this,arguments)}function ls(){return(ls=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a),d=Sr.credentialWithLink(i,s||ge());return F(d._tenantId===(l.tenantId||null),l,"tenant-id-mismatch"),kr(l,d)})).apply(this,arguments)}function us(){return(us=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:createAuthUri",te(a,i))})).apply(this,arguments)}function pa(a,i){return cs.apply(this,arguments)}function cs(){return cs=(0,m.Z)(function*(a,i){const l={identifier:i,continueUri:Ce()?ge():"http://localhost"},{signinMethods:d}=yield function gi(a,i){return us.apply(this,arguments)}((0,S.m9)(a),l);return d||[]}),cs.apply(this,arguments)}function ds(a,i){return hs.apply(this,arguments)}function hs(){return hs=(0,m.Z)(function*(a,i){const s=(0,S.m9)(a),d={requestType:"VERIFY_EMAIL",idToken:yield a.getIdToken()};i&&ln(s.auth,d,i);const{email:p}=yield function _o(a,i){return On.apply(this,arguments)}(s.auth,d);p!==a.email&&(yield a.reload())}),hs.apply(this,arguments)}function fs(a,i,s){return ps.apply(this,arguments)}function ps(){return ps=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a),p={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield a.getIdToken(),newEmail:i};s&&ln(l.auth,p,s);const{email:R}=yield function ji(a,i){return Ar.apply(this,arguments)}(l.auth,p);R!==a.email&&(yield a.reload())}),ps.apply(this,arguments)}function vi(){return(vi=(0,m.Z)(function*(a,i){return q(a,"POST","/v1/accounts:update",i)})).apply(this,arguments)}function Eo(a,i){return ir.apply(this,arguments)}function ir(){return ir=(0,m.Z)(function*(a,{displayName:i,photoURL:s}){if(void 0===i&&void 0===s)return;const l=(0,S.m9)(a),p={idToken:yield l.getIdToken(),displayName:i,photoUrl:s,returnSecureToken:!0},R=yield tt(l,function mi(a,i){return vi.apply(this,arguments)}(l.auth,p));l.displayName=R.displayName||null,l.photoURL=R.photoUrl||null;const U=l.providerData.find(({providerId:z})=>"password"===z);U&&(U.displayName=l.displayName,U.photoURL=l.photoURL),yield l._updateTokensIfNecessary(R)}),ir.apply(this,arguments)}function _a(a,i){return Wn((0,S.m9)(a),i,null)}function yi(a,i){return Wn((0,S.m9)(a),null,i)}function Wn(a,i,s){return Fr.apply(this,arguments)}function Fr(){return(Fr=(0,m.Z)(function*(a,i,s){const{auth:l}=a,p={idToken:yield a.getIdToken(),returnSecureToken:!0};i&&(p.email=i),s&&(p.password=s);const R=yield tt(a,mn(l,p));yield a._updateTokensIfNecessary(R,!0)})).apply(this,arguments)}class sr{constructor(i,s,l={}){this.isNewUser=i,this.providerId=s,this.profile=l}}class To extends sr{constructor(i,s,l,d){super(i,s,l),this.username=d}}class Co extends sr{constructor(i,s){super(i,"facebook.com",s)}}class ga extends To{constructor(i,s){super(i,"github.com",s,"string"==typeof s?.login?s?.login:null)}}class ma extends sr{constructor(i,s){super(i,"google.com",s)}}class va extends To{constructor(i,s,l){super(i,"twitter.com",s,l)}}function tn(a){const{user:i,_tokenResponse:s}=a;return i.isAnonymous&&!s?{providerId:null,isNewUser:!1,profile:null}:function _s(a){var i,s;if(!a)return null;const{providerId:l}=a,d=a.rawUserInfo?JSON.parse(a.rawUserInfo):{},p=a.isNewUser||"identitytoolkit#SignupNewUserResponse"===a.kind;if(!l&&a?.idToken){const R=null===(s=null===(i=Lt(a.idToken))||void 0===i?void 0:i.firebase)||void 0===s?void 0:s.sign_in_provider;if(R)return new sr(p,"anonymous"!==R&&"custom"!==R?R:null)}if(!l)return null;switch(l){case"facebook.com":return new Co(p,d);case"github.com":return new ga(p,d);case"google.com":return new ma(p,d);case"twitter.com":return new va(p,d,a.screenName||null);case"custom":case"anonymous":return new sr(p,null);default:return new sr(p,l,d)}}(s)}class Bn{constructor(i,s,l){this.type=i,this.credential=s,this.auth=l}static _fromIdtoken(i,s){return new Bn("enroll",i,s)}static _fromMfaPendingCredential(i){return new Bn("signin",i)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(i){var s,l;if(i?.multiFactorSession){if(null!==(s=i.multiFactorSession)&&void 0!==s&&s.pendingCredential)return Bn._fromMfaPendingCredential(i.multiFactorSession.pendingCredential);if(null!==(l=i.multiFactorSession)&&void 0!==l&&l.idToken)return Bn._fromIdtoken(i.multiFactorSession.idToken)}return null}}class Zn{constructor(i,s,l){this.session=i,this.hints=s,this.signInResolver=l}static _fromError(i,s){const l=dt(i),d=s.customData._serverResponse,p=(d.mfaInfo||[]).map(U=>Un._fromServerResponse(l,U));F(d.mfaPendingCredential,l,"internal-error");const R=Bn._fromMfaPendingCredential(d.mfaPendingCredential);return new Zn(R,p,function(){var U=(0,m.Z)(function*(z){const X=yield z._process(l,R);delete d.mfaInfo,delete d.mfaPendingCredential;const pe=Object.assign(Object.assign({},d),{idToken:X.idToken,refreshToken:X.refreshToken});switch(s.operationType){case"signIn":const Ze=yield Nt._fromIdTokenResponse(l,s.operationType,pe);return yield l._updateCurrentUser(Ze.user),Ze;case"reauthenticate":return F(s.user,l,"internal-error"),Nt._forOperation(s.user,s.operationType,pe);default:Z(l,"internal-error")}});return function(z){return U.apply(this,arguments)}}())}resolveSignIn(i){var s=this;return(0,m.Z)(function*(){return s.signInResolver(i)})()}}function ya(a,i){var s;const l=(0,S.m9)(a),d=i;return F(i.customData.operationType,l,"argument-error"),F(null===(s=d.customData._serverResponse)||void 0===s?void 0:s.mfaPendingCredential,l,"argument-error"),Zn._fromError(l,d)}class Ti{constructor(i){this.user=i,this.enrolledFactors=[],i._onReload(s=>{s.mfaInfo&&(this.enrolledFactors=s.mfaInfo.map(l=>Un._fromServerResponse(i.auth,l)))})}static _fromUser(i){return new Ti(i)}getSession(){var i=this;return(0,m.Z)(function*(){return Bn._fromIdtoken(yield i.user.getIdToken(),i.user.auth)})()}enroll(i,s){var l=this;return(0,m.Z)(function*(){const d=i,p=yield l.getSession(),R=yield tt(l.user,d._process(l.user.auth,p,s));return yield l.user._updateTokensIfNecessary(R),l.user.reload()})()}unenroll(i){var s=this;return(0,m.Z)(function*(){const l="string"==typeof i?i:i.uid,d=yield s.user.getIdToken();try{const p=yield tt(s.user,function Vr(a,i){return q(a,"POST","/v2/accounts/mfaEnrollment:withdraw",te(a,i))}(s.user.auth,{idToken:d,mfaEnrollmentId:l}));s.enrolledFactors=s.enrolledFactors.filter(({uid:R})=>R!==l),yield s.user._updateTokensIfNecessary(p),yield s.user.reload()}catch(p){throw p}})()}}const ar=new WeakMap;function Hn(a){const i=(0,S.m9)(a);return ar.has(i)||ar.set(i,Ti._fromUser(i)),ar.get(i)}const lr="__sak";class wo{constructor(i,s){this.storageRetriever=i,this.type=s}_isAvailable(){try{return this.storage?(this.storage.setItem(lr,"1"),this.storage.removeItem(lr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(i,s){return this.storage.setItem(i,JSON.stringify(s)),Promise.resolve()}_get(i){const s=this.storage.getItem(i);return Promise.resolve(s?JSON.parse(s):null)}_remove(i){return this.storage.removeItem(i),Promise.resolve()}get storage(){return this.storageRetriever()}}const Is=(()=>{class a extends wo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(s,l)=>this.onStorageEvent(s,l),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Be(){const a=(0,S.z$)();return y(a)||Qe(a)}()&&function _n(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Pt(),this._shouldAllowMigration=!0}forAllChangedKeys(s){for(const l of Object.keys(this.listeners)){const d=this.storage.getItem(l),p=this.localCache[l];d!==p&&s(l,p,d)}}onStorageEvent(s,l=!1){if(!s.key)return void this.forAllChangedKeys((U,z,X)=>{this.notifyListeners(U,X)});const d=s.key;if(l?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const U=this.storage.getItem(d);if(s.newValue!==U)null!==s.newValue?this.storage.setItem(d,s.newValue):this.storage.removeItem(d);else if(this.localCache[d]===s.newValue&&!l)return}const p=()=>{const U=this.storage.getItem(d);!l&&this.localCache[d]===U||this.notifyListeners(d,U)},R=this.storage.getItem(d);!function Ee(){return(0,S.w1)()&&10===document.documentMode}()||R===s.newValue||s.newValue===s.oldValue?p():setTimeout(p,10)}notifyListeners(s,l){this.localCache[s]=l;const d=this.listeners[s];if(d)for(const p of Array.from(d))p(l&&JSON.parse(l))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((s,l,d)=>{this.onStorageEvent(new StorageEvent("storage",{key:s,oldValue:l,newValue:d}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(s,l){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[s]||(this.listeners[s]=new Set,this.localCache[s]=this.storage.getItem(s)),this.listeners[s].add(l)}_removeListener(s,l){this.listeners[s]&&(this.listeners[s].delete(l),0===this.listeners[s].size&&delete this.listeners[s]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(s,l){var d=()=>super._set,p=this;return(0,m.Z)(function*(){yield d().call(p,s,l),p.localCache[s]=JSON.stringify(l)})()}_get(s){var l=()=>super._get,d=this;return(0,m.Z)(function*(){const p=yield l().call(d,s);return d.localCache[s]=JSON.stringify(p),p})()}_remove(s){var l=()=>super._remove,d=this;return(0,m.Z)(function*(){yield l().call(d,s),delete d.localCache[s]})()}}return a.type="LOCAL",a})(),cn=(()=>{class a extends wo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(s,l){}_removeListener(s,l){}}return a.type="SESSION",a})();let Cn=(()=>{class a{constructor(s){this.eventTarget=s,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(s){const l=this.receivers.find(p=>p.isListeningto(s));if(l)return l;const d=new a(s);return this.receivers.push(d),d}isListeningto(s){return this.eventTarget===s}handleEvent(s){var l=this;return(0,m.Z)(function*(){const d=s,{eventId:p,eventType:R,data:U}=d.data,z=l.handlersMap[R];if(!z?.size)return;d.ports[0].postMessage({status:"ack",eventId:p,eventType:R});const X=Array.from(z).map(function(){var Ze=(0,m.Z)(function*(jt){return jt(d.origin,U)});return function(jt){return Ze.apply(this,arguments)}}()),pe=yield function Po(a){return Promise.all(a.map(function(){var i=(0,m.Z)(function*(s){try{return{fulfilled:!0,value:yield s}}catch(l){return{fulfilled:!1,reason:l}}});return function(s){return i.apply(this,arguments)}}()))}(X);d.ports[0].postMessage({status:"done",eventId:p,eventType:R,response:pe})})()}_subscribe(s,l){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[s]||(this.handlersMap[s]=new Set),this.handlersMap[s].add(l)}_unsubscribe(s,l){this.handlersMap[s]&&l&&this.handlersMap[s].delete(l),(!l||0===this.handlersMap[s].size)&&delete this.handlersMap[s],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return a.receivers=[],a})();function Gn(a="",i=10){let s="";for(let l=0;l<i;l++)s+=Math.floor(10*Math.random());return a+s}class ur{constructor(i){this.target=i,this.handlers=new Set}removeMessageHandler(i){i.messageChannel&&(i.messageChannel.port1.removeEventListener("message",i.onMessage),i.messageChannel.port1.close()),this.handlers.delete(i)}_send(i,s,l=50){var d=this;return(0,m.Z)(function*(){const p=typeof MessageChannel<"u"?new MessageChannel:null;if(!p)throw new Error("connection_unavailable");let R,U;return new Promise((z,X)=>{const pe=Gn("",20);p.port1.start();const Ze=setTimeout(()=>{X(new Error("unsupported_event"))},l);U={messageChannel:p,onMessage(jt){const Rn=jt;if(Rn.data.eventId===pe)switch(Rn.data.status){case"ack":clearTimeout(Ze),R=setTimeout(()=>{X(new Error("timeout"))},3e3);break;case"done":clearTimeout(R),z(Rn.data.response);break;default:clearTimeout(Ze),clearTimeout(R),X(new Error("invalid_response"))}}},d.handlers.add(U),p.port1.addEventListener("message",U.onMessage),d.target.postMessage({eventType:i,eventId:pe,data:s},[p.port2])}).finally(()=>{U&&d.removeMessageHandler(U)})})()}}function ot(){return window}function Es(){return typeof ot().WorkerGlobalScope<"u"&&"function"==typeof ot().importScripts}function Ts(){return(Ts=(0,m.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const bo="firebaseLocalStorageDb",Zr="firebaseLocalStorage",Cs="fbase_key";class Hr{constructor(i){this.request=i}toPromise(){return new Promise((i,s)=>{this.request.addEventListener("success",()=>{i(this.request.result)}),this.request.addEventListener("error",()=>{s(this.request.error)})})}}function Ai(a,i){return a.transaction([Zr],i?"readwrite":"readonly").objectStore(Zr)}function As(){const a=indexedDB.open(bo,1);return new Promise((i,s)=>{a.addEventListener("error",()=>{s(a.error)}),a.addEventListener("upgradeneeded",()=>{const l=a.result;try{l.createObjectStore(Zr,{keyPath:Cs})}catch(d){s(d)}}),a.addEventListener("success",(0,m.Z)(function*(){const l=a.result;l.objectStoreNames.contains(Zr)?i(l):(l.close(),yield function wa(){const a=indexedDB.deleteDatabase(bo);return new Hr(a).toPromise()}(),i(yield As()))}))})}function ko(a,i,s){return ws.apply(this,arguments)}function ws(){return(ws=(0,m.Z)(function*(a,i,s){const l=Ai(a,!0).put({[Cs]:i,value:s});return new Hr(l).toPromise()})).apply(this,arguments)}function Gr(){return(Gr=(0,m.Z)(function*(a,i){const s=Ai(a,!1).get(i),l=yield new Hr(s).toPromise();return void 0===l?null:l.value})).apply(this,arguments)}function Ss(a,i){const s=Ai(a,!0).delete(i);return new Hr(s).toPromise()}const Rs=(()=>{class a{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var s=this;return(0,m.Z)(function*(){return s.db||(s.db=yield As()),s.db})()}_withRetries(s){var l=this;return(0,m.Z)(function*(){let d=0;for(;;)try{const p=yield l._openDb();return yield s(p)}catch(p){if(d++>3)throw p;l.db&&(l.db.close(),l.db=void 0)}})()}initializeServiceWorkerMessaging(){var s=this;return(0,m.Z)(function*(){return Es()?s.initializeReceiver():s.initializeSender()})()}initializeReceiver(){var s=this;return(0,m.Z)(function*(){s.receiver=Cn._getInstance(function Ca(){return Es()?self:null}()),s.receiver._subscribe("keyChanged",function(){var l=(0,m.Z)(function*(d,p){return{keyProcessed:(yield s._poll()).includes(p.key)}});return function(d,p){return l.apply(this,arguments)}}()),s.receiver._subscribe("ping",function(){var l=(0,m.Z)(function*(d,p){return["keyChanged"]});return function(d,p){return l.apply(this,arguments)}}())})()}initializeSender(){var s=this;return(0,m.Z)(function*(){var l,d;if(s.activeServiceWorker=yield function Ea(){return Ts.apply(this,arguments)}(),!s.activeServiceWorker)return;s.sender=new ur(s.activeServiceWorker);const p=yield s.sender._send("ping",{},800);p&&null!==(l=p[0])&&void 0!==l&&l.fulfilled&&null!==(d=p[0])&&void 0!==d&&d.value.includes("keyChanged")&&(s.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(s){var l=this;return(0,m.Z)(function*(){if(l.sender&&l.activeServiceWorker&&function Ta(){var a;return(null===(a=navigator?.serviceWorker)||void 0===a?void 0:a.controller)||null}()===l.activeServiceWorker)try{yield l.sender._send("keyChanged",{key:s},l.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,m.Z)(function*(){try{if(!indexedDB)return!1;const s=yield As();return yield ko(s,lr,"1"),yield Ss(s,lr),!0}catch{}return!1})()}_withPendingWrite(s){var l=this;return(0,m.Z)(function*(){l.pendingWrites++;try{yield s()}finally{l.pendingWrites--}})()}_set(s,l){var d=this;return(0,m.Z)(function*(){return d._withPendingWrite((0,m.Z)(function*(){return yield d._withRetries(p=>ko(p,s,l)),d.localCache[s]=l,d.notifyServiceWorker(s)}))})()}_get(s){var l=this;return(0,m.Z)(function*(){const d=yield l._withRetries(p=>function wi(a,i){return Gr.apply(this,arguments)}(p,s));return l.localCache[s]=d,d})()}_remove(s){var l=this;return(0,m.Z)(function*(){return l._withPendingWrite((0,m.Z)(function*(){return yield l._withRetries(d=>Ss(d,s)),delete l.localCache[s],l.notifyServiceWorker(s)}))})()}_poll(){var s=this;return(0,m.Z)(function*(){const l=yield s._withRetries(R=>{const U=Ai(R,!1).getAll();return new Hr(U).toPromise()});if(!l)return[];if(0!==s.pendingWrites)return[];const d=[],p=new Set;for(const{fbase_key:R,value:U}of l)p.add(R),JSON.stringify(s.localCache[R])!==JSON.stringify(U)&&(s.notifyListeners(R,U),d.push(R));for(const R of Object.keys(s.localCache))s.localCache[R]&&!p.has(R)&&(s.notifyListeners(R,null),d.push(R));return d})()}notifyListeners(s,l){this.localCache[s]=l;const d=this.listeners[s];if(d)for(const p of Array.from(d))p(l)}startPolling(){var s=this;this.stopPolling(),this.pollTimer=setInterval((0,m.Z)(function*(){return s._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(s,l){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[s]||(this.listeners[s]=new Set,this._get(s)),this.listeners[s].add(l)}_removeListener(s,l){this.listeners[s]&&(this.listeners[s].delete(l),0===this.listeners[s].size&&delete this.listeners[s]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return a.type="LOCAL",a})();function Ri(){return(Ri=(0,m.Z)(function*(a){return(yield q(a,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Do(a){return new Promise((i,s)=>{const l=document.createElement("script");l.setAttribute("src",a),l.onload=i,l.onerror=d=>{const p=Y("internal-error");p.customData=d,s(p)},l.type="text/javascript",l.charset="UTF-8",function Ps(){var a,i;return null!==(i=null===(a=document.getElementsByTagName("head"))||void 0===a?void 0:a[0])&&void 0!==i?i:document}().appendChild(l)})}function xo(a){return`__${a}${Math.floor(1e6*Math.random())}`}const Kr=1e12;class Pi{constructor(i){this.auth=i,this.counter=Kr,this._widgets=new Map}render(i,s){const l=this.counter;return this._widgets.set(l,new bs(i,this.auth.name,s||{})),this.counter++,l}reset(i){var s;const l=i||Kr;null===(s=this._widgets.get(l))||void 0===s||s.delete(),this._widgets.delete(l)}getResponse(i){var s;return(null===(s=this._widgets.get(i||Kr))||void 0===s?void 0:s.getResponse())||""}execute(i){var s=this;return(0,m.Z)(function*(){var l;return null===(l=s._widgets.get(i||Kr))||void 0===l||l.execute(),""})()}}class bs{constructor(i,s,l){this.params=l,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const d="string"==typeof i?document.getElementById(i):i;F(d,"argument-error",{appName:s}),this.container=d,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Lo(a){const i=[],s="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let l=0;l<a;l++)i.push(s.charAt(Math.floor(62*Math.random())));return i.join("")}(50);const{callback:i,"expired-callback":s}=this.params;if(i)try{i(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,s)try{s()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const ks=xo("rcb"),Mo=new Se(3e4,6e4);class Na{constructor(){var i;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(i=ot().grecaptcha)||void 0===i||!i.render)}load(i,s=""){return F(function Oa(a){return a.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(a)}(s),i,"argument-error"),this.shouldResolveImmediately(s)?Promise.resolve(ot().grecaptcha):new Promise((l,d)=>{const p=ot().setTimeout(()=>{d(Y(i,"network-request-failed"))},Mo.get());ot()[ks]=()=>{ot().clearTimeout(p),delete ot()[ks];const U=ot().grecaptcha;if(!U)return void d(Y(i,"internal-error"));const z=U.render;U.render=(X,pe)=>{const Ze=z(X,pe);return this.counter++,Ze},this.hostLanguage=s,l(U)},Do(`https://www.google.com/recaptcha/api.js??${(0,S.xO)({onload:ks,render:"explicit",hl:s})}`).catch(()=>{clearTimeout(p),d(Y(i,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(i){var s;return!(null===(s=ot().grecaptcha)||void 0===s||!s.render)&&(i===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Da{load(i){return(0,m.Z)(function*(){return new Pi(i)})()}clearedOneInstance(){}}const Uo="recaptcha",xa={theme:"light",type:"image"};class La{constructor(i,s=Object.assign({},xa),l){this.parameters=s,this.type=Uo,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=dt(l),this.isInvisible="invisible"===this.parameters.size,F(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const d="string"==typeof i?document.getElementById(i):i;F(d,this.auth,"argument-error"),this.container=d,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Da:new Na,this.validateStartingState()}verify(){var i=this;return(0,m.Z)(function*(){i.assertNotDestroyed();const s=yield i.render(),l=i.getAssertedRecaptcha();return l.getResponse(s)||new Promise(p=>{const R=U=>{U&&(i.tokenChangeListeners.delete(R),p(U))};i.tokenChangeListeners.add(R),i.isInvisible&&l.execute(s)})})()}render(){try{this.assertNotDestroyed()}catch(i){return Promise.reject(i)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(i=>{throw this.renderPromise=null,i})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(i=>{this.container.removeChild(i)})}validateStartingState(){F(!this.parameters.sitekey,this.auth,"argument-error"),F(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),F(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(i){return s=>{if(this.tokenChangeListeners.forEach(l=>l(s)),"function"==typeof i)i(s);else if("string"==typeof i){const l=ot()[i];"function"==typeof l&&l(s)}}}assertNotDestroyed(){F(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var i=this;return(0,m.Z)(function*(){if(yield i.init(),!i.widgetId){let s=i.container;if(!i.isInvisible){const l=document.createElement("div");s.appendChild(l),s=l}i.widgetId=i.getAssertedRecaptcha().render(s,i.parameters)}return i.widgetId})()}init(){var i=this;return(0,m.Z)(function*(){F(Ce()&&!Es(),i.auth,"internal-error"),yield function Ma(){let a=null;return new Promise(i=>{"complete"!==document.readyState?(a=()=>i(),window.addEventListener("load",a)):i()}).catch(i=>{throw a&&window.removeEventListener("load",a),i})}(),i.recaptcha=yield i._recaptchaLoader.load(i.auth,i.auth.languageCode||void 0);const s=yield function Pa(a){return Ri.apply(this,arguments)}(i.auth);F(s,i.auth,"internal-error"),i.parameters.sitekey=s})()}getAssertedRecaptcha(){return F(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class bi{constructor(i,s){this.verificationId=i,this.onConfirmation=s}confirm(i){const s=lt._fromVerification(this.verificationId,i);return this.onConfirmation(s)}}function Ua(a,i,s){return ki.apply(this,arguments)}function ki(){return(ki=(0,m.Z)(function*(a,i,s){const l=dt(a),d=yield jr(l,i,(0,S.m9)(s));return new bi(d,p=>kr(l,p))})).apply(this,arguments)}function Fo(a,i,s){return Os.apply(this,arguments)}function Os(){return(Os=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a);yield hi(!1,l,"phone");const d=yield jr(l.auth,i,(0,S.m9)(s));return new bi(d,p=>ts(l,p))})).apply(this,arguments)}function Wo(a,i,s){return cr.apply(this,arguments)}function cr(){return(cr=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a),d=yield jr(l.auth,i,(0,S.m9)(s));return new bi(d,p=>yo(l,p))})).apply(this,arguments)}function jr(a,i,s){return Ds.apply(this,arguments)}function Ds(){return Ds=(0,m.Z)(function*(a,i,s){var l;const d=yield s.verify();try{let p;if(F("string"==typeof d,a,"argument-error"),F(s.type===Uo,a,"argument-error"),p="string"==typeof i?{phoneNumber:i}:i,"session"in p){const R=p.session;if("phoneNumber"in p)return F("enroll"===R.type,a,"internal-error"),(yield function Ia(a,i){return q(a,"POST","/v2/accounts/mfaEnrollment:start",te(a,i))}(a,{idToken:R.credential,phoneEnrollmentInfo:{phoneNumber:p.phoneNumber,recaptchaToken:d}})).phoneSessionInfo.sessionInfo;{F("signin"===R.type,a,"internal-error");const U=(null===(l=p.multiFactorHint)||void 0===l?void 0:l.uid)||p.multiFactorUid;return F(U,a,"missing-multi-factor-info"),(yield function Oo(a,i){return q(a,"POST","/v2/accounts/mfaSignIn:start",te(a,i))}(a,{mfaPendingCredential:R.credential,mfaEnrollmentId:U,phoneSignInInfo:{recaptchaToken:d}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:R}=yield function P(a,i){return k.apply(this,arguments)}(a,{phoneNumber:p.phoneNumber,recaptchaToken:d});return R}}finally{s._reset()}}),Ds.apply(this,arguments)}function Fa(a,i){return xs.apply(this,arguments)}function xs(){return(xs=(0,m.Z)(function*(a,i){yield Ji((0,S.m9)(a),i)})).apply(this,arguments)}let Ls=(()=>{class a{constructor(s){this.providerId=a.PROVIDER_ID,this.auth=dt(s)}verifyPhoneNumber(s,l){return jr(this.auth,s,(0,S.m9)(l))}static credential(s,l){return lt._fromVerification(s,l)}static credentialFromResult(s){return a.credentialFromTaggedObject(s)}static credentialFromError(s){return a.credentialFromTaggedObject(s.customData||{})}static credentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{phoneNumber:l,temporaryProof:d}=s;return l&&d?lt._fromTokenResponse(l,d):null}}return a.PROVIDER_ID="phone",a.PHONE_SIGN_IN_METHOD="phone",a})();function An(a,i){return i?Q(i):(F(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}class Ms extends gn{constructor(i){super("custom","custom"),this.params=i}_getIdTokenResponse(i){return Ht(i,this._buildIdpRequest())}_linkToIdToken(i,s){return Ht(i,this._buildIdpRequest(s))}_getReauthenticationResolver(i){return Ht(i,this._buildIdpRequest())}_buildIdpRequest(i){const s={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return i&&(s.idToken=i),s}}function Wa(a){return es(a.auth,new Ms(a),a.bypassAuthState)}function Vo(a){const{auth:i,user:s}=a;return F(s,i,"internal-error"),fi(s,new Ms(a),a.bypassAuthState)}function wn(a){return Ni.apply(this,arguments)}function Ni(){return(Ni=(0,m.Z)(function*(a){const{auth:i,user:s}=a;return F(s,i,"internal-error"),Ji(s,new Ms(a),a.bypassAuthState)})).apply(this,arguments)}class Us{constructor(i,s,l,d,p=!1){this.auth=i,this.resolver=l,this.user=d,this.bypassAuthState=p,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(s)?s:[s]}execute(){var i=this;return new Promise(function(){var s=(0,m.Z)(function*(l,d){i.pendingPromise={resolve:l,reject:d};try{i.eventManager=yield i.resolver._initialize(i.auth),yield i.onExecution(),i.eventManager.registerConsumer(i)}catch(p){i.reject(p)}});return function(l,d){return s.apply(this,arguments)}}())}onAuthEvent(i){var s=this;return(0,m.Z)(function*(){const{urlResponse:l,sessionId:d,postBody:p,tenantId:R,error:U,type:z}=i;if(U)return void s.reject(U);const X={auth:s.auth,requestUri:l,sessionId:d,tenantId:R||void 0,postBody:p||void 0,user:s.user,bypassAuthState:s.bypassAuthState};try{s.resolve(yield s.getIdpTask(z)(X))}catch(pe){s.reject(pe)}})()}onError(i){this.reject(i)}getIdpTask(i){switch(i){case"signInViaPopup":case"signInViaRedirect":return Wa;case"linkViaPopup":case"linkViaRedirect":return wn;case"reauthViaPopup":case"reauthViaRedirect":return Vo;default:Z(this.auth,"internal-error")}}resolve(i){Ue(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(i),this.unregisterAndCleanUp()}reject(i){Ue(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(i),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Sn=new Se(2e3,1e4);function Oi(a,i,s){return dr.apply(this,arguments)}function dr(){return(dr=(0,m.Z)(function*(a,i,s){const l=dt(a);Ke(a,i,st);const d=An(l,s);return new $r(l,"signInViaPopup",i,d).executeNotNull()})).apply(this,arguments)}function Va(a,i,s){return Fs.apply(this,arguments)}function Fs(){return(Fs=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a);Ke(l.auth,i,st);const d=An(l.auth,s);return new $r(l.auth,"reauthViaPopup",i,d,l).executeNotNull()})).apply(this,arguments)}function Ba(a,i,s){return Di.apply(this,arguments)}function Di(){return(Di=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a);Ke(l.auth,i,st);const d=An(l.auth,s);return new $r(l.auth,"linkViaPopup",i,d,l).executeNotNull()})).apply(this,arguments)}let $r=(()=>{class a extends Us{constructor(s,l,d,p,R){super(s,l,p,R),this.provider=d,this.authWindow=null,this.pollId=null,a.currentPopupAction&&a.currentPopupAction.cancel(),a.currentPopupAction=this}executeNotNull(){var s=this;return(0,m.Z)(function*(){const l=yield s.execute();return F(l,s.auth,"internal-error"),l})()}onExecution(){var s=this;return(0,m.Z)(function*(){Ue(1===s.filter.length,"Popup operations only handle one event");const l=Gn();s.authWindow=yield s.resolver._openPopup(s.auth,s.provider,s.filter[0],l),s.authWindow.associatedEvent=l,s.resolver._originValidation(s.auth).catch(d=>{s.reject(d)}),s.resolver._isIframeWebStorageSupported(s.auth,d=>{d||s.reject(Y(s.auth,"web-storage-unsupported"))}),s.pollUserCancellation()})()}get eventId(){var s;return(null===(s=this.authWindow)||void 0===s?void 0:s.associatedEvent)||null}cancel(){this.reject(Y(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,a.currentPopupAction=null}pollUserCancellation(){const s=()=>{var l,d;this.pollId=null!==(d=null===(l=this.authWindow)||void 0===l?void 0:l.window)&&void 0!==d&&d.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Y(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(s,Sn.get())};s()}}return a.currentPopupAction=null,a})();const Za="pendingRedirect",Ut=new Map;class zr extends Us{constructor(i,s,l=!1){super(i,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],s,void 0,l),this.eventId=null}execute(){var i=()=>super.execute,s=this;return(0,m.Z)(function*(){let l=Ut.get(s.auth._key());if(!l){try{const p=(yield function Ha(a,i){return Ws.apply(this,arguments)}(s.resolver,s.auth))?yield i().call(s):null;l=()=>Promise.resolve(p)}catch(d){l=()=>Promise.reject(d)}Ut.set(s.auth._key(),l)}return s.bypassAuthState||Ut.set(s.auth._key(),()=>Promise.resolve(null)),l()})()}onAuthEvent(i){var s=()=>super.onAuthEvent,l=this;return(0,m.Z)(function*(){if("signInViaRedirect"===i.type)return s().call(l,i);if("unknown"!==i.type){if(i.eventId){const d=yield l.auth._redirectUserForId(i.eventId);if(d)return l.user=d,s().call(l,i);l.resolve(null)}}else l.resolve(null)})()}onExecution(){return(0,m.Z)(function*(){})()}cleanUp(){}}function Ws(){return(Ws=(0,m.Z)(function*(a,i){const s=Yr(i),l=xi(a);if(!(yield l._isAvailable()))return!1;const d="true"===(yield l._get(s));return yield l._remove(s),d})).apply(this,arguments)}function Vs(a,i){return hr.apply(this,arguments)}function hr(){return(hr=(0,m.Z)(function*(a,i){return xi(a)._set(Yr(i),"true")})).apply(this,arguments)}function Bo(){Ut.clear()}function Zo(a,i){Ut.set(a._key(),i)}function xi(a){return Q(a._redirectPersistence)}function Yr(a){return Jt(Za,a.config.apiKey,a.name)}function Ga(a,i,s){return function fr(a,i,s){return Li.apply(this,arguments)}(a,i,s)}function Li(){return(Li=(0,m.Z)(function*(a,i,s){const l=dt(a);Ke(a,i,st),yield l._initializationPromise;const d=An(l,s);return yield Vs(d,l),d._openRedirect(l,i,"signInViaRedirect")})).apply(this,arguments)}function Ho(a,i,s){return function Go(a,i,s){return Kn.apply(this,arguments)}(a,i,s)}function Kn(){return(Kn=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a);Ke(l.auth,i,st),yield l.auth._initializationPromise;const d=An(l.auth,s);yield Vs(d,l.auth);const p=yield Ko(l);return d._openRedirect(l.auth,i,"reauthViaRedirect",p)})).apply(this,arguments)}function Mi(a,i,s){return function Bs(a,i,s){return Qr.apply(this,arguments)}(a,i,s)}function Qr(){return(Qr=(0,m.Z)(function*(a,i,s){const l=(0,S.m9)(a);Ke(l.auth,i,st),yield l.auth._initializationPromise;const d=An(l.auth,s);yield hi(!1,l,i.providerId),yield Vs(d,l.auth);const p=yield Ko(l);return d._openRedirect(l.auth,i,"linkViaRedirect",p)})).apply(this,arguments)}function Zs(a,i){return Hs.apply(this,arguments)}function Hs(){return(Hs=(0,m.Z)(function*(a,i){return yield dt(a)._initializationPromise,jn(a,i,!1)})).apply(this,arguments)}function jn(a,i){return Gs.apply(this,arguments)}function Gs(){return(Gs=(0,m.Z)(function*(a,i,s=!1){const l=dt(a),d=An(l,i),R=yield new zr(l,d,s).execute();return R&&!s&&(delete R.user._redirectEventId,yield l._persistUserIfCurrent(R.user),yield l._setRedirectUser(null,i)),R})).apply(this,arguments)}function Ko(a){return Ks.apply(this,arguments)}function Ks(){return(Ks=(0,m.Z)(function*(a){const i=Gn(`${a.uid}:::`);return a._redirectEventId=i,yield a.auth._setRedirectUser(a),yield a.auth._persistUserIfCurrent(a),i})).apply(this,arguments)}class Ui{constructor(i){this.auth=i,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(i){this.consumers.add(i),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,i)&&(this.sendToConsumer(this.queuedRedirectEvent,i),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(i){this.consumers.delete(i)}onEvent(i){if(this.hasEventBeenHandled(i))return!1;let s=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(i,l)&&(s=!0,this.sendToConsumer(i,l),this.saveEventToCache(i))}),this.hasHandledPotentialRedirect||!function Ka(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $s(a);default:return!1}}(i)||(this.hasHandledPotentialRedirect=!0,s||(this.queuedRedirectEvent=i,s=!0)),s}sendToConsumer(i,s){var l;if(i.error&&!$s(i)){const d=(null===(l=i.error.code)||void 0===l?void 0:l.split("auth/")[1])||"internal-error";s.onError(Y(this.auth,d))}else s.onAuthEvent(i)}isEventForConsumer(i,s){const l=null===s.eventId||!!i.eventId&&i.eventId===s.eventId;return s.filter.includes(i.type)&&l}hasEventBeenHandled(i){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(jo(i))}saveEventToCache(i){this.cachedEventUids.add(jo(i)),this.lastProcessedEventTime=Date.now()}}function jo(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(i=>i).join("-")}function $s({type:a,error:i}){return"unknown"===a&&"auth/no-auth-event"===i?.code}function $o(a){return Fi.apply(this,arguments)}function Fi(){return(Fi=(0,m.Z)(function*(a,i={}){return q(a,"GET","/v1/projects",i)})).apply(this,arguments)}const zs=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ys=/^https?/;function pr(){return(pr=(0,m.Z)(function*(a){if(a.config.emulator)return;const{authorizedDomains:i}=yield $o(a);for(const s of i)try{if($n(s))return}catch{}Z(a,"unauthorized-domain")})).apply(this,arguments)}function $n(a){const i=ge(),{protocol:s,hostname:l}=new URL(i);if(a.startsWith("chrome-extension://")){const R=new URL(a);return""===R.hostname&&""===l?"chrome-extension:"===s&&a.replace("chrome-extension://","")===i.replace("chrome-extension://",""):"chrome-extension:"===s&&R.hostname===l}if(!Ys.test(s))return!1;if(zs.test(a))return l===a;const d=a.replace(/\./g,"\\.");return new RegExp("^(.+\\."+d+"|"+d+")$","i").test(l)}const qs=new Se(3e4,6e4);function Js(){const a=ot().___jsl;if(a?.H)for(const i of Object.keys(a.H))if(a.H[i].r=a.H[i].r||[],a.H[i].L=a.H[i].L||[],a.H[i].r=[...a.H[i].L],a.CP)for(let s=0;s<a.CP.length;s++)a.CP[s]=null}let zn=null;const $a=new Se(5e3,15e3),qr="__/auth/iframe",Xs="emulator/auth/iframe",za={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ya=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Qa(a){const i=a.config;F(i.authDomain,a,"auth-domain-config-required");const s=i.emulator?at(i,Xs):`https://${a.config.authDomain}/${qr}`,l={apiKey:i.apiKey,appName:a.name,v:C.SDK_VERSION},d=Ya.get(a.config.apiHost);d&&(l.eid=d);const p=a._getFrameworks();return p.length&&(l.fw=p.join(",")),`${s}?${(0,S.xO)(l).slice(1)}`}function _r(){return _r=(0,m.Z)(function*(a){const i=yield function zo(a){return zn=zn||function ja(a){return new Promise((i,s)=>{var l,d,p;function R(){Js(),gapi.load("gapi.iframes",{callback:()=>{i(gapi.iframes.getContext())},ontimeout:()=>{Js(),s(Y(a,"network-request-failed"))},timeout:qs.get()})}if(null!==(d=null===(l=ot().gapi)||void 0===l?void 0:l.iframes)&&void 0!==d&&d.Iframe)i(gapi.iframes.getContext());else{if(null===(p=ot().gapi)||void 0===p||!p.load){const U=xo("iframefcb");return ot()[U]=()=>{gapi.load?R():s(Y(a,"network-request-failed"))},Do(`https://apis.google.com/js/api.js?onload=${U}`).catch(z=>s(z))}R()}}).catch(i=>{throw zn=null,i})}(a),zn}(a),s=ot().gapi;return F(s,a,"internal-error"),i.open({where:document.body,url:Qa(a),messageHandlersFilter:s.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:za,dontclear:!0},l=>new Promise(function(){var d=(0,m.Z)(function*(p,R){yield l.restyle({setHideOnLeave:!1});const U=Y(a,"network-request-failed"),z=ot().setTimeout(()=>{R(U)},$a.get());function X(){ot().clearTimeout(z),p(l)}l.ping(X).then(X,()=>{R(U)})});return function(p,R){return d.apply(this,arguments)}}()))}),_r.apply(this,arguments)}const Yo={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Qo{constructor(i){this.window=i,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const ei="__/auth/handler",ti="emulator/auth/handler";function no(a,i,s,l,d,p){F(a.config.authDomain,a,"auth-domain-config-required"),F(a.config.apiKey,a,"invalid-api-key");const R={apiKey:a.config.apiKey,appName:a.name,authType:s,redirectUrl:l,v:C.SDK_VERSION,eventId:d};if(i instanceof st){i.setDefaultLanguage(a.languageCode),R.providerId=i.providerId||"",(0,S.xb)(i.getCustomParameters())||(R.customParameters=JSON.stringify(i.getCustomParameters()));for(const[z,X]of Object.entries(p||{}))R[z]=X}if(i instanceof nr){const z=i.getScopes().filter(X=>""!==X);z.length>0&&(R.scopes=z.join(","))}a.tenantId&&(R.tid=a.tenantId);const U=R;for(const z of Object.keys(U))void 0===U[z]&&delete U[z];return`${function Ft({config:a}){return a.emulator?at(a,ti):`https://${a.authDomain}/${ei}`}(a)}?${(0,S.xO)(U).slice(1)}`}const Wi="webStorageSupport",ni=class Ja{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cn,this._completeRedirectFn=jn,this._overrideRedirectResult=Zo}_openPopup(i,s,l,d){var p=this;return(0,m.Z)(function*(){var R;Ue(null===(R=p.eventManagers[i._key()])||void 0===R?void 0:R.manager,"_initialize() not called before _openPopup()");const U=no(i,s,l,ge(),d);return function qo(a,i,s,l=500,d=600){const p=Math.max((window.screen.availHeight-d)/2,0).toString(),R=Math.max((window.screen.availWidth-l)/2,0).toString();let U="";const z=Object.assign(Object.assign({},Yo),{width:l.toString(),height:d.toString(),top:p,left:R}),X=(0,S.z$)().toLowerCase();s&&(U=M(X)?"_blank":s),E(X)&&(i=i||"http://localhost",z.scrollbars="yes");const pe=Object.entries(z).reduce((jt,[Rn,dn])=>`${jt}${Rn}=${dn},`,"");if(function Rt(a=(0,S.z$)()){var i;return Qe(a)&&!(null===(i=window.navigator)||void 0===i||!i.standalone)}(X)&&"_self"!==U)return function to(a,i){const s=document.createElement("a");s.href=a,s.target=i;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),s.dispatchEvent(l)}(i||"",U),new Qo(null);const Ze=window.open(i||"",U,pe);F(Ze,a,"popup-blocked");try{Ze.focus()}catch{}return new Qo(Ze)}(i,U,Gn())})()}_openRedirect(i,s,l,d){var p=this;return(0,m.Z)(function*(){return yield p._originValidation(i),function Ci(a){ot().location.href=a}(no(i,s,l,ge(),d)),new Promise(()=>{})})()}_initialize(i){const s=i._key();if(this.eventManagers[s]){const{manager:d,promise:p}=this.eventManagers[s];return d?Promise.resolve(d):(Ue(p,"If manager is not set, promise should be"),p)}const l=this.initAndGetManager(i);return this.eventManagers[s]={promise:l},l.catch(()=>{delete this.eventManagers[s]}),l}initAndGetManager(i){var s=this;return(0,m.Z)(function*(){const l=yield function eo(a){return _r.apply(this,arguments)}(i),d=new Ui(i);return l.register("authEvent",p=>(F(p?.authEvent,i,"invalid-auth-event"),{status:d.onEvent(p.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),s.eventManagers[i._key()]={manager:d},s.iframes[i._key()]=l,d})()}_isIframeWebStorageSupported(i,s){this.iframes[i._key()].send(Wi,{type:Wi},d=>{var p;const R=null===(p=d?.[0])||void 0===p?void 0:p[Wi];void 0!==R&&s(!!R),Z(i,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(i){const s=i._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=function Qs(a){return pr.apply(this,arguments)}(i)),this.originValidationPromises[s]}get _shouldInitProactively(){return Pt()||y()||Qe()}};class Jo{constructor(i){this.factorId=i}_process(i,s,l){switch(s.type){case"enroll":return this._finalizeEnroll(i,s.credential,l);case"signin":return this._finalizeSignIn(i,s.credential);default:return _("unexpected MultiFactorSessionType")}}}class Ct extends Jo{constructor(i){super("phone"),this.credential=i}static _fromCredential(i){return new Ct(i)}_finalizeEnroll(i,s,l){return function Ei(a,i){return q(a,"POST","/v2/accounts/mfaEnrollment:finalize",te(a,i))}(i,{idToken:s,displayName:l,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(i,s){return function Ra(a,i){return q(a,"POST","/v2/accounts/mfaSignIn:finalize",te(a,i))}(i,{mfaPendingCredential:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Xo=(()=>{class a{constructor(){}static assertion(s){return Ct._fromCredential(s)}}return a.FACTOR_ID="phone",a})();var ea="@firebase/auth";class Xa{constructor(i){this.auth=i,this.internalListeners=new Map}getUid(){var i;return this.assertAuthConfigured(),(null===(i=this.auth.currentUser)||void 0===i?void 0:i.uid)||null}getToken(i){var s=this;return(0,m.Z)(function*(){return s.assertAuthConfigured(),yield s.auth._initializationPromise,s.auth.currentUser?{accessToken:yield s.auth.currentUser.getIdToken(i)}:null})()}addAuthTokenListener(i){if(this.assertAuthConfigured(),this.internalListeners.has(i))return;const s=this.auth.onIdTokenChanged(l=>{i(l?.stsTokenManager.accessToken||null)});this.internalListeners.set(i,s),this.updateProactiveRefresh()}removeAuthTokenListener(i){this.assertAuthConfigured();const s=this.internalListeners.get(i);s&&(this.internalListeners.delete(i),s(),this.updateProactiveRefresh())}assertAuthConfigured(){F(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ri=(0,S.Pz)("authIdTokenMaxAge")||300;let io=null;const na=a=>function(){var i=(0,m.Z)(function*(s){const l=s&&(yield s.getIdTokenResult()),d=l&&((new Date).getTime()-Date.parse(l.issuedAtTime))/1e3;if(d&&d>ri)return;const p=l?.token;io!==p&&(io=p,yield fetch(a,{method:p?"POST":"DELETE",headers:p?{Authorization:`Bearer ${p}`}:{}}))});return function(s){return i.apply(this,arguments)}}();function nl(a=(0,C.getApp)()){const i=(0,C._getProvider)(a,"auth");if(i.isInitialized())return i.getImmediate();const s=function it(a,i){const s=(0,C._getProvider)(a,"auth");if(s.isInitialized()){const d=s.getImmediate(),p=s.getOptions();if((0,S.vZ)(p,i??{}))return d;Z(d,"already-initialized")}return s.initialize({options:i})}(a,{popupRedirectResolver:ni,persistence:[Rs,Is,cn]}),l=(0,S.Pz)("authTokenSyncURL");if(l){const p=na(l);(function ms(a,i,s){(0,S.m9)(a).beforeAuthStateChanged(i,s)})(s,p,()=>p(s.currentUser)),function gs(a,i,s,l){(0,S.m9)(a).onIdTokenChanged(i,s,l)}(s,R=>p(R))}const d=(0,S.q4)("auth");return d&&Er(s,`http://${d}`),s}!function tl(a){(0,C._registerComponent)(new f.wA("auth",(i,{options:s})=>{const l=i.getProvider("app").getImmediate(),d=i.getProvider("heartbeat"),{apiKey:p,authDomain:R}=l.options;return((U,z)=>{F(p&&!p.includes(":"),"invalid-api-key",{appName:U.name}),F(!R?.includes(":"),"argument-error",{appName:U.name});const X={apiKey:p,authDomain:R,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kn(a)},pe=new Hi(U,z,X);return function re(a,i){const s=i?.persistence||[],l=(Array.isArray(s)?s:[s]).map(Q);i?.errorMap&&a._updateErrorMap(i.errorMap),a._initializeWithPersistence(l,i?.popupRedirectResolver)}(pe,s),pe})(l,d)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,s,l)=>{i.getProvider("auth-internal").initialize()})),(0,C._registerComponent)(new f.wA("auth-internal",i=>{const s=dt(i.getProvider("auth").getImmediate());return new Xa(s)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,C.registerVersion)(ea,"0.21.4",function el(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(a)),(0,C.registerVersion)(ea,"0.21.4","esm2017")}("Browser")},3980:(Vt,He,A)=>{A.d(He,{r:()=>Ge});var m=A(5619),S=A(7398),C=A(940),ie=A(4664),W=A(5879),f=A(9209),ae=A(7523);const ne="/AddNewStuff.json",Oe="/AddNewCourse.json",ft="/AddNewFullCourse.json",O="/AddConfirmedCourse.json",Te="/Question.json",ce="/doctorAnswer.json",Re="/AddBlogPost.json";let Ge=(()=>{class Ye{constructor(Z,Y){this.apiService=Z,this.firebase=Y,this.dataSubject=new m.X(null)}addNewStuff(Z){return this.apiService.post(ne,Z)}addNewCourse(Z){return this.apiService.post(Oe,Z)}addNewFullCourse(Z){return this.apiService.post(ft,Z)}addBlogPost(Z){return this.apiService.post(Re,Z)}askQuestion(Z){return this.apiService.post(Te,Z)}doctorAnswer(Z){return this.apiService.post(ce,Z)}getBlogPost(){return this.apiService.get(Re).pipe((0,S.U)(Z=>{if(Z){const Y=[];for(const ye in Z)Y.push({...Z[ye],key:ye});return Y}return[]}),(0,C.d)())}getQuestions(){return this.apiService.get(Te).pipe((0,S.U)(Z=>{if(Z){const Y=[];for(const ye in Z)Y.push({...Z[ye],key:ye});return Y}return[]}))}getStuffs(){return this.apiService.get(ne).pipe((0,S.U)(Z=>{if(Z){const Y=[];for(const ye in Z)Y.push({...Z[ye],key:ye});return Y}return[]}))}getCourses(){return this.apiService.get(Oe).pipe((0,S.U)(Z=>{if(Z){const Y=[];for(const ye in Z)Y.push({...Z[ye],key:ye});return Y}return[]}))}getFullCourses(){return this.apiService.get(ft).pipe((0,S.U)(Z=>{if(Z){const Y=[];for(const ye in Z)Y.push({...Z[ye],key:ye});return Y}return[]}))}confirmFullCourse(Z){return this.apiService.post(O,Z)}getMyConfirmedCourses(){return this.apiService.get(O).pipe((0,S.U)(Z=>{if(Z){const Y=[];for(const ye in Z)Y.push({...Z[ye],key:ye});return Y}return[]}))}getDoctorAnswers(){return this.apiService.get(ce).pipe((0,S.U)(Z=>{if(Z){const Y=[];for(const ye in Z)Y.push({...Z[ye],key:ye});return Y}return[]}))}deleteStuff(Z){return this.apiService.delete("/AddNewStuff/",Z).pipe((0,ie.w)(()=>this.getStuffs().pipe((0,S.U)(Y=>(this.dataSubject.next(Y),Y)))))}deleteBlogPost(Z){return this.apiService.delete("/AddBlogPost/",Z).pipe((0,ie.w)(()=>this.getBlogPost().pipe((0,S.U)(Y=>(this.dataSubject.next(Y),Y)))))}insertStuff(Z){this.stuffList.push(Z)}getStuffList(){this.stuffList=this.firebase.list("stuff")}static#e=this.\u0275fac=function(Y){return new(Y||Ye)(W.LFG(f.s),W.LFG(ae.KQ))};static#t=this.\u0275prov=W.Yz7({token:Ye,factory:Ye.\u0275fac,providedIn:"root"})}return Ye})()},9758:(Vt,He,A)=>{A.d(He,{e:()=>tt});var m=A(5861),S=A(5879),C=A(7398),ie=A(3966),W=A(5592),f=A(9773);function ae(w){w||((0,S.gHi)(ae),w=(0,S.f3M)(S.ktI));const B=new W.y(H=>w.onDestroy(H.next.bind(H)));return H=>H.pipe((0,f.R)(B))}var xt=A(7046),Bt=A(5992),Lt=A(9209);let tt=(()=>{class w{constructor(H,K,fe){this.firebaseAuth=H,this._snackBar=K,this.apiService=fe,this.adminId="vjK5JImmJpVXFEDAud0wY7lVDq52",this.destroyRef=(0,S.f3M)(S.ktI),this.getUserIsAdmin=(0,S.tdS)(!1),this.isUserLoggedIn=(0,S.tdS)(!1),this.userState=(0,S.Flj)(this.getUserIsAdmin),this.isUserLoggedInState=(0,S.Flj)(this.isUserLoggedIn),this.userIsAdminStateLoaded$=this.getIsAdmin(),this.userIsAdminStateLoaded$.pipe(ae(this.destroyRef)).subscribe({next:le=>{const Ve=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")??""):"";this.getUserIsAdmin.update(ct=>Ve.emailVerified&&Ve.uid===this.adminId),this.isUserLoggedIn.update(ct=>Ve.emailVerified)},error:le=>{console.error(le)}})}getIsAdmin(){return this.apiService.get("/users.json").pipe((0,C.U)(H=>{if(H){const K=[];for(const fe in H)K.push({...H[fe],key:fe});return K}return[]}))}signUp(H){var K=this;return(0,m.Z)(function*(){yield K.firebaseAuth.createUserWithEmailAndPassword(H.email,H.password).then(fe=>{localStorage.setItem("user",JSON.stringify(fe.user))})})()}signIn(H,K){var fe=this;return(0,m.Z)(function*(){yield fe.firebaseAuth.signInWithEmailAndPassword(H,K).then(le=>{le.user.emailVerified?(localStorage.setItem("user",JSON.stringify(le.user)),fe.getUserIsAdmin.update(Ve=>le.user.emailVerified&&le.user.uid==fe.adminId),fe.isUserLoggedIn.update(Ve=>le.user.emailVerified)):(fe._snackBar.openFromComponent(ie.w,{duration:2e3,data:{message:"\u10d0\u10d5\u10e2\u10dd\u10e0\u10d8\u10d6\u10d0\u10ea\u10d8\u10d0 \u10d5\u10d4\u10e0 \u10db\u10dd\u10ee\u10d3\u10d0!",type:"error"}}),console.error("error"))})})()}logOut(){var H=this;return(0,m.Z)(function*(){H.firebaseAuth.signOut(),localStorage.clear(),H.getUserIsAdmin.update(K=>!1),H.isUserLoggedIn.update(K=>!1)})()}static#e=this.\u0275fac=function(K){return new(K||w)(S.LFG(xt.zQ),S.LFG(Bt.ux),S.LFG(Lt.s))};static#t=this.\u0275prov=S.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"})}return w})()},2959:(Vt,He,A)=>{A.d(He,{D:()=>Te});var m=A(5861),S=A(6223),C=A(8189),ie=A(5651),W=A(5879),f=A(9758),ae=A(4190),ne=A(1075),Oe=A(6005),ft=A(9548),O=A(1365);let Te=(()=>{class ce{constructor(De,Re,Ge,Ye,de,Z){this.dialogRef=De,this.data=Re,this.authService=Ge,this.fb=Ye,this.router=de,this.dialog=Z}ngOnInit(){this.initForm()}initForm(){this.form=this.fb.group({userName:new S.NI(null),password:new S.NI(null)})}onSubmit(){var De=this;return(0,m.Z)(function*(){if(!De.form.invalid){const Re=De.form.value;yield De.authService.signIn(Re.userName,Re.password).then(Ge=>{De.dialogRef.close(),De.router.navigate([""])})}})()}signUp(De){this.dialogRef.close(),this.dialog.open({signUp:{component:ie.b,width:"500px"}}[De].component,{width:"500px",panelClass:"border-16"})}static#e=this.\u0275fac=function(Re){return new(Re||ce)(W.Y36(C.so,8),W.Y36(C.WI),W.Y36(f.e),W.Y36(S.qu),W.Y36(ae.F0),W.Y36(C.uw))};static#t=this.\u0275cmp=W.Xpm({type:ce,selectors:[["app-log-in"]],decls:24,vars:22,consts:[[3,"formGroup","ngSubmit"],["appearance","outline"],["matInput","","formControlName","userName",3,"placeholder"],["matInput","","formControlName","password","type","password",3,"placeholder"],[2,"margin-bottom","5px","cursor","pointer",3,"click"],["type","submit","mat-raised-button","","color","primary"]],template:function(Re,Ge){1&Re&&(W.TgZ(0,"form",0),W.NdJ("ngSubmit",function(){return Ge.onSubmit()}),W.TgZ(1,"h4"),W._uU(2),W.ALo(3,"translate"),W.qZA(),W.TgZ(4,"div")(5,"mat-form-field",1)(6,"mat-label"),W._uU(7),W.ALo(8,"translate"),W.qZA(),W._UZ(9,"input",2),W.ALo(10,"translate"),W.qZA()(),W.TgZ(11,"div")(12,"mat-form-field",1)(13,"mat-label"),W._uU(14),W.ALo(15,"translate"),W.qZA(),W._UZ(16,"input",3),W.ALo(17,"translate"),W.qZA()(),W.TgZ(18,"div",4),W.NdJ("click",function(){return Ge.signUp("signUp")}),W._uU(19),W.ALo(20,"translate"),W.qZA(),W.TgZ(21,"button",5),W._uU(22),W.ALo(23,"translate"),W.qZA()()),2&Re&&(W.Q6J("formGroup",Ge.form),W.xp6(2),W.Oqu(W.lcZ(3,8,"logIn")),W.xp6(5),W.Oqu(W.lcZ(8,10,"user")),W.xp6(2),W.s9C("placeholder",W.lcZ(10,12,"user")),W.xp6(5),W.Oqu(W.lcZ(15,14,"password")),W.xp6(2),W.s9C("placeholder",W.lcZ(17,16,"password")),W.xp6(3),W.hij(" ",W.lcZ(20,18,"signUp")," "),W.xp6(3),W.Oqu(W.lcZ(23,20,"logIn")))},dependencies:[ne.lW,Oe.KE,Oe.hX,ft.Nt,S._Y,S.Fj,S.JJ,S.JL,S.sg,S.u,O.X$],styles:["form[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;text-align:center}form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}"]})}return ce})()},5651:(Vt,He,A)=>{A.d(He,{b:()=>pt});var m=A(5861),S=A(6223),C=A(8189),ie=A(1623);A(9058),A(4303),A(7879),A(4537);const Oe_email=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;var ft=A(3966),O=A(5879),Te=A(9758),ce=A(4190),It=A(5992),De=A(7046),Re=A(7523),Ge=A(6814),Ye=A(1075),de=A(6005),Z=A(9548),Y=A(1365);function ye(Q,it){1&Q&&(O.TgZ(0,"mat-error"),O._uU(1," \u10d5\u10d4\u10da\u10d8 \u10e1\u10d0\u10d5\u10d0\u10da\u10d3\u10d4\u10d1\u10e3\u10da\u10dd\u10d0 "),O.qZA())}function Ke(Q,it){1&Q&&(O.TgZ(0,"mat-error"),O._uU(1," \u10d0\u10e0\u10d0\u10e1\u10ec\u10dd\u10e0\u10d8 \u10e4\u10dd\u10e0\u10db\u10d0\u10e2\u10d8 "),O.qZA())}function rt(Q,it){if(1&Q&&(O.ynx(0),O.YNc(1,ye,2,0,"mat-error",3),O.YNc(2,Ke,2,0,"mat-error",3),O.BQk()),2&Q){const re=O.oxw();O.xp6(1),O.Q6J("ngIf",null==re.form.get("email").errors?null:re.form.get("email").errors.required),O.xp6(1),O.Q6J("ngIf",null==re.form.get("email").errors?null:re.form.get("email").errors.pattern)}}function F(Q,it){1&Q&&(O.TgZ(0,"mat-error"),O._uU(1," \u10d5\u10d4\u10da\u10d8 \u10e1\u10d0\u10d5\u10d0\u10da\u10d3\u10d4\u10d1\u10e3\u10da\u10dd\u10d0 "),O.qZA())}function _(Q,it){1&Q&&(O.TgZ(0,"mat-error"),O._uU(1," \u10de\u10d0\u10e0\u10dd\u10da\u10d8\u10e1 \u10d0\u10e0\u10d0\u10e1\u10ec\u10dd\u10e0\u10d8 \u10e4\u10dd\u10e0\u10db\u10d0\u10e2\u10d8 "),O.qZA())}function Ue(Q,it){if(1&Q&&(O.ynx(0),O.YNc(1,F,2,0,"mat-error",3),O.YNc(2,_,2,0,"mat-error",3),O.BQk()),2&Q){const re=O.oxw();let ge;O.xp6(1),O.Q6J("ngIf",null==re.form.get("password").errors?null:re.form.get("password").errors.required),O.xp6(1),O.Q6J("ngIf",null==(ge=re.form.get("password"))?null:ge.hasError("minLength"))}}let pt=(()=>{class Q{constructor(re,ge,Ce,Fe,Ne,je,Se,at){this.dialogRef=re,this.data=ge,this.authservice=Ce,this.fb=Fe,this.router=Ne,this._snackBar=je,this.afAuth=Se,this.db=at}ngOnInit(){this.initForm()}initForm(){this.form=this.fb.group({email:[null,[S.kI.required,S.kI.pattern(Oe_email)]],password:[null,[S.kI.required,S.kI.minLength(6)]]})}onSignUp(){var re=this;return(0,m.Z)(function*(){if(!re.form.invalid){const ge=re.form.value;yield re.authservice.signUp(ge),re.verifyEmail()}})()}verifyEmail(){const re=(0,ie.n)();console.log(re.currentUser),re.currentUser&&(0,ie.ab)(re.currentUser).then(()=>{this.dialogRef.close(),this.router.navigate([""]),this._snackBar.openFromComponent(ft.w,{duration:5e3,data:{message:"\u10d7\u10e5\u10d5\u10d4\u10dc\u10e1 \u10db\u10d4\u10d8\u10da\u10d6\u10d4 \u10d2\u10d0\u10d2\u10d6\u10d0\u10d5\u10dc\u10d8\u10da\u10d8\u10d0 \u10d5\u10d4\u10e0\u10d8\u10e4\u10d8\u10d9\u10d0\u10ea\u10d8\u10d8\u10e1 \u10da\u10d8\u10dc\u10d9\u10d8, \u10d2\u10d7\u10ee\u10dd\u10d5\u10d7 \u10d2\u10d0\u10ee\u10dc\u10d0\u10d7 \u10d2\u10d0\u10db\u10dd\u10d2\u10d6\u10d0\u10d5\u10dc\u10d8\u10da\u10d8 \u10da\u10d8\u10dc\u10d9\u10d8!",type:"error"}})})}static#e=this.\u0275fac=function(ge){return new(ge||Q)(O.Y36(C.so,8),O.Y36(C.WI),O.Y36(Te.e),O.Y36(S.qu),O.Y36(ce.F0),O.Y36(It.ux),O.Y36(De.zQ),O.Y36(Re.KQ))};static#t=this.\u0275cmp=O.Xpm({type:Q,selectors:[["app-sign-up"]],decls:23,vars:21,consts:[[3,"formGroup","ngSubmit"],["appearance","outline"],["matInput","","value","Sushi","formControlName","email",3,"placeholder"],[4,"ngIf"],["matInput","","formControlName","password","value","Sushi",3,"placeholder"],["type","submit","mat-raised-button","","color","primary"]],template:function(ge,Ce){if(1&ge&&(O.TgZ(0,"form",0),O.NdJ("ngSubmit",function(){return Ce.onSignUp()}),O.TgZ(1,"h4"),O._uU(2),O.ALo(3,"translate"),O.qZA(),O.TgZ(4,"div")(5,"mat-form-field",1)(6,"mat-label"),O._uU(7),O.ALo(8,"translate"),O.qZA(),O._UZ(9,"input",2),O.ALo(10,"translate"),O.qZA(),O.YNc(11,rt,3,2,"ng-container",3),O.qZA(),O.TgZ(12,"div")(13,"mat-form-field",1)(14,"mat-label"),O._uU(15),O.ALo(16,"translate"),O.qZA(),O._UZ(17,"input",4),O.ALo(18,"translate"),O.qZA(),O.YNc(19,Ue,3,2,"ng-container",3),O.qZA(),O.TgZ(20,"button",5),O._uU(21),O.ALo(22,"translate"),O.qZA()()),2&ge){let Fe,Ne;O.Q6J("formGroup",Ce.form),O.xp6(2),O.Oqu(O.lcZ(3,9,"signUp")),O.xp6(5),O.Oqu(O.lcZ(8,11,"email")),O.xp6(2),O.s9C("placeholder",O.lcZ(10,13,"email")),O.xp6(2),O.Q6J("ngIf",null==(Fe=Ce.form.get("email"))?null:Fe.dirty),O.xp6(4),O.Oqu(O.lcZ(16,15,"password")),O.xp6(2),O.s9C("placeholder",O.lcZ(18,17,"password")),O.xp6(2),O.Q6J("ngIf",null==(Ne=Ce.form.get("password"))?null:Ne.dirty),O.xp6(2),O.Oqu(O.lcZ(22,19,"signUp"))}},dependencies:[Ge.O5,Ye.lW,de.TO,de.KE,de.hX,Z.Nt,S._Y,S.Fj,S.JJ,S.JL,S.sg,S.u,Y.X$],styles:["form[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;text-align:center}form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}"]})}return Q})()},330:(Vt,He,A)=>{A.d(He,{d:()=>ne});var m=A(7398),S=A(5879),C=A(9209);const f="/CourseOrder.json",ae="/StuffOrder.json";let ne=(()=>{class Oe{constructor(O){this.apiService=O}getStuffs(){return this.apiService.get("/AddNewStuff.json").pipe((0,m.U)(O=>{if(O){const Te=[];for(const ce in O)Te.push({...O[ce],key:ce});return Te}return[]}))}getCourses(){return this.apiService.get("/AddNewCourse.json").pipe((0,m.U)(O=>{if(O){const Te=[];for(const ce in O)Te.push({...O[ce],key:ce});return Te}return[]}))}buyCourse(O){return this.apiService.post(f,O)}buyStuff(O){return this.apiService.post(ae,O)}getOrderedCourse(){return this.apiService.get(f).pipe((0,m.U)(O=>{if(O){const Te=[];for(const ce in O)Te.push({...O[ce],key:ce});return Te}return[]}))}getOrderedStuff(){return this.apiService.get(ae).pipe((0,m.U)(O=>{if(O){const Te=[];for(const ce in O)Te.push({...O[ce],key:ce});return Te}return[]}))}static#e=this.\u0275fac=function(Te){return new(Te||Oe)(S.LFG(C.s))};static#t=this.\u0275prov=S.Yz7({token:Oe,factory:Oe.\u0275fac,providedIn:"root"})}return Oe})()},3966:(Vt,He,A)=>{A.d(He,{w:()=>ie});var m=A(5992),S=A(5879),C=A(6814);let ie=(()=>{class W{constructor(ae){this.data=ae}ngOnInit(){this.message=this.data.message}alertMode(){return"error"===this.data.type?"error":"success"}static#e=this.\u0275fac=function(ne){return new(ne||W)(S.Y36(m.qD))};static#t=this.\u0275cmp=S.Xpm({type:W,selectors:[["app-alert"]],decls:2,vars:2,consts:[[3,"ngClass"]],template:function(ne,Oe){1&ne&&(S.TgZ(0,"div",0),S._uU(1),S.qZA()),2&ne&&(S.Q6J("ngClass",Oe.alertMode()),S.xp6(1),S.hij(" ",Oe.message,"\n"))},dependencies:[C.mk],styles:[".success[_ngcontent-%COMP%]{color:#99eb99}.error[_ngcontent-%COMP%]{color:#e47a7a}"]})}return W})()},7694:(Vt,He,A)=>{A.d(He,{$:()=>at});var m=A(7394),S=A(9315),C=A(940),ie=A(2959),W=A(5651),f=A(5879),ae=A(4190),ne=A(8189),Oe=A(1365),ft=A(9758),O=A(4310),Te=A(330),ce=A(3980),It=A(6814),De=A(6223),Re=A(1075),Ge=A(7841),Ye=A(2916);const de=function(){return["/logOut"]};function Z(J,We){if(1&J){const j=f.EpF();f.TgZ(0,"button",17),f.NdJ("click",function(){f.CHM(j);const q=f.oxw();return f.KtG(q.onLogOut())}),f._uU(1),f.ALo(2,"translate"),f.qZA()}2&J&&(f.Q6J("routerLink",f.DdM(4,de)),f.xp6(1),f.hij(" ",f.lcZ(2,2,"logOut")," "))}const Y=function(){return["/signUp"]};function ye(J,We){if(1&J){const j=f.EpF();f.TgZ(0,"button",17),f.NdJ("click",function(){f.CHM(j);const q=f.oxw();return f.KtG(q.loginSignUp("signUp"))}),f._uU(1),f.ALo(2,"translate"),f.qZA()}2&J&&(f.Q6J("routerLink",f.DdM(4,Y)),f.xp6(1),f.hij(" ",f.lcZ(2,2,"signUp")," "))}const Ke=function(){return["/logIn"]};function rt(J,We){if(1&J){const j=f.EpF();f.TgZ(0,"button",17),f.NdJ("click",function(){f.CHM(j);const q=f.oxw();return f.KtG(q.loginSignUp("logIn"))}),f._uU(1),f.ALo(2,"translate"),f.qZA()}2&J&&(f.Q6J("routerLink",f.DdM(4,Ke)),f.xp6(1),f.hij(" ",f.lcZ(2,2,"logIn")," "))}function F(J,We){if(1&J&&f._UZ(0,"span",20),2&J){const j=f.oxw(3);f.Q6J("matBadge",j.generalNotification)}}function _(J,We){if(1&J&&(f.TgZ(0,"button",19),f._uU(1),f.ALo(2,"translate"),f.YNc(3,F,1,1,"span",13),f.qZA()),2&J){const j=f.oxw(2),te=f.MAs(33);f.Q6J("matMenuTriggerFor",te),f.xp6(1),f.hij(" ",f.lcZ(2,3,"admin")," "),f.xp6(2),f.Q6J("ngIf",j.generalNotification)}}function Ue(J,We){if(1&J&&f._UZ(0,"span",20),2&J){const j=f.oxw(3);f.Q6J("matBadge",j.generalNotification)}}function pt(J,We){if(1&J&&(f.TgZ(0,"button",19),f._uU(1),f.ALo(2,"translate"),f.YNc(3,Ue,1,1,"span",13),f.qZA()),2&J){const j=f.oxw(2),te=f.MAs(66);f.Q6J("matMenuTriggerFor",te),f.xp6(1),f.hij(" ",f.lcZ(2,3,"my_page")," "),f.xp6(2),f.Q6J("ngIf",j.generalNotification)}}function Q(J,We){if(1&J&&(f.ynx(0),f.YNc(1,_,4,5,"button",18),f.YNc(2,pt,4,5,"button",18),f.BQk()),2&J){const j=f.oxw();f.xp6(1),f.Q6J("ngIf",j.userState()),f.xp6(1),f.Q6J("ngIf",!j.userState())}}function it(J,We){if(1&J&&f._UZ(0,"span",20),2&J){const j=f.oxw();f.Q6J("matBadge",null==j.orderedCourses?null:j.orderedCourses.length)}}function re(J,We){if(1&J&&f._UZ(0,"span",20),2&J){const j=f.oxw();f.Q6J("matBadge",null==j.orderedItems?null:j.orderedItems.length)}}function ge(J,We){if(1&J&&f._UZ(0,"span",20),2&J){const j=f.oxw();f.Q6J("matBadge",null==j.contact?null:j.contact.length)}}const Ce=function(){return["/lending"]},Fe=function(){return["/courses"]},Ne=function(){return["/shop"]},je=function(){return["/blog"]},Se=function(){return["/contact"]};let at=(()=>{class J{constructor(j,te,q,me,$e,Xe,Ae){this.route=j,this.dialog=te,this.translate=q,this.authService=me,this.languageService=$e,this.shopService=Xe,this.adminHttp=Ae,this.prise=15,this.subscriobtion$=new m.w0,this.userState=this.authService.userState,this.isUserLoggedInState=this.authService.isUserLoggedInState,this.authActions=[],this.adminBtns=[],this.userWorldBtns=[],this.pageName=this.route.snapshot.data.pageName}ngOnInit(){this.languageService.setLanguage(),this.selectedLang=this.languageService.defaultLang,this.returnNotifications()}returnNotifications(){this.observable$=(0,S.D)({orderedCourses:this.shopService.getOrderedCourse(),orderedItems:this.shopService.getOrderedStuff(),contact:this.adminHttp.getQuestions()}).pipe((0,C.d)()),this.subscriobtion$=this.observable$.subscribe(j=>{console.log(j),this.orderedCourses=j.orderedCourses,this.orderedItems=j.orderedItems,this.contact=j.contact,this.commonNotifications(j)})}commonNotifications(j){let te=[],q=[j.orderedCourses,j.orderedItems,j.contact];for(const me of q){for(const $e of me)te.push($e);this.generalNotification=te?.length}}ngOnDestroy(){this.subscriobtion$.unsubscribe()}onLogOut(){this.authService.logOut()}changeLang(j){localStorage.setItem("lang",j.value),this.translate.use(j.value)}loginSignUp(j){this.dialog.open({logIn:{component:ie.D,width:"500px"},signUp:{component:W.b,width:"500px"}}[j].component,{width:"500px",panelClass:"border-16"})}static#e=this.\u0275fac=function(te){return new(te||J)(f.Y36(ae.gz),f.Y36(ne.uw),f.Y36(Oe.sK),f.Y36(ft.e),f.Y36(O.T),f.Y36(Te.d),f.Y36(ce.r))};static#t=this.\u0275cmp=f.Xpm({type:J,selectors:[["app-layout"]],decls:78,vars:83,consts:[[1,"navbar-content"],[1,"navbar-inner"],[1,"navbar-title"],[1,"navbar-navigation"],[1,"navigation-inner"],["mat-button","",3,"routerLink"],[3,"ngModel","change","ngModelChange"],["value","ka",3,"selected"],["value","en",3,"selected"],["mat-button","",3,"routerLink","click",4,"ngIf"],[4,"ngIf"],["adminMenu","matMenu"],["mat-menu-item","",3,"routerLink"],["matBadgeColor","warn",3,"matBadge",4,"ngIf"],["simpleUser","matMenu"],[1,"page-name"],[1,"page-container"],["mat-button","",3,"routerLink","click"],["mat-button","",3,"matMenuTriggerFor",4,"ngIf"],["mat-button","",3,"matMenuTriggerFor"],["matBadgeColor","warn",3,"matBadge"]],template:function(te,q){1&te&&(f.TgZ(0,"div",0)(1,"div",1)(2,"div",2),f._uU(3),f.ALo(4,"translate"),f.qZA(),f.TgZ(5,"div",3)(6,"div",4)(7,"button",5),f._uU(8),f.ALo(9,"translate"),f.qZA(),f.TgZ(10,"button",5),f._uU(11),f.ALo(12,"translate"),f.qZA(),f.TgZ(13,"button",5),f._uU(14),f.ALo(15,"translate"),f.qZA(),f.TgZ(16,"button",5),f._uU(17),f.ALo(18,"translate"),f.qZA(),f.TgZ(19,"button",5),f._uU(20),f.ALo(21,"translate"),f.qZA(),f.TgZ(22,"span")(23,"select",6),f.NdJ("change",function($e){return q.changeLang($e.target)})("ngModelChange",function($e){return q.selectedLang=$e}),f.TgZ(24,"option",7),f._uU(25,"KA"),f.qZA(),f.TgZ(26,"option",8),f._uU(27,"ENG"),f.qZA()(),f.YNc(28,Z,3,5,"button",9),f.YNc(29,ye,3,5,"button",9),f.YNc(30,rt,3,5,"button",9),f.YNc(31,Q,3,2,"ng-container",10),f.TgZ(32,"mat-menu",null,11),f.ynx(34),f.TgZ(35,"button",12),f._uU(36),f.ALo(37,"translate"),f.YNc(38,it,1,1,"span",13),f.qZA(),f.TgZ(39,"button",12),f._uU(40),f.ALo(41,"translate"),f.YNc(42,re,1,1,"span",13),f.qZA(),f.TgZ(43,"button",12),f._uU(44),f.ALo(45,"translate"),f.qZA(),f.TgZ(46,"button",12),f._uU(47),f.ALo(48,"translate"),f.YNc(49,ge,1,1,"span",13),f.qZA(),f.TgZ(50,"button",12),f._uU(51),f.ALo(52,"translate"),f.qZA(),f.TgZ(53,"button",12),f._uU(54),f.ALo(55,"translate"),f.qZA(),f.TgZ(56,"button",12),f._uU(57),f.ALo(58,"translate"),f.qZA(),f.TgZ(59,"button",12),f._uU(60),f.ALo(61,"translate"),f.qZA(),f.TgZ(62,"button",12),f._uU(63),f.ALo(64,"translate"),f.qZA(),f.BQk(),f.qZA(),f.TgZ(65,"mat-menu",null,14),f.ynx(67),f.TgZ(68,"button",12),f._uU(69),f.ALo(70,"translate"),f.qZA(),f.TgZ(71,"button",12),f._uU(72),f.ALo(73,"translate"),f.qZA(),f.BQk(),f.qZA()()()()(),f.TgZ(74,"div",15),f._uU(75),f.qZA(),f.TgZ(76,"div",16),f._UZ(77,"router-outlet"),f.qZA()()),2&te&&(f.xp6(3),f.hij(" ",f.lcZ(4,44,"headerTitle")," "),f.xp6(4),f.Q6J("routerLink",f.DdM(78,Ce)),f.xp6(1),f.hij(" ",f.lcZ(9,46,"home")," "),f.xp6(2),f.Q6J("routerLink",f.DdM(79,Fe)),f.xp6(1),f.hij(" ",f.lcZ(12,48,"courses")," "),f.xp6(2),f.Q6J("routerLink",f.DdM(80,Ne)),f.xp6(1),f.hij(" ",f.lcZ(15,50,"shop")," "),f.xp6(2),f.Q6J("routerLink",f.DdM(81,je)),f.xp6(1),f.hij(" ",f.lcZ(18,52,"blog")," "),f.xp6(2),f.Q6J("routerLink",f.DdM(82,Se)),f.xp6(1),f.hij(" ",f.lcZ(21,54,"contact")," "),f.xp6(3),f.Q6J("ngModel",q.selectedLang),f.xp6(1),f.Q6J("selected","ka"==q.lang),f.xp6(2),f.Q6J("selected","en"==q.lang),f.xp6(2),f.Q6J("ngIf",q.isUserLoggedInState()),f.xp6(1),f.Q6J("ngIf",!q.isUserLoggedInState()),f.xp6(1),f.Q6J("ngIf",!q.isUserLoggedInState()),f.xp6(1),f.Q6J("ngIf",q.isUserLoggedInState()),f.xp6(4),f.Q6J("routerLink","/admin/admin-courses"),f.xp6(1),f.hij(" ",f.lcZ(37,56,"ordered_courses")," "),f.xp6(2),f.Q6J("ngIf",null==q.orderedCourses?null:q.orderedCourses.length),f.xp6(1),f.Q6J("routerLink","/admin/admin-pregnancy"),f.xp6(1),f.hij(" ",f.lcZ(41,58,"ordered_pregnancy_stuff")," "),f.xp6(2),f.Q6J("ngIf",null==q.orderedItems?null:q.orderedItems.length),f.xp6(1),f.Q6J("routerLink","/admin/admin-message"),f.xp6(1),f.hij(" ",f.lcZ(45,60,"customer_message")," "),f.xp6(2),f.Q6J("routerLink","/admin/admin-contact"),f.xp6(1),f.hij(" ",f.lcZ(48,62,"contact")," "),f.xp6(2),f.Q6J("ngIf",null==q.contact?null:q.contact.length),f.xp6(1),f.Q6J("routerLink","/admin/admin-message"),f.xp6(1),f.hij(" ",f.lcZ(52,64,"Patient_appointment")," "),f.xp6(2),f.Q6J("routerLink","/admin/admin-home"),f.xp6(1),f.hij(" ",f.lcZ(55,66,"home")," "),f.xp6(2),f.Q6J("routerLink","/admin/admin-about"),f.xp6(1),f.hij(" ",f.lcZ(58,68,"about")," "),f.xp6(2),f.Q6J("routerLink","/admin/admin-shop"),f.xp6(1),f.hij(" ",f.lcZ(61,70,"shop")," "),f.xp6(2),f.Q6J("routerLink","/admin/admin-blog"),f.xp6(1),f.hij(" ",f.lcZ(64,72,"blog")," "),f.xp6(5),f.Q6J("routerLink","/my-courses"),f.xp6(1),f.hij(" ",f.lcZ(70,74,"user_courses")," "),f.xp6(2),f.Q6J("routerLink","/my-communication"),f.xp6(1),f.hij(" ",f.lcZ(73,76,"user_communications")," "),f.xp6(3),f.hij("",q.pageName," >"))},dependencies:[It.O5,ae.lC,ae.rH,De.YN,De.Kr,De.EJ,De.JJ,De.On,Re.lW,Ge.k,Ye.VK,Ye.OP,Ye.p6,Oe.X$],styles:[".navbar-content[_ngcontent-%COMP%]{height:100%;position:relative}.navbar-content[_ngcontent-%COMP%]   .page-name[_ngcontent-%COMP%]{padding:20px}.navbar-content[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]{width:90%;margin:0 auto}.navbar-content[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:fixed;left:0;bottom:0;width:100%;height:200px;background-color:#fff;padding:20px;border:1px solid rgb(194,228,246)}.navbar-title[_ngcontent-%COMP%]{background-color:#c2e4f6;color:#000;text-align:center;width:100%;padding:10px 0}.navbar-navigation[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%}.navbar-navigation[_ngcontent-%COMP%]   .navigation-inner[_ngcontent-%COMP%]{padding:20px;background-color:#fff;width:100%}.navbar-navigation[_ngcontent-%COMP%]   .navigation-inner[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{float:right}.navbar-navigation[_ngcontent-%COMP%]   .navigation-inner[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:16px}"]})}return J})()},9209:(Vt,He,A)=>{A.d(He,{s:()=>ie});var m=A(9862),S=A(553),C=A(5879);let ie=(()=>{class W{constructor(ae){this.http=ae}get(ae){let ne=new m.LE;return this.http.get(`${S.N.apiUrl}${ae}`,{params:ne})}post(ae,ne){return this.http.post(`${S.N.apiUrl}${ae}`,ne)}put(ae,ne){return this.http.put(`${S.N.apiUrl}${ae}`,ne)}delete(ae,ne){return this.http.delete(`${S.N.apiUrl}${ae}/${ne}.json`)}static#e=this.\u0275fac=function(ne){return new(ne||W)(C.LFG(m.eN))};static#t=this.\u0275prov=C.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"})}return W})()},4310:(Vt,He,A)=>{A.d(He,{T:()=>ie});var m=A(5619),S=A(5879),C=A(1365);let ie=(()=>{class W{constructor(ae){this.translate=ae,this.language=new m.X("")}get defaultLang(){return this.language.value}setLanguage(){const ae=localStorage.getItem("lang");return ae?(this.translate.use(ae),this.language.next(ae)):(this.translate.setDefaultLang("ka"),this.language.next("ka"))}static#e=this.\u0275fac=function(ne){return new(ne||W)(S.LFG(C.sK))};static#t=this.\u0275prov=S.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"})}return W})()},6365:(Vt,He,A)=>{A.r(He);var m=A(5861),S=A(3106),C=A(1623),ie=A(9058),ae=(A(4303),A(7879),A(4537));function ne(){return window}function O(){return O=(0,m.Z)(function*(b,E,y){var M;const{BuildInfo:G}=ne();(0,C.ap)(E.sessionId,"AuthEvent did not contain a session ID");const oe=yield function Ye(b){return de.apply(this,arguments)}(E.sessionId),Ie={};return(0,C.aq)()?Ie.ibi=G.packageName:(0,C.ar)()?Ie.apn=G.packageName:(0,C.as)(b,"operation-not-supported-in-this-environment"),G.displayName&&(Ie.appDisplayName=G.displayName),Ie.sessionId=oe,(0,C.at)(b,y,E.type,void 0,null!==(M=E.eventId)&&void 0!==M?M:void 0,Ie)}),O.apply(this,arguments)}function ce(){return(ce=(0,m.Z)(function*(b){const{BuildInfo:E}=ne(),y={};(0,C.aq)()?y.iosBundleId=E.packageName:(0,C.ar)()?y.androidPackageName=E.packageName:(0,C.as)(b,"operation-not-supported-in-this-environment"),yield(0,C.au)(b,y)})).apply(this,arguments)}function Re(){return(Re=(0,m.Z)(function*(b,E,y){const{cordova:M}=ne();let G=()=>{};try{yield new Promise((oe,Ie)=>{let Pe=null;function Qe(){var Ee;oe();const Pt=null===(Ee=M.plugins.browsertab)||void 0===Ee?void 0:Ee.close;"function"==typeof Pt&&Pt(),"function"==typeof y?.close&&y.close()}function mt(){Pe||(Pe=window.setTimeout(()=>{Ie((0,C.aw)(b,"redirect-cancelled-by-user"))},2e3))}function Rt(){"visible"===document?.visibilityState&&mt()}E.addPassiveListener(Qe),document.addEventListener("resume",mt,!1),(0,C.ar)()&&document.addEventListener("visibilitychange",Rt,!1),G=()=>{E.removePassiveListener(Qe),document.removeEventListener("resume",mt,!1),document.removeEventListener("visibilitychange",Rt,!1),Pe&&window.clearTimeout(Pe)}})}finally{G()}})).apply(this,arguments)}function de(){return(de=(0,m.Z)(function*(b){const E=function Z(b){if((0,C.ap)(/[0-9a-zA-Z]+/.test(b),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(b);const E=new ArrayBuffer(b.length),y=new Uint8Array(E);for(let M=0;M<b.length;M++)y[M]=b.charCodeAt(M);return y}(b),y=yield crypto.subtle.digest("SHA-256",E);return Array.from(new Uint8Array(y)).map(G=>G.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class ye extends C.ay{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(E=>{this.resolveInialized=E})}addPassiveListener(E){this.passiveListeners.add(E)}removePassiveListener(E){this.passiveListeners.delete(E)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(E){return this.resolveInialized(),this.passiveListeners.forEach(y=>y(E)),super.onEvent(E)}initialized(){var E=this;return(0,m.Z)(function*(){yield E.initPromise})()}}function F(b){return _.apply(this,arguments)}function _(){return(_=(0,m.Z)(function*(b){const E=yield Q()._get(it(b));return E&&(yield Q()._remove(it(b))),E})).apply(this,arguments)}function pt(){const b=[];for(let y=0;y<20;y++){const M=Math.floor(62*Math.random());b.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(M))}return b.join("")}function Q(){return(0,C.az)(C.b)}function it(b){return(0,C.aA)("authEvent",b.config.apiKey,b.name)}function Ce(b){if(!b?.includes("?"))return{};const[E,...y]=b.split("?");return(0,ie.zd)(y.join("?"))}const je=class Ne{constructor(){this._redirectPersistence=C.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=C.aB,this._overrideRedirectResult=C.aC}_initialize(E){var y=this;return(0,m.Z)(function*(){const M=E._key();let G=y.eventManagers.get(M);return G||(G=new ye(E),y.eventManagers.set(M,G),y.attachCallbackListeners(E,G)),G})()}_openPopup(E){(0,C.as)(E,"operation-not-supported-in-this-environment")}_openRedirect(E,y,M,G){var oe=this;return(0,m.Z)(function*(){!function Ge(b){var E,y,M,G,oe,Ie,Pe,Qe,mt,Rt;const Ee=ne();(0,C.ax)("function"==typeof(null===(E=Ee?.universalLinks)||void 0===E?void 0:E.subscribe),b,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,C.ax)(typeof(null===(y=Ee?.BuildInfo)||void 0===y?void 0:y.packageName)<"u",b,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,C.ax)("function"==typeof(null===(oe=null===(G=null===(M=Ee?.cordova)||void 0===M?void 0:M.plugins)||void 0===G?void 0:G.browsertab)||void 0===oe?void 0:oe.openUrl),b,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,C.ax)("function"==typeof(null===(Qe=null===(Pe=null===(Ie=Ee?.cordova)||void 0===Ie?void 0:Ie.plugins)||void 0===Pe?void 0:Pe.browsertab)||void 0===Qe?void 0:Qe.isAvailable),b,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,C.ax)("function"==typeof(null===(Rt=null===(mt=Ee?.cordova)||void 0===mt?void 0:mt.InAppBrowser)||void 0===Rt?void 0:Rt.open),b,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(E);const Ie=yield oe._initialize(E);yield Ie.initialized(),Ie.resetRedirect(),(0,C.aD)(),yield oe._originValidation(E);const Pe=function Ke(b,E,y=null){return{type:E,eventId:y,urlResponse:null,sessionId:pt(),postBody:null,tenantId:b.tenantId,error:(0,C.aw)(b,"no-auth-event")}}(E,M,G);yield function rt(b,E){return Q()._set(it(b),E)}(E,Pe);const Qe=yield function ft(b,E,y){return O.apply(this,arguments)}(E,Pe,y),mt=yield function It(b){const{cordova:E}=ne();return new Promise(y=>{E.plugins.browsertab.isAvailable(M=>{let G=null;M?E.plugins.browsertab.openUrl(b):G=E.InAppBrowser.open(b,(0,C.av)()?"_blank":"_system","location=yes"),y(G)})})}(Qe);return function De(b,E,y){return Re.apply(this,arguments)}(E,Ie,mt)})()}_isIframeWebStorageSupported(E,y){throw new Error("Method not implemented.")}_originValidation(E){const y=E._key();return this.originValidationPromises[y]||(this.originValidationPromises[y]=function Te(b){return ce.apply(this,arguments)}(E)),this.originValidationPromises[y]}attachCallbackListeners(E,y){const{universalLinks:M,handleOpenURL:G,BuildInfo:oe}=ne(),Ie=setTimeout((0,m.Z)(function*(){yield F(E),y.onEvent(Se())}),500),Pe=function(){var Rt=(0,m.Z)(function*(Ee){clearTimeout(Ie);const Pt=yield F(E);let _n=null;Pt&&Ee?.url&&(_n=function Ue(b,E){var y,M;const G=function ge(b){const E=Ce(b),y=E.link?decodeURIComponent(E.link):void 0,M=Ce(y).link,G=E.deep_link_id?decodeURIComponent(E.deep_link_id):void 0;return Ce(G).link||G||M||y||b}(E);if(G.includes("/__/auth/callback")){const oe=Ce(G),Ie=oe.firebaseError?function re(b){try{return JSON.parse(b)}catch{return null}}(decodeURIComponent(oe.firebaseError)):null,Pe=null===(M=null===(y=Ie?.code)||void 0===y?void 0:y.split("auth/"))||void 0===M?void 0:M[1],Qe=Pe?(0,C.aw)(Pe):null;return Qe?{type:b.type,eventId:b.eventId,tenantId:b.tenantId,error:Qe,urlResponse:null,sessionId:null,postBody:null}:{type:b.type,eventId:b.eventId,tenantId:b.tenantId,sessionId:b.sessionId,urlResponse:G,postBody:null}}return null}(Pt,Ee.url)),y.onEvent(_n||Se())});return function(Pt){return Rt.apply(this,arguments)}}();typeof M<"u"&&"function"==typeof M.subscribe&&M.subscribe(null,Pe);const Qe=G,mt=`${oe.packageName.toLowerCase()}://`;ne().handleOpenURL=function(){var Rt=(0,m.Z)(function*(Ee){if(Ee.toLowerCase().startsWith(mt)&&Pe({url:Ee}),"function"==typeof Qe)try{Qe(Ee)}catch(Pt){console.error(Pt)}});return function(Ee){return Rt.apply(this,arguments)}}()}};function Se(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,C.aw)("no-auth-event")}}function te(){var b;return(null===(b=self?.location)||void 0===b?void 0:b.protocol)||null}function me(b=(0,ie.z$)()){return!("file:"!==te()&&"ionic:"!==te()&&"capacitor:"!==te()||!b.toLowerCase().match(/iphone|ipad|ipod|android/))}function bt(){try{const b=self.localStorage,E=C.aI();if(b)return b.setItem(E,"1"),b.removeItem(E),!function Le(b=(0,ie.z$)()){return function Xe(){return(0,ie.w1)()&&11===document?.documentMode}()||function Ae(b=(0,ie.z$)()){return/Edge\/\d+/.test(b)}(b)}()||(0,ie.hl)()}catch{return ht()&&(0,ie.hl)()}return!1}function ht(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function we(){return(function q(){return"http:"===te()||"https:"===te()}()||(0,ie.ru)()||me())&&!function $e(){return(0,ie.b$)()||(0,ie.UG)()}()&&bt()&&!ht()}function ze(){return me()&&typeof document<"u"}function _t(){return(_t=(0,m.Z)(function*(){return!!ze()&&new Promise(b=>{const E=setTimeout(()=>{b(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(E),b(!0)})})})).apply(this,arguments)}const et={LOCAL:"local",NONE:"none",SESSION:"session"},Et=C.ax,kt="persistence";function zt(b){return xt.apply(this,arguments)}function xt(){return(xt=(0,m.Z)(function*(b){yield b._initializationPromise;const E=Lt(),y=C.aA(kt,b.config.apiKey,b.name);E&&E.setItem(y,b._getPersistence())})).apply(this,arguments)}function Lt(){var b;try{return(null===(b=function Dt(){return typeof window<"u"?window:null}())||void 0===b?void 0:b.sessionStorage)||null}catch{return null}}const sn=C.ax;class tt{constructor(){this.browserResolver=C.az(C.k),this.cordovaResolver=C.az(je),this.underlyingResolver=null,this._redirectPersistence=C.a,this._completeRedirectFn=C.aB,this._overrideRedirectResult=C.aC}_initialize(E){var y=this;return(0,m.Z)(function*(){return yield y.selectUnderlyingResolver(),y.assertedUnderlyingResolver._initialize(E)})()}_openPopup(E,y,M,G){var oe=this;return(0,m.Z)(function*(){return yield oe.selectUnderlyingResolver(),oe.assertedUnderlyingResolver._openPopup(E,y,M,G)})()}_openRedirect(E,y,M,G){var oe=this;return(0,m.Z)(function*(){return yield oe.selectUnderlyingResolver(),oe.assertedUnderlyingResolver._openRedirect(E,y,M,G)})()}_isIframeWebStorageSupported(E,y){this.assertedUnderlyingResolver._isIframeWebStorageSupported(E,y)}_originValidation(E){return this.assertedUnderlyingResolver._originValidation(E)}get _shouldInitProactively(){return ze()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return sn(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var E=this;return(0,m.Z)(function*(){if(E.underlyingResolver)return;const y=yield function xe(){return _t.apply(this,arguments)}();E.underlyingResolver=y?E.cordovaResolver:E.browserResolver})()}}function w(b){return b.unwrap()}function H(b){return fe(b)}function fe(b){const{_tokenResponse:E}=b instanceof ie.ZR?b.customData:b;if(!E)return null;if(!(b instanceof ie.ZR)&&"temporaryProof"in E&&"phoneNumber"in E)return C.P.credentialFromResult(b);const y=E.providerId;if(!y||y===C.o.PASSWORD)return null;let M;switch(y){case C.o.GOOGLE:M=C.Q;break;case C.o.FACEBOOK:M=C.N;break;case C.o.GITHUB:M=C.T;break;case C.o.TWITTER:M=C.W;break;default:const{oauthIdToken:G,oauthAccessToken:oe,oauthTokenSecret:Ie,pendingToken:Pe,nonce:Qe}=E;return oe||Ie||G||Pe?Pe?y.startsWith("saml.")?C.aL._create(y,Pe):C.J._fromParams({providerId:y,signInMethod:y,pendingToken:Pe,idToken:G,accessToken:oe}):new C.U(y).credential({idToken:G,accessToken:oe,rawNonce:Qe}):null}return b instanceof ie.ZR?M.credentialFromError(b):M.credentialFromResult(b)}function le(b,E){return E.catch(y=>{throw y instanceof ie.ZR&&function K(b,E){var y;const M=null===(y=E.customData)||void 0===y?void 0:y._tokenResponse;if("auth/multi-factor-auth-required"===E?.code)E.resolver=new Yt(b,C.an(b,E));else if(M){const G=fe(E),oe=E;G&&(oe.credential=G,oe.tenantId=M.tenantId||void 0,oe.email=M.email||void 0,oe.phoneNumber=M.phoneNumber||void 0)}}(b,y),y}).then(y=>{const G=y.user;return{operationType:y.operationType,credential:H(y),additionalUserInfo:C.al(y),user:wt.getOrCreate(G)}})}function Ve(b,E){return ct.apply(this,arguments)}function ct(){return(ct=(0,m.Z)(function*(b,E){const y=yield E;return{verificationId:y.verificationId,confirm:M=>le(b,y.confirm(M))}})).apply(this,arguments)}class Yt{constructor(E,y){this.resolver=y,this.auth=function B(b){return b.wrapped()}(E)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(E){return le(w(this.auth),this.resolver.resolveSignIn(E))}}class wt{constructor(E){this._delegate=E,this.multiFactor=C.ao(E)}static getOrCreate(E){return wt.USER_MAP.has(E)||wt.USER_MAP.set(E,new wt(E)),wt.USER_MAP.get(E)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(E){return this._delegate.getIdTokenResult(E)}getIdToken(E){return this._delegate.getIdToken(E)}linkAndRetrieveDataWithCredential(E){return this.linkWithCredential(E)}linkWithCredential(E){var y=this;return(0,m.Z)(function*(){return le(y.auth,C.Z(y._delegate,E))})()}linkWithPhoneNumber(E,y){var M=this;return(0,m.Z)(function*(){return Ve(M.auth,C.l(M._delegate,E,y))})()}linkWithPopup(E){var y=this;return(0,m.Z)(function*(){return le(y.auth,C.d(y._delegate,E,tt))})()}linkWithRedirect(E){var y=this;return(0,m.Z)(function*(){return yield zt(C.aE(y.auth)),C.g(y._delegate,E,tt)})()}reauthenticateAndRetrieveDataWithCredential(E){return this.reauthenticateWithCredential(E)}reauthenticateWithCredential(E){var y=this;return(0,m.Z)(function*(){return le(y.auth,C._(y._delegate,E))})()}reauthenticateWithPhoneNumber(E,y){return Ve(this.auth,C.r(this._delegate,E,y))}reauthenticateWithPopup(E){return le(this.auth,C.e(this._delegate,E,tt))}reauthenticateWithRedirect(E){var y=this;return(0,m.Z)(function*(){return yield zt(C.aE(y.auth)),C.h(y._delegate,E,tt)})()}sendEmailVerification(E){return C.ab(this._delegate,E)}unlink(E){var y=this;return(0,m.Z)(function*(){return yield C.ak(y._delegate,E),y})()}updateEmail(E){return C.ag(this._delegate,E)}updatePassword(E){return C.ah(this._delegate,E)}updatePhoneNumber(E){return C.u(this._delegate,E)}updateProfile(E){return C.af(this._delegate,E)}verifyBeforeUpdateEmail(E,y){return C.ac(this._delegate,E,y)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}wt.USER_MAP=new WeakMap;const Qt=C.ax;let on=(()=>{class b{constructor(y,M){if(this.app=y,M.isInitialized())return this._delegate=M.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:G}=y.options;Qt(G,"invalid-api-key",{appName:y.name}),Qt(G,"invalid-api-key",{appName:y.name});const oe=typeof window<"u"?tt:void 0;this._delegate=M.initialize({options:{persistence:Tt(G,y.name),popupRedirectResolver:oe}}),this._delegate._updateErrorMap(C.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?wt.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(y){this._delegate.languageCode=y}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(y){this._delegate.tenantId=y}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(y,M){C.G(this._delegate,y,M)}applyActionCode(y){return C.a2(this._delegate,y)}checkActionCode(y){return C.a3(this._delegate,y)}confirmPasswordReset(y,M){return C.a1(this._delegate,y,M)}createUserWithEmailAndPassword(y,M){var G=this;return(0,m.Z)(function*(){return le(G._delegate,C.a5(G._delegate,y,M))})()}fetchProvidersForEmail(y){return this.fetchSignInMethodsForEmail(y)}fetchSignInMethodsForEmail(y){return C.aa(this._delegate,y)}isSignInWithEmailLink(y){return C.a8(this._delegate,y)}getRedirectResult(){var y=this;return(0,m.Z)(function*(){Qt(we(),y._delegate,"operation-not-supported-in-this-environment");const M=yield C.j(y._delegate,tt);return M?le(y._delegate,Promise.resolve(M)):{credential:null,user:null}})()}addFrameworkForLogging(y){!function at(b,E){(0,C.aE)(b)._logFramework(E)}(this._delegate,y)}onAuthStateChanged(y,M,G){const{next:oe,error:Ie,complete:Pe}=St(y,M,G);return this._delegate.onAuthStateChanged(oe,Ie,Pe)}onIdTokenChanged(y,M,G){const{next:oe,error:Ie,complete:Pe}=St(y,M,G);return this._delegate.onIdTokenChanged(oe,Ie,Pe)}sendSignInLinkToEmail(y,M){return C.a7(this._delegate,y,M)}sendPasswordResetEmail(y,M){return C.a0(this._delegate,y,M||void 0)}setPersistence(y){var M=this;return(0,m.Z)(function*(){let G;switch(function nt(b,E){Et(Object.values(et).includes(E),b,"invalid-persistence-type"),(0,ie.b$)()?Et(E!==et.SESSION,b,"unsupported-persistence-type"):(0,ie.UG)()?Et(E===et.NONE,b,"unsupported-persistence-type"):ht()?Et(E===et.NONE||E===et.LOCAL&&(0,ie.hl)(),b,"unsupported-persistence-type"):Et(E===et.NONE||bt(),b,"unsupported-persistence-type")}(M._delegate,y),y){case et.SESSION:G=C.a;break;case et.LOCAL:G=(yield C.az(C.i)._isAvailable())?C.i:C.b;break;case et.NONE:G=C.L;break;default:return C.as("argument-error",{appName:M._delegate.name})}return M._delegate.setPersistence(G)})()}signInAndRetrieveDataWithCredential(y){return this.signInWithCredential(y)}signInAnonymously(){return le(this._delegate,C.X(this._delegate))}signInWithCredential(y){return le(this._delegate,C.Y(this._delegate,y))}signInWithCustomToken(y){return le(this._delegate,C.$(this._delegate,y))}signInWithEmailAndPassword(y,M){return le(this._delegate,C.a6(this._delegate,y,M))}signInWithEmailLink(y,M){return le(this._delegate,C.a9(this._delegate,y,M))}signInWithPhoneNumber(y,M){return Ve(this._delegate,C.s(this._delegate,y,M))}signInWithPopup(y){var M=this;return(0,m.Z)(function*(){return Qt(we(),M._delegate,"operation-not-supported-in-this-environment"),le(M._delegate,C.c(M._delegate,y,tt))})()}signInWithRedirect(y){var M=this;return(0,m.Z)(function*(){return Qt(we(),M._delegate,"operation-not-supported-in-this-environment"),yield zt(M._delegate),C.f(M._delegate,y,tt)})()}updateCurrentUser(y){return this._delegate.updateCurrentUser(y)}verifyPasswordResetCode(y){return C.a4(this._delegate,y)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return b.Persistence=et,b})();function St(b,E,y){let M=b;"function"!=typeof b&&({next:M,error:E,complete:y}=b);const G=M;return{next:Ie=>G(Ie&&wt.getOrCreate(Ie)),error:E,complete:y}}function Tt(b,E){const y=function Bt(b,E){const y=Lt();if(!y)return[];const M=C.aA(kt,b,E);switch(y.getItem(M)){case et.NONE:return[C.L];case et.LOCAL:return[C.i,C.a];case et.SESSION:return[C.a];default:return[]}}(b,E);if(typeof self<"u"&&!y.includes(C.i)&&y.push(C.i),typeof window<"u")for(const M of[C.b,C.a])y.includes(M)||y.push(M);return y.includes(C.L)||y.push(C.L),y}class gt{constructor(){this.providerId="phone",this._delegate=new C.P(w(S.Z.auth()))}static credential(E,y){return C.P.credential(E,y)}verifyPhoneNumber(E,y){return this._delegate.verifyPhoneNumber(E,y)}unwrap(){return this._delegate}}gt.PHONE_SIGN_IN_METHOD=C.P.PHONE_SIGN_IN_METHOD,gt.PROVIDER_ID=C.P.PROVIDER_ID;const bn=C.ax;class qt{constructor(E,y,M=S.Z.app()){var G;bn(null===(G=M.options)||void 0===G?void 0:G.apiKey,"invalid-api-key",{appName:M.name}),this._delegate=new C.R(E,y,M.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Mt(b){b.INTERNAL.registerComponent(new ae.wA("auth-compat",E=>{const y=E.getProvider("app-compat").getImmediate(),M=E.getProvider("auth");return new on(y,M)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:C.A.EMAIL_SIGNIN,PASSWORD_RESET:C.A.PASSWORD_RESET,RECOVER_EMAIL:C.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:C.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:C.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:C.A.VERIFY_EMAIL}},EmailAuthProvider:C.M,FacebookAuthProvider:C.N,GithubAuthProvider:C.T,GoogleAuthProvider:C.Q,OAuthProvider:C.U,SAMLAuthProvider:C.V,PhoneAuthProvider:gt,PhoneMultiFactorGenerator:C.m,RecaptchaVerifier:qt,TwitterAuthProvider:C.W,Auth:on,AuthCredential:C.H,Error:ie.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),b.registerVersion("@firebase/auth-compat","0.3.4")}(S.Z)}}]);